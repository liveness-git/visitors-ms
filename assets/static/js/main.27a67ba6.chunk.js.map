{"version":3,"sources":["_styles/Theme.ts","_components/Copyright.tsx","_components/Spinner.tsx","_styles/LoginStyles.ts","_utils/Http.ts","_utils/SessionStrage.ts","login/index.tsx","_components/MySnackbar.tsx","_components/MySnackbarContext.tsx","login/Authorize.tsx","_utils/useLoadData.ts","_components/MyLocation.tsx","_components/BaseTemplate.tsx","_utils/useSelectedDate.ts","_utils/MaterialTableIcons.tsx","_styles/VisitorTableStyle.ts","_styles/TableTheme.ts","_models/Room.ts","_utils/FetchPostData.ts","_components/ControllerTextField.tsx","_components/AddrBookAutoComplete.tsx","_components/MyDialog.tsx","main/DeleteConfirmDialog.tsx","main/RoomInputFields.tsx","main/RoomReadFields.tsx","main/ControllerDateTimePicker.tsx","main/RowDataInputDialog.tsx","_components/AddrBookUserDisplay.tsx","main/RowDataReadDialog.tsx","main/DataTableBase.tsx","main/visitList/DataTable.tsx","_components/MyCalendar.tsx","main/HeaderActions.tsx","main/visitList/index.tsx","main/TimeBar.tsx","main/byRoom/DataTable.tsx","main/byRoom/DataTableWeekly.tsx","_components/MyTabContext.tsx","main/CategoryTabContext.tsx","main/RoomTabContext.tsx","main/byRoom/index.tsx","main/front/RowDataFrontDialog.tsx","main/front/DataTable.tsx","main/front/ExportCsvDialog.tsx","main/front/index.tsx","master/DeleteConfirmDialog.tsx","master/RowDataInputDialog.tsx","master/DataTableBase.tsx","master/DataTable.tsx","master/HeaderActions.tsx","_models/Role.ts","master/role/DataInputs.tsx","master/role/index.tsx","master/location/DataInputs.tsx","master/location/index.tsx","master/category/DataInputs.tsx","master/category/index.tsx","master/room/DataInputs.tsx","master/room/index.tsx","Routes.tsx","_utils/JaDateFnsUtils.ts","App.tsx","i18n.ts","index.tsx"],"names":["theme","createTheme","palette","primary","purple","secondary","amber","typography","button","textTransform","props","MuiTextField","variant","mixins","toolbar","minHeight","overrides","MuiTooltip","tooltip","fontSize","Copyright","Typography","color","align","Link","href","Date","getFullYear","useStyles","makeStyles","root","zIndex","Spinner","classes","Backdrop","className","open","CircularProgress","makeLoginStyles","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","main","form","width","submit","http","request","a","fetch","response","json","parsedBody","ok","console","error","body","Error","statusText","get","path","args","method","Request","post","JSON","stringify","temp_key","user_key","saveUserInfo","user","sessionStorage","setItem","reload_key","saveReloadState","item","value","states","parse","getItem","getReloadState","reloadFlg_key","getReloadStateFlg","removeReloadStateFlg","removeItem","removeSessionStrage","SignIn","t","useTranslation","match","useRouteMatch","useState","isLoading","setLoding","handleClick","location","params","result","window","url","log","Container","component","maxWidth","Avatar","LockOutlined","Button","onClick","fullWidth","Box","mt","Alert","elevation","mySnackberReducer","state","action","type","severity","message","MySnackbar","onClose","Snackbar","autoHideDuration","anchorOrigin","vertical","horizontal","MySnackberContext","createContext","MySnackberProvider","children","useReducer","dispatch","_event","reason","Provider","AuthorizeWrapper","Authorize","snackberContext","useContext","useEffect","sendAuthCode","search","first","setTimeout","replace","useLoadData","initialData","data","setData","setIsLoading","isError","setIsError","fetchData","useCallback","reload","MyLocation","locations","history","useHistory","selected","setSelected","length","FormControl","size","Select","style","onChange","event","target","push","map","MenuItem","name","createStyles","appBar","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","enteringScreen","paddingRight","menuButton","marginRight","menuButtonHidden","title","flexGrow","drawerPaper","position","whiteSpace","drawerPaperClose","overflowX","drawerCloseIcon","justifyContent","padding","calendarHidden","pageTitle","marginBottom","appBarSpacer","content","height","overflow","container","paddingTop","paddingBottom","link","textDecoration","nested","paddingLeft","BaseTemplate","adminMode","frontMode","menuOpen","setOpen","settingsOpen","setSettingsOpen","React","anchorEl","setAnchorEl","accountIconOpen","Boolean","handleMenuClose","handleSignOut","initialState","signedIn","email","isAdmin","isFront","userStorage","checkAuth","conditionalChildren","AppBar","clsx","Toolbar","IconButton","edge","noWrap","currentTarget","AccountCircle","Menu","id","keepMounted","transformOrigin","Drawer","Divider","List","to","ListItem","Tooltip","ListItemIcon","ListItemText","Collapse","in","timeout","unmountOnExit","pt","useSelectedDate","selectedDate","setSelectedDate","getTime","toString","tableIcons","Add","forwardRef","ref","Check","Clear","Delete","DetailPanel","Edit","Export","Filter","FirstPage","LastPage","NextPage","PreviousPage","ResetSearch","Search","SortArrow","ThirdStateCheck","ViewColumn","pageingOntions","paging","pageSize","pageSizeOptions","makeVisitorTableStyles","cellApptTime","cellRoomName","cellRoomStatus","cellReservationName","cellVisitCompany","cellSubject","cellContactAddr","cellCheckIn","cellCheckOut","declinedApptTime","declinedRoomName","wordBreak","border","i18next","cellStyle","field","rowData","charAt","toUpperCase","slice","roomStatus","tableTheme","grey","MuiTableRow","MuiTable","borderCollapse","makeTableDialogStyle","list","borderTop","boxSizing","flexBasis","light","borderLeft","borderBottom","borderRight","fieldSlim","nameOfRoomType","nameOfUsageRangeForVisitor","nameOfUsageRange","fetchPostData","formData","Promise","resolve","reject","ControllerTextField","control","label","required","selectList","multiline","disabled","validation","errors","rules","render","TextField","select","helperText","option","index","AddrBookAutoComplete","filter","setFilter","addressbook","loading","onChangeHandle","Autocomplete","multiple","limitTags","undefined","onOpen","options","noOptionsText","getOptionLabel","address","renderTags","tagValue","getTagProps","Chip","filterSelectedOptions","getOptionSelected","renderInput","InputProps","endAdornment","ev","_","closeButton","right","top","MyDialog","handleCancel","Dialog","DialogTitle","DialogContent","dividers","DialogActions","DeleteConfirmDialog","DialogContentText","autoFocus","RoomInputFields","setValue","rooms","roomId","disabledVisitor","disabledRoom","disabledTeaSupply","setDisabledTeaSupply","roomWatch","useWatch","some","room","teaSupply","shouldDirty","disabledTeaMember","setDisabledTeaMember","teaWatch","getNestedError","px","textAlign","validate","Grid","xs","FormControlLabel","Switch","e","checked","opacity","inputProps","min","useRowDataDialogStyles","strRoomStatus","status","RoomReadFields","hiddenTeaSupply","disablePadding","roomName","roomEmail","numberOfVisitor","numberOfEmployee","ControllerDateTimePicker","getValues","handleDateTimeChange","DateTimePicker","ampm","format","disablePast","minutesStep","formAction","note","inputformTheme","minRows","change5MinuteIntervals","date","Math","ceil","ADD_ROOM_KEY","getDefaultValues","start","usage","startDate","mode","iCalUId","subject","visitorId","visitCompany","visitorName","mailto","authors","optional","usageRange","resourcies","roomForEdit","comment","contactAddr","startTime","addMinutes","endTime","startTimeBufferMinute","RowDataInputDialog","addDefault","delConfOpen","setDelConfOpen","defaultValues","useForm","reValidateMode","handleSubmit","reset","trigger","setError","formState","isDirty","isSubmitting","dirtyFields","Object","keys","reduce","newObj","startDateTime","endDateTime","cloneDeep","hiddenRooms","setHiddenRooms","usageRangeWatch","defaultRoomsUrl","roomsUrl","setRoomsUrl","buildRoomsUrl","setDisabledVisitor","onSubmit","inputs","success","r","key","handleSearch","activeSearchButton","ThemeProvider","isMSMultipleLocations","reservationName","p","py","startIcon","deleteOk","flexWrap","AddrBookUserDisplay","i","RowDataReadDialog","isAttendees","apptTime","dataDialogReducer","inputOpen","readOpen","DataTableBase","dataDialogHook","currentRow","handleInputDialogClose","handleReadDialogClose","DataTable","currentDate","setCurrentRow","handleDialogOpen","selectedRow","isAuthor","columns","components","Cell","columnDef","onRowClick","showTitle","headerStyle","tableLayout","icons","keyboardDatePicker","MyCalendar","showTodayButton","KeyboardButtonProps","datePicker","HeaderActions","subtitle","onDateChange","actionButtons","sm","VisitList","createdOnly","setCreatedOnly","dataDialogState","dataDialogDispatch","Number","Paper","square","pb","shortStyle","halfWidth","scale","transform","x","y","fontHeight","timeToPoint","time","boxStyle","zero","startOfDay","differenceInMinutes","getBoxData","end","x2","isSameDay","startOfCurrent","endOfCurrent","endOfDay","isBefore","isAfter","calcX","hour","createTransform","HtmlTooltip","withStyles","text","pxToRem","strokeWidth","stroke","fill","dominantBaseline","cursor","fillOpacity","info","warning","TimeBar","schedule","events","onClickCallback","keyLabel","keyValue","onTitleClick","setTransform","rectY","rectHeight","viewHeightDup","scheduleItems","createScheduleBox","timestamp","rowIndex","boxData","rx","ry","createEventBox","myEvent","viewBox","rectSchedules","useMemo","row","rectEvents","categoryId","viewWidth","preserveAspectRatio","x1","y1","y2","range","$","minX","fontX","svg","closest","createSVGPoint","clientX","clientY","ctm","getScreenCTM","$time","point","pointToTime","matrixTransform","inverse","floor","handleCreateClick","tabKey","timeBars","schedules","sIdx","eventsIndex","eventIndex","DataTableWeekly","muiPickContext","MuiPickersContext","locale","MyTabContext","tabPanelContent","activateTab","setActivateTab","tabValue","setTabValue","handleTabChange","newValue","tabList","TabList","indicatorColor","textColor","Tab","tabPanels","TabPanel","cloneElement","TabContext","CategoryTabContext","RoomTabContext","typeQuery","byRoomReducer","weekly","changeTab","titleLabel","subtitleLabel","ByRoom","byRoomState","byRoomDispatch","_categoryId","_roomId","checkAction","RowDataFrontDialog","frontClasses","register","checkIn","checkOut","visitorCardNumber","autoComplete","frontDialogOpen","setFrontDialogOpen","handleFrontDialogOpen","handleFrontDialogClose","strNumOfVisitor","strNumOfEmployee","actions","icon","localization","header","between","nameOfCsvHeaders","ExportCsvDialog","csvLinkRef","useRef","csvData","setCsvData","endDate","addWeeks","handleExportCsv","headers","kebabCase","filename","dataByCategory","category","flat","current","click","handleStartDateChange","Front","exportCsvOpen","setExportCsvOpen","setChangeTab","csvButton","inputFields","methods","values","actionButtonArea","master","nameOfRoleType","DataInputs","useFormContext","RoleSettings","members","pattern","LocationSettings","sort","isLimitedPublic","showMembers","setShowMembers","CategorySettings","limitedPublic","categories","typeWatch","RoomSettings","find","Routes","exact","from","JaDateFnsUtils","jaLocale","DateFnsUtils","App","CssBaseline","utils","resources","en","translation","enTranslation","ja","jaTranslation","i18n","use","initReactI18next","init","lng","fallbackLng","interpolation","escapeValue","react","useSuspense","ReactDOM","StrictMode","document","getElementById"],"mappings":"g0VAIaA,EAAQC,YAAY,CAC/BC,QAAS,CACPC,QAASC,IACTC,UAAWC,KAEbC,WAAY,CACVC,OAAQ,CACNC,cAAe,SAGnBC,MAAO,CACLC,aAAc,CACZC,QAAS,aAGbC,OAAQ,CACNC,QAAS,CAAEC,UAAW,KAExBC,UAAW,CACTC,WAAY,CACVC,QAAS,CACPC,SAAU,W,wIClBX,SAASC,IACd,OACE,eAACC,EAAA,EAAD,CAAYT,QAAQ,QAAQU,MAAM,gBAAgBC,MAAM,SAAxD,UACG,0CACD,cAACC,EAAA,EAAD,CAAMF,MAAM,UAAUG,KAAK,8BAA3B,4BAEQ,KACP,IAAIC,MAAOC,cACX,O,8BCbDC,EAAYC,aAAW,SAAC7B,GAAD,MAAY,CACvC8B,KAAM,CACJC,OAAQ/B,EAAM+B,OAAOb,QAAU,EAC/BI,MAAO,YAQJ,SAASU,EAAQtB,GACtB,IAAMuB,EAAUL,IAEhB,OACE,cAACM,EAAA,EAAD,CAAUC,UAAWF,EAAQH,KAAMM,KAAM1B,EAAM0B,KAA/C,SACE,cAACC,EAAA,EAAD,CAAkBf,MAAM,cChBvB,IAAMgB,EAAkB,WAC7B,OAAOT,aAAW,SAAC7B,GAAD,MAAY,CAC5BuC,MAAO,CACLC,UAAWxC,EAAMyC,QAAQ,GACzBC,QAAS,OACTC,cAAe,SACfC,WAAY,UAEdC,OAAQ,CACNC,OAAQ9C,EAAMyC,QAAQ,GACtBM,gBAAiB/C,EAAME,QAAQG,UAAU2C,MAE3CC,KAAM,CACJC,MAAO,OACPV,UAAWxC,EAAMyC,QAAQ,IAE3BU,OAAQ,CACNL,OAAQ9C,EAAMyC,QAAQ,EAAG,EAAG,SCR3B,SAAeW,EAAtB,kC,4CAAO,WAAuBC,GAAvB,iBAAAC,EAAA,sEACmCC,MAAMF,GADzC,cACCG,EADD,yBAKyBA,EAASC,OALlC,OAKHD,EAASE,WALN,kEAQAF,EAASG,GART,uBASHC,QAAQC,MAAM,iBAAd,UAAgCL,EAASE,kBAAzC,aAAgC,EAAqBI,MAC/C,IAAIC,MAAMP,EAASQ,YAVtB,iCAYER,GAZF,0D,sBAcA,SAAeS,EAAtB,kC,4CAAO,WAAsBC,GAAtB,2BAAAZ,EAAA,6DAAoCa,EAApC,+BAAwD,CAAEC,OAAQ,OAAlE,SACQhB,EAAQ,IAAIiB,QAAQH,EAAMC,IADlC,mF,wBAIA,SAAeG,EAAtB,oC,4CAAO,WAAuBJ,EAAcJ,GAArC,2BAAAR,EAAA,6DAAgDa,EAAhD,+BAAoE,CAAEC,OAAQ,OAAQN,KAAMS,KAAKC,UAAUV,IAA3G,SACQV,EAAQ,IAAIiB,QAAQH,EAAMC,IADlC,mF,wBC1BP,IAAMM,EAAW,wBAaXC,EAAW,wBACJC,EAAe,SAACC,GAC3BC,eAAeC,QAAQJ,EAAUE,IAW7BG,EAAa,0BAINC,EAAkB,SAACC,EAAcC,GAC5C,IAAMC,EAASZ,KAAKa,MAAMP,eAAeQ,QAAQN,IACjDI,EAAOF,GAAQC,EACfL,eAAeC,QAAQC,EAAYR,KAAKC,UAAUW,KAEvCG,EAAiB,SAACL,GAE7B,OADeV,KAAKa,MAAMP,eAAeQ,QAAQN,IACnCE,IAQVM,EAAgB,8BAITC,EAAoB,WAC/B,OAAOX,eAAeQ,QAAQE,IAEnBE,EAAuB,WAClCZ,eAAea,WAAWH,IAKfI,EAAsB,WArCjCd,eAAea,WAAWhB,GAmB1BG,eAAea,WAAWX,GAqB1BU,KC9CI7D,EAAYU,IAEX,SAASsD,KACd,IAAQC,EAAMC,cAAND,EACF5D,EAAUL,IACVmE,EAAQC,cAGd,EAA+BC,oBAAS,GAAxC,mBAAOC,EAAP,KAAkBC,EAAlB,KAEMC,EAAW,uCAAG,4BAAA9C,EAAA,sEAEhB6C,GAAU,GD1BiBE,EC2BVN,EAAMO,OAAOD,SD1BlCxB,eAAeC,QAAQL,EAAU4B,GCuBb,SAIKpC,EAAc,iBAJnB,QAIVsC,EAJU,QAKL7C,aACT8C,OAAOH,SAAS5E,KAAO8E,EAAO7C,WAAW+C,KAN3B,gDAShB7C,QAAQ8C,IAAR,MATgB,kCDxBU,IAACL,ICwBX,oBAAH,qDAajB,OACE,eAACM,EAAA,EAAD,CAAWC,UAAU,OAAOC,SAAS,KAArC,UACE,cAAC7E,EAAD,CAASI,KAAM8D,IACf,sBAAK/D,UAAWF,EAAQM,MAAxB,UACE,cAACuE,EAAA,EAAD,CAAQ3E,UAAWF,EAAQY,OAA3B,SACE,cAACkE,EAAA,EAAD,MAEF,cAAC1F,EAAA,EAAD,CAAYuF,UAAU,KAAKhG,QAAQ,KAAnC,6CAGA,cAACoG,EAAA,EAAD,CAAQC,QAASb,EAAac,WAAS,EAACtG,QAAQ,YAAYU,MAAM,UAAUa,UAAWF,EAAQkB,OAA/F,SACG0C,EAAE,yBAGP,cAACsB,EAAA,EAAD,CAAKC,GAAI,EAAT,SACE,cAAChG,EAAD,S,gCCpDR,SAASiG,GAAM3G,GACb,OAAO,cAAC,KAAD,cAAU4G,UAAW,EAAG1G,QAAQ,UAAaF,IAsB/C,IAAM6G,GAAoB,SAACC,EAAwBC,GACxD,OAAQA,EAAOC,MACb,IAAK,OACH,OAAO,6BAAKF,GAAZ,IAAmBpF,MAAM,IAC3B,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,QACH,OAAO,6BAAKoF,GAAZ,IAAmBpF,MAAM,EAAMuF,SAAUF,EAAOC,KAAME,QAASH,EAAOG,UACxE,QACE,OAAOJ,IAIE,SAASK,GAAWnH,GACjC,IAAQiH,EAAqCjH,EAArCiH,SAAUC,EAA2BlH,EAA3BkH,QAASxF,EAAkB1B,EAAlB0B,KAAM0F,EAAYpH,EAAZoH,QAEjC,OACE,cAACC,GAAA,EAAD,CAAU3F,KAAMA,EAAM4F,iBAAkB,KAAMF,QAASA,EAASG,aAAc,CAAEC,SAAU,MAAOC,WAAY,UAA7G,SACE,cAAC,GAAD,CAAOL,QAASA,EAASH,SAAUA,EAAnC,SACGC,MCtCF,IAAMQ,GAAoBC,wBAAc,IAMxC,SAASC,GAAmB5H,GACjC,IAAQ6H,EAAa7H,EAAb6H,SASR,EAA0BC,qBAAWjB,GANC,CACpCI,SAAU,OACVC,QAAS,GACTxF,MAAM,IAGR,mBAAOoF,EAAP,KAAciB,EAAd,KASA,OACE,qCACE,cAACZ,GAAD,6BAAgBL,GAAhB,IAAuBM,QATP,SAACY,EAA+BC,GACnC,cAAXA,GAGJF,EAAS,CAAEf,KAAM,aAMf,cAACU,GAAkBQ,SAAnB,CAA4B1D,MAAO,CAAEsC,QAAOiB,YAA5C,SAAyDF,OCrB/D,IAAM3G,GAAYU,IAEX,SAASuG,KACd,OACE,cAACP,GAAD,UACE,cAACQ,GAAD,MAKC,SAASA,KACd,IAAM7G,EAAUL,KACRiE,EAAMC,cAAND,EACFkD,EAAkBC,qBAAWZ,IAGnC,EAA+BnC,oBAAS,GAAxC,mBAAOC,EAAP,KAAkBC,EAAlB,KA4CA,OA1CA8C,qBAAU,WAER,IAAMC,EAAY,uCAAG,oCAAA5F,EAAA,sEAEX6F,EAAS3C,OAAOH,SAAS8C,OAFd,SAGIlF,EAAc,kBAAoBkF,GAHtC,YAGX5C,EAHW,QAIN7C,WAJM,oBAKfyC,GAAU,GACNI,EAAO7C,WAAWC,GACpBoF,EAAgBN,SAAS,CAAEf,KAAM,UAAWE,QAAS/B,EAAE,8BAEvDkD,EAAgBN,SAAS,CAAEf,KAAM,QAASE,QAAS/B,EAAE,6BAGnDQ,EJxCLxB,eAAeQ,QAAQZ,GAG9BI,eAAea,WAAWjB,GIuCb4B,GAAyB,cAAbA,EAdF,kCAeOpC,EAAc,mBAfrB,SAePmF,EAfO,QAgBH1F,aACR2C,EAAW+C,EAAM1F,WAAW+C,KAjBjB,QAuBXA,EAvBW,WAuBDJ,EAvBC,SAyBE,cAAbA,IACFI,EAAM,sBAER4C,YAAW,WACT7C,OAAOH,SAASiD,QAAQ7C,KACvB,MA9BY,0DAiCjB7C,QAAQ8C,IAAR,MAjCiB,0DAAH,qDAoClBwC,MAEC,IAGD,eAACvC,EAAA,EAAD,CAAWC,UAAU,OAAOC,SAAS,KAArC,UACE,cAAC7E,EAAD,CAASI,KAAM8D,IACf,sBAAK/D,UAAWF,EAAQM,MAAxB,UACE,cAACuE,EAAA,EAAD,CAAQ3E,UAAWF,EAAQY,OAA3B,SACE,cAACkE,EAAA,EAAD,MAEF,cAAC1F,EAAA,EAAD,CAAYuF,UAAU,KAAKhG,QAAQ,KAAnC,gDAIF,cAACuG,EAAA,EAAD,CAAKC,GAAI,EAAT,SACE,cAAChG,EAAD,S,4XC/ED,SAASmI,GAAe9C,EAAa+C,GAE1C,MAAwBvD,mBAAwBuD,GAAhD,mBAAOC,EAAP,KAAaC,EAAb,KAEA,EAAkCzD,oBAAS,GAA3C,mBAAOC,EAAP,KAAkByD,EAAlB,KAEA,EAA8B1D,oBAAS,GAAvC,mBAAO2D,EAAP,KAAgBC,EAAhB,KAGMC,EAAYC,sBAAW,sBAAC,4BAAAzG,EAAA,6DAC5BuG,GAAW,GACXF,GAAa,GAFe,kBAIL1F,EAAOwC,GAJF,QAIpBF,EAJoB,QAOf7C,YAAYgG,EAAQnD,EAAO7C,YAPZ,gDAS1BmG,GAAW,GACXjG,QAAQ8C,IAAR,MAV0B,QAY5BiD,GAAa,GAZe,yDAa3B,CAAClD,IAGEuD,EAASD,sBAAW,sBAAC,sBAAAzG,EAAA,+EAAYwG,KAAZ,2CAAyB,CAACA,IAOrD,OAJAb,qBAAU,WACRa,MACC,CAACA,IAEG,CAAC,CAAEL,OAAMvD,YAAW0D,WAAWI,GClCjC,SAASC,KAEd,MAA8BV,GAAW,oBAAkC,IAA5DW,EAAf,oBAAST,KAEHU,EAAUC,cACVrE,EAAQC,cAGd,EAAgCC,mBAAiBF,EAAMO,OAAOD,UAA9D,mBAAOgE,EAAP,KAAiBC,EAAjB,KAOA,OAAKJ,GAAkC,IAArBA,EAAUK,OAK1B,cAACC,GAAA,EAAD,CAAalJ,MAAM,UAAUwB,OAAO,QAAQ2H,KAAK,QAAjD,SACE,cAACC,GAAA,EAAD,CAAQC,MAAO,CAAErJ,MAAO,SAAW4D,MAAOmF,EAAUO,SAZjC,SAACC,GACtBP,EAAYO,EAAMC,OAAO5F,OACzB,IAAMuB,EAAMV,EAAM7B,KAAKoF,QAAQ,aAAcuB,EAAMC,OAAO5F,OAC1DiF,EAAQY,KAAKtE,IASX,SACGyD,EAAUc,KAAI,SAACvB,GACd,OACE,cAACwB,GAAA,EAAD,CAAyB/F,MAAOuE,EAAKhD,IAArC,SACGgD,EAAKyB,MADOzB,EAAKhD,YARrB,6BCiBX,IAAM7E,GAAYC,aAAW,SAAC7B,GAG5B,OAAOmL,aAAa,CAClBrJ,KAAM,CACJY,QAAS,QAEX0I,OAAQ,CACNrJ,OAAQ/B,EAAM+B,OAAOsJ,OAAS,EAC9BC,WAAYtL,EAAMuL,YAAYC,OAAO,CAAC,QAAS,UAAW,CACxDC,OAAQzL,EAAMuL,YAAYE,OAAOC,MACjCC,SAAU3L,EAAMuL,YAAYI,SAASC,iBAGzCC,YAAa,CACXC,WAdgB,IAehB5I,MAAM,eAAD,OAfW,IAeX,OACLoI,WAAYtL,EAAMuL,YAAYC,OAAO,CAAC,QAAS,UAAW,CACxDC,OAAQzL,EAAMuL,YAAYE,OAAOC,MACjCC,SAAU3L,EAAMuL,YAAYI,SAASI,kBAGzCjL,QAAS,CACPkL,aAAc,IAEhBC,WAAY,CACVC,YAAa,IAEfC,iBAAkB,CAChBzJ,QAAS,QAEX0J,MAAO,CACLC,SAAU,GAEZhG,SAAU,CACR/E,MAAO,SAETgL,YAAa,CACXC,SAAU,WACVC,WAAY,SACZtJ,MAvCgB,IAwChBoI,WAAYtL,EAAMuL,YAAYC,OAAO,QAAS,CAC5CC,OAAQzL,EAAMuL,YAAYE,OAAOC,MACjCC,SAAU3L,EAAMuL,YAAYI,SAASI,kBAGzCU,iBAAkB,CAChBC,UAAW,SACXpB,WAAYtL,EAAMuL,YAAYC,OAAO,QAAS,CAC5CC,OAAQzL,EAAMuL,YAAYE,OAAOC,MACjCC,SAAU3L,EAAMuL,YAAYI,SAASC,gBAEvC1I,MAAOlD,EAAMyC,QAAQ,IAKvBkK,gBAAgB,cACdjK,QAAS,OACTE,WAAY,SACZgK,eAAgB,WAChBC,QAAS,SACN7M,EAAMa,OAAOC,SAElBgM,eAAgB,CACdpK,QAAS,QAEXqK,UAAW,CACTC,aAAchN,EAAMyC,QAAQ,IAE9BwK,aAAcjN,EAAMa,OAAOC,QAC3BoM,QAAS,CACPb,SAAU,EACVc,OAAQ,QACRC,SAAU,QAEZC,UAAW,CACTC,WAAYtN,EAAMyC,QAAQ,GAC1B8K,cAAevN,EAAMyC,QAAQ,IAE/BF,MAAO,CACLsK,QAAS7M,EAAMyC,QAAQ,GACvBC,QAAS,OACT0K,SAAU,OACVzK,cAAe,UAEjB6K,KAAM,CACJC,eAAgB,OAEhBnM,MAAO,uBAEToM,OAAQ,CAENC,YAAa3N,EAAMyC,QAAQ,UAkTlBmL,GAnSM,SAAC,GAAqE,IAAnErF,EAAkE,EAAlEA,SAAUsF,EAAwD,EAAxDA,UAAWC,EAA6C,EAA7CA,UAAWC,EAAkC,EAAlCA,SAC9ClI,EAAMC,cAAND,EACF5D,EAAUL,KACVmE,EAAQC,cAGd,EAAwBC,qBAAS8H,GAAjC,mBAAO3L,EAAP,KAAa4L,EAAb,KAGA,EAAwC/H,oBAAS,GAAjD,mBAAOgI,EAAP,KAAqBC,EAArB,KAEAjF,qBAAU,WACH7G,GACH8L,GAAgB,KAEjB,CAAC9L,IAEJ,IAcA,EAAgC+L,IAAMlI,SAA6B,MAAnE,mBAAOmI,EAAP,KAAiBC,EAAjB,KACMC,EAAkBC,QAAQH,GAI1BI,EAAkB,WACtBH,EAAY,OAIRI,EAAa,uCAAG,sBAAAnL,EAAA,+EAEGW,EAAwB,kBAF3B,cAGPN,KACTgC,IACAa,OAAOH,SAAS5E,KAAO,UALP,gDAQlBmC,QAAQ8C,IAAR,MARkB,yDAAH,qDAabgI,EAAiC,CACrCC,UAAU,EACVC,MAAO,GACP1D,KAAM,GACN2D,SAAS,EACTC,SAAS,GAcX,EAAgCtG,sBAXL,SAAChB,EAAyBC,GACnD,OAAQA,EAAOC,MACb,IAAK,WACH,MAAO,CAAEiH,UAAU,EAAMC,MAAOnH,EAAO7C,KAAKgK,MAAO1D,KAAMzD,EAAO7C,KAAKsG,KAAM2D,QAASpH,EAAO7C,KAAKiK,QAASC,QAASrH,EAAO7C,KAAKkK,SAChI,IAAK,YACH,OAAOJ,EACT,QACE,OAAOlH,KAIkDkH,GAA/D,mBAAOK,EAAP,KAAoBtG,EAApB,KAGMuG,EAAYjF,sBAAW,sBAAC,kCAAAzG,EAAA,oEAEpBmG,EP7MH5E,eAAeQ,QAAQX,IO2MA,gBAKlBE,EAAOL,KAAKa,MAAMqE,GACxBhB,EAAS,CAAEf,KAAM,WAAY9C,KAAMA,IANX,uCASHX,EAAU,YATP,QASlBsC,EATkB,QAUb7C,YACHkB,EAAO2B,EAAO7C,WACpBiB,EAAaJ,KAAKC,UAAUI,IAC5B6D,EAAS,CAAEf,KAAM,WAAY9C,KAAMA,MAEnCe,IACA8C,EAAS,CAAEf,KAAM,cACjB9D,QAAQ8C,IAAI,6BAjBU,0DAsB1Bf,IACAa,OAAOH,SAAS5E,KAAO,SAvBG,0DAyB3B,IAQHwH,qBAAU,WACR+F,MACC,CAACA,IAIJ/F,qBAAU,WACHzD,KPzOPX,eAAeC,QAAQC,EAAvB,QO0OG,IAIH,IAAIkK,EAAsB1G,EACpB1E,EAAQ,mCAAGgC,EAAE,gCAQnB,OAPIgI,IAAckB,EAAYF,UAC5BI,EAAsBpL,GAEpBiK,IAAciB,EAAYD,UAC5BG,EAAsBpL,GAGnBkL,EAAYJ,SAKf,cAACrG,GAAD,UACE,sBAAKnG,UAAWF,EAAQH,KAAxB,UACE,cAACoN,GAAA,EAAD,CAAQ3C,SAAS,WAAWpK,UAAWgN,aAAKlN,EAAQmJ,OAAQhJ,GAAQH,EAAQ4J,aAA5E,SACE,eAACuD,GAAA,EAAD,CAASjN,UAAWF,EAAQnB,QAA5B,UACE,cAACuO,GAAA,EAAD,CACEC,KAAK,QACLhO,MAAM,UACN,aAAW,cACX2F,QA9Ha,WACvB+G,GAAQ,IA8HE7L,UAAWgN,aAAKlN,EAAQgK,WAAY7J,GAAQH,EAAQkK,kBALtD,SAOE,cAAC,KAAD,MAEF,cAAC9K,EAAA,EAAD,CAAYuF,UAAU,KAAKhG,QAAQ,KAAKU,MAAM,UAAUiO,QAAM,EAACpN,UAAWF,EAAQmK,MAAlF,6CAGA,8BACE,cAACnC,GAAD,MAEF,gCACE,cAACoF,GAAA,EAAD,CACE,aAAW,0BACX,gBAAc,cACd,gBAAc,OACdpI,QA9HY,SAAC4D,GACzBwD,EAAYxD,EAAM2E,gBA8HNlO,MAAM,UALR,SAOE,cAACmO,GAAA,EAAD,MAEF,eAACC,GAAA,EAAD,CACEC,GAAG,cACHvB,SAAUA,EACVnG,aAAc,CACZC,SAAU,MACVC,WAAY,SAEdyH,aAAW,EACXC,gBAAiB,CACf3H,SAAU,MACVC,WAAY,SAEd/F,KAAMkM,EACNxG,QAAS0G,EAbX,UAeE,cAACvD,GAAA,EAAD,CAAUhE,QAASuH,EAAnB,SAAqCO,EAAYH,QACjD,cAAC3D,GAAA,EAAD,CAAUhE,QAASwH,EAAnB,SAAmC5I,EAAE,iCAK7C,eAACiK,GAAA,EAAD,CACElP,QAAQ,YACRqB,QAAS,CACPM,MAAO4M,aAAKlN,EAAQqK,aAAclK,GAAQH,EAAQwK,mBAEpDrK,KAAMA,EALR,UAOE,qBAAKD,UAAWF,EAAQ0K,gBAAxB,SACE,cAAC0C,GAAA,EAAD,CAAYpI,QA7KI,WACxB+G,GAAQ,IA4KA,SACE,cAAC,KAAD,QAGJ,cAAC+B,GAAA,EAAD,IACA,eAACC,GAAA,EAAD,WACE,cAAC,IAAD,CAAMC,GAAE,WAAMlK,EAAMO,OAAOD,SAAnB,SAAoClE,UAAWF,EAAQuL,KAA/D,SACE,eAAC0C,GAAA,EAAD,CAAU1P,QAAM,EAAhB,UACE,cAAC2P,GAAA,EAAD,CAAS/D,MAAOvG,EAAE,gCAAlB,SACE,cAACuK,GAAA,EAAD,UACE,cAAC,KAAD,QAGJ,cAACC,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,uCAG7B,cAAC,IAAD,CAAMoK,GAAE,WAAMlK,EAAMO,OAAOD,SAAnB,gBAA2ClE,UAAWF,EAAQuL,KAAtE,SACE,eAAC0C,GAAA,EAAD,CAAU1P,QAAM,EAAhB,UACE,cAAC2P,GAAA,EAAD,CAAS/D,MAAOvG,EAAE,6BAAlB,SACE,cAACuK,GAAA,EAAD,UACE,cAAC,KAAD,QAGJ,cAACC,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,oCAG5BkJ,EAAYD,SACX,cAAC,IAAD,CAAMmB,GAAE,WAAMlK,EAAMO,OAAOD,SAAnB,UAAqClE,UAAWF,EAAQuL,KAAhE,SACE,eAAC0C,GAAA,EAAD,CAAU1P,QAAM,EAAhB,UACE,cAAC2P,GAAA,EAAD,CAAS/D,MAAOvG,EAAE,mBAAlB,SACE,cAACuK,GAAA,EAAD,UACE,cAAC,KAAD,QAGJ,cAACC,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,0BAI9BkJ,EAAYF,SACX,qCACE,eAACqB,GAAA,EAAD,CAAU1P,QAAM,EAACyG,QAlNH,WACrB7E,GACH4L,GAAQ,GAEVE,GAAiBD,IA8ML,UACE,cAACmC,GAAA,EAAD,UACE,cAAC,KAAD,MAEF,cAACC,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,wBACxBoI,EAAe,cAAC,KAAD,IAAiB,cAAC,KAAD,OAEnC,eAACqC,GAAA,EAAD,CAAUC,GAAItC,EAAcuC,QAAQ,OAAOC,eAAa,EAAxD,UACE,cAAC,IAAD,CAAMR,GAAE,WAAMlK,EAAMO,OAAOD,SAAnB,kBAA6ClE,UAAWF,EAAQuL,KAAxE,SACE,cAAC0C,GAAA,EAAD,CAAU1P,QAAM,EAAC2B,UAAWF,EAAQyL,OAApC,SACE,cAAC2C,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,iCAG7B,cAAC,IAAD,CAAMoK,GAAE,WAAMlK,EAAMO,OAAOD,SAAnB,sBAAiDlE,UAAWF,EAAQuL,KAA5E,SACE,cAAC0C,GAAA,EAAD,CAAU1P,QAAM,EAAC2B,UAAWF,EAAQyL,OAApC,SACE,cAAC2C,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,qCAG7B,cAAC,IAAD,CAAMoK,GAAE,WAAMlK,EAAMO,OAAOD,SAAnB,sBAAiDlE,UAAWF,EAAQuL,KAA5E,SACE,cAAC0C,GAAA,EAAD,CAAU1P,QAAM,EAAC2B,UAAWF,EAAQyL,OAApC,SACE,cAAC2C,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,qCAG7B,cAAC,IAAD,CAAMoK,GAAE,WAAMlK,EAAMO,OAAOD,SAAnB,kBAA6ClE,UAAWF,EAAQuL,KAAxE,SACE,cAAC0C,GAAA,EAAD,CAAU1P,QAAM,EAAC2B,UAAWF,EAAQyL,OAApC,SACE,cAAC2C,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,uCAMnC,eAACqK,GAAA,EAAD,CAAU1P,QAAM,EAACyG,QAhKP,WP1MpBpC,eAAeC,QAAQS,EAAe,KO4MpCiB,OAAOH,SAAS2D,UA8JR,UACE,cAACmG,GAAA,EAAD,CAAS/D,MAAOvG,EAAE,qBAAlB,SACE,cAACuK,GAAA,EAAD,UACE,cAAC,KAAD,QAGJ,cAACC,GAAA,EAAD,CAAclQ,QAAS0F,EAAE,gCAI/B,uBAAM1D,UAAWF,EAAQiL,QAAzB,UACE,qBAAK/K,UAAWF,EAAQgL,eACxB,eAACtG,EAAA,EAAD,CAAWE,SAAS,KAAK1E,UAAWF,EAAQoL,UAA5C,UAIG4B,EACD,cAAC9H,EAAA,EAAD,CAAKuJ,GAAI,EAAT,SACE,cAACtP,EAAD,iBAvJH,8BCjRJ,SAASuP,KAEd,MAAwC1K,mBAAsB,IAAIvE,MAAlE,mBAAOkP,EAAP,KAAqBC,EAArB,KAWA,OAPA5H,qBAAU,WACHzD,KACHR,EAAgB,eAAgB4L,EAAcE,UAAUC,cAEzD,CAACH,IAGG,CAACA,EAAcC,G,+TCEXG,GAAoB,CAC/BC,IAAKC,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAYzQ,GAAZ,IAAmByQ,IAAKA,QACxDC,MAAOF,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAWzQ,GAAX,IAAkByQ,IAAKA,QACzDE,MAAOH,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAWzQ,GAAX,IAAkByQ,IAAKA,QACzDG,OAAQJ,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAmBzQ,GAAnB,IAA0ByQ,IAAKA,QAClEI,YAAaL,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAkBzQ,GAAlB,IAAyByQ,IAAKA,QACtEK,KAAMN,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAUzQ,GAAV,IAAiByQ,IAAKA,QACvDM,OAAQP,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAazQ,GAAb,IAAoByQ,IAAKA,QAC5DO,OAAQR,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAgBzQ,GAAhB,IAAuByQ,IAAKA,QAC/DQ,UAAWT,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAezQ,GAAf,IAAsByQ,IAAKA,QACjES,SAAUV,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAczQ,GAAd,IAAqByQ,IAAKA,QAC/DU,SAAUX,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAkBzQ,GAAlB,IAAyByQ,IAAKA,QACnEW,aAAcZ,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAiBzQ,GAAjB,IAAwByQ,IAAKA,QACtEY,YAAab,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAWzQ,GAAX,IAAkByQ,IAAKA,QAC/Da,OAAQd,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAYzQ,GAAZ,IAAmByQ,IAAKA,QAC3Dc,UAAWf,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAiBzQ,GAAjB,IAAwByQ,IAAKA,QACnEe,gBAAiBhB,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAYzQ,GAAZ,IAAmByQ,IAAKA,QACpEgB,WAAYjB,sBAAW,SAACxQ,EAAOyQ,GAAR,OAAgB,cAAC,KAAD,6BAAgBzQ,GAAhB,IAAuByQ,IAAKA,SAMxDiB,GAAiB,CAC5BC,QAAQ,EACRC,SAAU,GAEVC,gBAAiB,CAAC,EAAG,GAAI,GAAI,K,UCzClBC,GAAyB,WACpC,OAAO3Q,aAAW,iBAAO,CAEvB4Q,aAAc,GACdC,aAAc,GACdC,eAAgB,GAChBC,oBAAqB,GACrBC,iBAAkB,GAClBC,YAAa,GACbC,gBAAiB,GACjBC,YAAa,GACbC,aAAc,GAEdC,iBAAkB,CAAEzF,eAAgB,8BACpC0F,iBAAkB,CAChB,WAAY,CACVC,UAAW,WACXtH,WAAY,EACZe,QAAS,UACTvL,MAAO,MACP+R,OAAQ,gBACRnG,QAAQ,IAAD,OAAMoG,KAAQzN,EAAE,6CAAhB,YAMF0N,GAAY,SAACC,EAAeC,EAAqCxR,GAC5E,IAAME,EAAYqR,EAAME,OAAO,GAAGC,cAAgBH,EAAMI,MAAM,GAC9D,OAAOzE,aACLlN,EAAQ,OAAD,OAAQE,IACQ,aAAvBsR,EAAQI,YAA6B5R,EAAQ,WAAD,OAAYE,M,oBCnC/C2R,GAAa7T,YAAY,CACpCC,QAAS,CACPC,QAAS,CACP6C,KAAM+Q,KAAK,MAEb1T,UAAW,CACT2C,KAAM5C,KAAO,OAGjBM,MAAO,CACLsT,YAAa,IAKfhT,UAAW,CACTiT,SAAU,CACRnS,KAAM,CACJoS,eAAgB,gBAMXC,GAAuB,WAClC,IAAMd,EAAS,iCACf,OAAOxR,aAAW,SAACiS,GAAD,MAAiB,CACjCM,KAAM,CACJ1R,QAAS,OAGT,sBAAuB,CACrB2R,UAAWhB,IAGfjH,MAAO,CACLkI,UAAW,aACXC,UAAW,MACX1H,QAAS,QACT9J,gBAAiB+Q,EAAW5T,QAAQC,QAAQqU,MAC5CC,WAAYpB,EACZqB,aAAcrB,GAEhBG,MAAO,CACLc,UAAW,aACXC,UAAW,MACX1H,QAAS,QACT8H,YAAatB,EACbqB,aAAcrB,EACd7G,WAAY,YAEdoI,UAAW,CACTN,UAAW,aACXC,UAAW,MACX1H,QAAS,QACT8H,YAAatB,EACbqB,aAAcrB,EACd7G,WAAY,iB,oGC5DLqI,GAAiB,CAAC,QAAS,QAG3BC,GAA6B,CAAC,UAAW,UAEzCC,GAAgB,CAAI,QAAJ,OAAeD,ICIrC,SAAeE,GAAtB,qC,8CAAO,WAAsCvO,EAAawO,GAAnD,iBAAA3R,EAAA,+EAIcgB,EAA2BmC,EAAKwO,GAJ9C,UAIHzR,EAJG,SAOG+C,EAAS/C,EAASE,YAPrB,yCASMwR,QAAQC,QAAQ5O,IATtB,gCAWM2O,QAAQE,OAAO,IAAIrR,MAAM,qBAX/B,iEAcHH,QAAQ8C,IAAR,MAdG,kBAeIwO,QAAQE,OAAR,OAfJ,2D,oCCWA,SAASC,GACd3U,GAEA,IAAQwK,EAAwFxK,EAAxFwK,KAAMoK,EAAkF5U,EAAlF4U,QAASC,EAAyE7U,EAAzE6U,MAAOC,EAAkE9U,EAAlE8U,SAAUC,EAAwD/U,EAAxD+U,WAAYC,EAA4ChV,EAA5CgV,UAAWC,EAAiCjV,EAAjCiV,SAAUC,EAAuBlV,EAAvBkV,WAAYC,EAAWnV,EAAXmV,OAE7EhQ,EAAMC,cAAND,EAEFiQ,EAAsB,cAAKN,WAAUA,GAAY3P,EAAE,yBAA+C+P,GAExG,OACE,cAAC,KAAD,CACE1K,KAAMA,EACNoK,QAASA,EACTQ,MAAOA,EACPC,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAACwC,GAAA,EAAD,6BACMxC,GADN,IAEE+B,MAAOA,EACPI,SAAUA,EACVD,UAAWA,EACXO,SAAUR,EACV5R,QAASgS,EAAO3K,GAChBgL,WAAYL,EAAO3K,IAAU2K,EAAO3K,GAAqBtD,QAP3D,WASK6N,GACDA,EAAWzK,KAAI,SAACmL,EAAQC,GAAT,OACb,cAACnL,GAAA,EAAD,CAAmC/F,MAAOiR,EAAOjR,MAAjD,SACGiR,EAAOZ,OADV,UAAkBrK,EAAlB,YAA0BkL,a,wBC1BjC,SAASC,GACd3V,GAEA,IAAQwK,EAAkDxK,EAAlDwK,KAAMoK,EAA4C5U,EAA5C4U,QAASC,EAAmC7U,EAAnC6U,MAAOM,EAA4BnV,EAA5BmV,OAAQF,EAAoBjV,EAApBiV,SAAUhL,EAAUjK,EAAViK,MAExC9E,EAAMC,cAAND,EAGR,EAA4BI,mBAAS,IAArC,mBAAOqQ,EAAP,KAAeC,EAAf,KACA,EAAoDhN,GAAW,mCAA6C+M,GAAU,IAAtH,sBAAeE,EAAf,EAAS/M,KAA8BgN,EAAvC,EAA4BvQ,UAG5B,EAAwBD,oBAAS,GAAjC,mBAAO7D,EAAP,KAAa4L,EAAb,KAGA/E,qBAAU,WACH7G,GACHmU,EAAU,MAEX,CAACnU,IAGJ,IAAMsU,EAAc,uCAAG,WAAOxR,GAAP,SAAA5B,EAAA,sDACrBiT,EAAUrR,GADW,2CAAH,sDAIpB,OACE,cAAC,KAAD,CACEgG,KAAMA,EACNoK,QAASA,EACTS,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAACmD,GAAA,EAAD,6BACMnD,GADN,IAEEmC,SAAUA,EACVhL,MAAOA,EACPiM,UAAQ,EACRC,UAAWlB,OAAWmB,EAAY,EAClCrM,KAAK,QACLrI,KAAMA,EACN2U,OAAQ,WACN/I,GAAQ,IAEVlG,QAAS,WACPkG,GAAQ,IAEVgJ,QAAWR,GAAiBF,EAASE,EAAc,GACnDS,cAAepR,EAAE,iCACjB4Q,QAASA,EACTS,eAAgB,SAACf,GAAD,gBAAeA,EAAOjL,KAAtB,aAA+BiL,EAAOgB,QAAtC,MAChBC,WAAY,SAACC,EAAUC,GAAX,OACVD,EAASrM,KAAI,SAACmL,EAAQC,GAAT,OAAmB,cAACmB,GAAA,EAAD,cAAMhC,MAAOY,EAAOjL,KAAMkB,MAAO+J,EAAOgB,SAAaG,EAAY,CAAElB,gBAErGoB,uBAAqB,EACrBC,kBAAmB,SAACtB,EAAQjR,GAAT,OAAmBiR,EAAOgB,UAAYjS,EAAMiS,SAC/DO,YAAa,SAACpR,GAAD,OACX,cAAC0P,GAAA,EAAD,6BACM1P,GADN,IAEEiP,MAAOA,EACP1R,QAASgS,EAAO3K,GAChBgL,WAAYL,EAAO3K,IAAU2K,EAAO3K,GAAqBtD,QACzD+P,WAAU,6BACLrR,EAAOqR,YADF,IAERC,aACE,qCACGnB,EAAU,cAACpU,EAAA,EAAD,CAAkBf,MAAM,UAAUmJ,KAAM,KAAS,KAC3DnE,EAAOqR,WAAWC,kBAIzBhN,SAAU,SAACiN,GACe,KAApBA,EAAG/M,OAAO5F,OAAoC,OAApB2S,EAAG/M,OAAO5F,OACtCwR,EAAemB,EAAG/M,OAAO5F,YAKjC0F,SAAU,SAACkN,EAAGrO,GAAJ,OAAa+J,EAAM5I,SAASnB,U,iECvF1C7H,GAAYC,aAAW,SAAC7B,GAAD,OAC3BmL,aAAa,CACXrJ,KAAM,CACJgB,OAAQ,EACR+J,QAAS7M,EAAMyC,QAAQ,KACvBkL,YAAa3N,EAAMyC,QAAQ,IAE7BsV,YAAa,CACXxL,SAAU,WACVyL,MAAOhY,EAAMyC,QAAQ,KACrBwV,IAAKjY,EAAMyC,QAAQ,KACnBnB,MAAOtB,EAAME,QAAQ6T,KAAK,WAYzB,SAASmE,GAASxX,GACvB,IAAQ0B,EAAmC1B,EAAnC0B,KAAM0F,EAA6BpH,EAA7BoH,QAASsE,EAAoB1L,EAApB0L,MAAO7D,EAAa7H,EAAb6H,SAEtB1C,EAAMC,cAAND,EACF5D,EAAUL,KAEVuW,EAAe,WACnBrQ,KAGF,OACE,mCACE,eAACsQ,GAAA,EAAD,CAAQhW,KAAMA,EAAM0F,QAASA,EAASZ,WAAW,EAAML,SAAS,KAAK,kBAAgB,oBAArF,UACE,eAACwR,GAAA,EAAD,CAAa1I,GAAG,oBAAoBxN,UAAWF,EAAQH,KAAvD,UACGsK,EACD,cAACiD,GAAA,EAAD,CAAYlN,UAAWF,EAAQ8V,YAAa9Q,QAASkR,EAArD,SACE,cAAC,KAAD,SAGJ,cAACG,GAAA,EAAD,CAAeC,UAAQ,EAAvB,SAAyBhQ,IACzB,cAACiQ,GAAA,EAAD,CAAe7N,MAAO,CAAEjI,QAAS,QAAjC,SACE,cAACsE,EAAA,EAAD,CAAQC,QAASkR,EAAjB,SAAgCtS,EAAE,iC,cCzCrC,SAAS4S,GAAoB/X,GAClC,IAAQ0B,EAAkB1B,EAAlB0B,KAAM0F,EAAYpH,EAAZoH,QAENjC,EAAMC,cAAND,EAYR,OACE,8BACE,eAACuS,GAAA,EAAD,CAAQhW,KAAMA,EAAM0F,QAZJ,WAClBA,GAAQ,IAWoC,kBAAgB,qBAAqB,mBAAiB,2BAAhG,UAEE,cAACwQ,GAAA,EAAD,UACE,cAACI,GAAA,EAAD,CAAmB/I,GAAG,2BAAtB,SAAkD9J,EAAE,8CAEtD,eAAC2S,GAAA,EAAD,WACE,cAACxR,EAAA,EAAD,CAAQC,QAfM,WACpBa,GAAQ,IAc8BxG,MAAM,YAAtC,gBAGA,cAAC0F,EAAA,EAAD,CAAQC,QAfU,WACxBa,GAAQ,IAckCxG,MAAM,YAAYqX,WAAS,EAA/D,4B,wBCpBH,SAASC,GAAgBlY,GAC9B,IAAQ4U,EAA4E5U,EAA5E4U,QAASuD,EAAmEnY,EAAnEmY,SAAUC,EAAyDpY,EAAzDoY,MAAOC,EAAkDrY,EAAlDqY,OAAQC,EAA0CtY,EAA1CsY,gBAAiBC,EAAyBvY,EAAzBuY,aAAcpD,EAAWnV,EAAXmV,OAEjEhQ,EAAMC,cAAND,EAGR,EAAkDI,oBAAS,GAA3D,mBAAOiT,EAAP,KAA0BC,EAA1B,KAGMC,EAAYC,aAAS,CAAE/D,UAASpK,KAAK,cAAD,OAAgB6N,EAAhB,kBAG1C9P,qBAAU,WACR,GAAMmQ,GAAeN,EAAO,CAC1B,IAAMvS,EAASuS,EAAMQ,MAAK,SAACC,GAAD,OAAUA,EAAK5J,KAAOyJ,GAAaG,EAAKC,aAC7DjT,GAAQsS,EAAS,cAAD,OAAeE,EAAf,eAAmC,EAAO,CAAEU,aAAa,IAC9EN,GAAsB5S,QAEtBsS,EAAS,cAAD,OAAeE,EAAf,eAAmC,EAAO,CAAEU,aAAa,IACjEN,GAAqB,KAEtB,CAACJ,EAAQK,EAAWN,EAAOD,IAG9B,MAAkD5S,oBAAS,GAA3D,mBAAOyT,EAAP,KAA0BC,EAA1B,KAGMC,EAAWP,aAAS,CAAE/D,UAASpK,KAAK,cAAD,OAAgB6N,EAAhB,gBAGzC9P,qBAAU,WACH2Q,IACHf,EAAS,cAAD,OAAeE,EAAf,oBAAyC,EAAG,CAAEU,aAAa,IACnEZ,EAAS,cAAD,OAAeE,EAAf,qBAA0C,EAAG,CAAEU,aAAa,KAEtEE,GAAsBC,KACrB,CAACA,EAAUf,EAAUE,IAGxB9P,qBAAU,WACJ+P,GACFH,EAAS,cAAD,OAAeE,EAAf,oBAAyC,EAAG,CAAEU,aAAa,MAEpE,CAACZ,EAAUG,EAAiBD,IAG/B,IAAMc,EAAiB,SAAC3O,GACtB,OAAOjH,eAAI4R,EAAD,qBAAuBkD,EAAvB,YAAiC7N,KAG7C,OAAsB,KAAb,OAAL4N,QAAK,IAALA,OAAA,EAAAA,EAAOvO,QAEP,cAACpD,EAAA,EAAD,CAAK2S,GAAI,EAAGnP,MAAO,CAAEoP,UAAW,SAAUzY,MAAO,OAAjD,SACGuE,EAAE,yCAMP,eAACsB,EAAA,EAAD,CAAK2S,GAAI,EAAT,UACE,cAAC,KAAD,CACE5O,KAAI,qBAAgB6N,EAAhB,gBACJzD,QAASA,EACTQ,MAAO,CACLN,SAAU3P,EAAE,wBAEZmU,SAAU,SAACjB,GAAD,OAAaD,EAAOQ,MAAK,SAACC,GAAD,OAAUA,EAAK5J,KAAOoJ,UAAUjC,EAAajR,EAAE,6CAEpFkQ,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAACwC,GAAA,EAAD,6BACMxC,GADN,IAEEyC,QAAM,EACNN,SAAUsD,EACV1D,MAAO1P,EAAE,gCACThC,QAASgW,EAAe,eACxB3D,aAAc2D,EAAe,gBAAkBA,EAAe,eAAejS,QAN/E,SAQGkR,EAAO9N,KAAI,SAACmL,GAAD,OACV,eAAClL,GAAA,EAAD,CAA0B/F,MAAOiR,EAAOxG,GAAxC,UACGwG,EAAOjL,KADV,IACiB,IACdiL,EAAOvH,MACP,MAHYuH,EAAOxG,aAU9B,eAACsK,GAAA,EAAD,CAAM5M,WAAS,EAAC5K,QAAS,EAAGkI,MAAOuO,EAAoB,CAAExW,QAAS,aAAWoU,EAA7E,UACE,cAACmD,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAf,SACE,cAACC,GAAA,EAAD,CACE7E,QACE,cAAC,KAAD,CACEpK,KAAI,qBAAgB6N,EAAhB,cACJzD,QAASA,EACTS,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAAC4G,GAAA,EAAD,CAAQxP,SAAU,SAACyP,GAAD,OAAO7G,EAAM5I,SAASyP,EAAEvP,OAAOwP,UAAUA,QAAS9G,EAAMtO,MAAO5D,MAAM,UAAUqU,SAAUuD,OAIjH3D,MAAO1P,EAAE,oCAIb,cAACoU,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAGvP,MAAOqO,EAAkB,CAAEuB,QAAS,QAAMzD,EAA5D,SACE,cAAC,KAAD,CACE5L,KAAI,qBAAgB6N,EAAhB,oBACJzD,QAASA,EACTQ,MAAO,CAAEN,SAAU3P,EAAE,yBACrBkQ,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAACwC,GAAA,EAAD,2BACEtO,KAAK,SACL8S,WAAY,CAAEC,IAAK,EAAG9P,MAAO,CAAEoP,UAAW,WACtCvG,GAHN,IAIEmC,SAAU+D,GAAqBV,EAC/BzD,MAAO1P,EAAE,uCACThC,QAASgW,EAAe,mBACxB3D,aAAc2D,EAAe,oBAAsBA,EAAe,mBAAmBjS,gBAM7F,cAACqS,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAf,SACE,cAAC,KAAD,CACEhP,KAAI,qBAAgB6N,EAAhB,qBACJzD,QAASA,EACTQ,MAAO,CAAEN,SAAU3P,EAAE,yBACrBkQ,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAACwC,GAAA,EAAD,2BACEtO,KAAK,SACL8S,WAAY,CAAEC,IAAK,EAAG9P,MAAO,CAAEoP,UAAW,WACtCvG,GAHN,IAIEmC,SAAU+D,EACVnE,MAAO1P,EAAE,wCACThC,QAASgW,EAAe,oBACxB3D,aAAc2D,EAAe,qBAAuBA,EAAe,oBAAoBjS,sBCrJvG,IAAM8S,GAAyBvG,KAElBwG,GAAgB,SAACC,GAC5B,OAAQA,GACN,IAAK,WACH,MAAO,4CACT,IAAK,WACH,MAAO,4CACT,QACE,MAAO,KASN,SAASC,GAAena,GAC7B,IAAQ+I,EAA0B/I,EAA1B+I,KAAMqR,EAAoBpa,EAApBoa,gBAENjV,EAAMC,cAAND,EACF5D,EAAUyY,KAEhB,OACE,cAACvT,EAAA,EAAD,CAAK2S,GAAI,EAAGpJ,GAAI,EAAhB,SACE,eAACV,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAAoB5Y,UAAWF,EAAQmS,KAAvC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,iCAClC,sBAAK1D,UAAWF,EAAQuR,MAAxB,UACG/J,EAAKuR,SADR,IACmB,IAChBvR,EAAKwR,UACL,SALG,aAQR,qBAA0B9Y,UAAWF,EAAQmS,KAA7C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,uCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC3N,EAAE8U,GAAclR,EAAKoK,iBAF/C,oBAKNiH,GACA,qCACE,qBAAqB3Y,UAAWF,EAAQmS,KAAxC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,kCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAK+P,UAAY3T,EAAE,mCAAqCA,EAAE,sCAFpF,cAKP4D,EAAK+P,WACJ,mCACE,qBAA4BrX,UAAWF,EAAQmS,KAA/C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,yCAClC,qBAAK1D,UAAWF,EAAQuR,MAAO7I,MAAO,CAAE4J,UAAW,MAAOI,YAAa,QAAvE,SACGlL,EAAKyR,kBAER,qBAAK/Y,UAAWF,EAAQmK,MAAOzB,MAAO,CAAE4J,UAAW,MAAOE,WAAY,QAAtE,SACG5O,EAAE,0CAEL,qBAAK1D,UAAWF,EAAQuR,MAAO7I,MAAO,CAAE4J,UAAW,OAAnD,SACG9K,EAAK0R,qBATF,+B,cCvCjB,SAASC,GAAyB1a,GACvC,IAAQwK,EAAkExK,EAAlEwK,KAAMoK,EAA4D5U,EAA5D4U,QAAS+F,EAAmD3a,EAAnD2a,UAAW9F,EAAwC7U,EAAxC6U,MAAO+F,EAAiC5a,EAAjC4a,qBAAsBzF,EAAWnV,EAAXmV,OAEvDhQ,EAAMC,cAAND,EAER,OACE,cAAC,KAAD,CACEqF,KAAMA,EACNoK,QAASA,EACTQ,MAAO,CACLN,SAAU3P,EAAE,wBACZmU,SAAU,kBAAMqB,EAAU,aAAavK,UAAYuK,EAAU,WAAWvK,WAAcjL,EAAE,uCAE1FkQ,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAAC+H,GAAA,EAAD,6BACM/H,GADN,IAEE5I,SAAU,SAACyP,GACT7G,EAAM5I,SAASyP,GACfiB,KAEFE,MAAM,EACNC,OAAO,mBACPC,aAAW,EACXC,YAAa,EACbpG,MAAOA,EACP1R,QAASgS,EAAO3K,GAChBgL,WAAYL,EAAO3K,IAAU2K,EAAO3K,GAAqBtD,QACzDuJ,IAAK,WCNf,IAAMuJ,GAAyBvG,KAEzBvS,GAAYC,aAAW,SAACiS,GAC5B,OAAO3I,aAAa,CAClByQ,WAAY,CACVpZ,UAAWsR,EAAWrR,QAAQ,GAC9BuK,aAAc8G,EAAWrR,QAAQ,IAEnCoZ,KAAM,CACJva,MAAO,MACPH,SAAU,QACV2B,OAAQ,QAKRgZ,GAAiB7b,YAAY,CACjCC,QAAS,CACPC,QAAS,CACP6C,KAAM5C,KAAO,MAEfC,UAAW,CACT2C,KAAM+Q,KAAK,OAGfrT,MAAO,CACLC,aAAc,CACZC,QAAS,WACTkC,OAAQ,QACRoE,WAAW,EACX6U,QAAS,MAOTC,GAAyB,SAACC,GAAD,OAA4D,IAA5CC,KAAKC,KAAKF,EAAKnL,UAAY,IAAO,GAAK,GAAY,GAAK,GAO1FsL,GAAe,cAStBC,GAAmB,SAACC,EAAcvD,EAAiBwD,GACvD,IAAMC,EAAYF,GAAgB,IAAI5a,KAChC6X,EAAOR,GAAkB,GAE/B,MAAO,CACL0D,KAAM,MACNC,QAAS,GACTC,QAAS,GACTC,UAAW,GACXC,aAAc,GACdC,YAAa,GACbC,OAAQ,CAAEC,QAAS,GAAIxH,SAAU,GAAIyH,SAAU,IAC/CC,WATiBX,GAAgB,UAUjCY,WAAW,gBACRf,GAAe,CACdgB,YAAa7D,EACbC,WAAW,EACX0B,gBAAiB,EACjBC,iBAAkB,IAGtBkC,QAAS,GACTC,YAAa,GACbC,UAAWC,aAAWxB,GAAuBQ,GAzCnB,GA0C1BiB,QAASD,aAAWxB,GAAuBQ,GAAYkB,MAYpD,SAASC,GAAmBjd,GACjC,IAAQ0B,EAA4C1B,EAA5C0B,KAAM0F,EAAsCpH,EAAtCoH,QAAS2B,EAA6B/I,EAA7B+I,KAAMO,EAAuBtJ,EAAvBsJ,OAAQ4T,EAAeld,EAAfkd,WAE7B/X,EAAMC,cAAND,EACF5D,EAAO,6BAAQyY,MAA6B9Y,MAC5CmH,EAAkBC,qBAAWZ,IAC7BrC,EAAQC,cAGd,EAAsCC,oBAAS,GAA/C,mBAAO4X,EAAP,KAAoBC,EAApB,KAGMC,EAAgB1B,KACtB,EASI2B,aAAgB,CAAED,gBAAeE,eAAgB,aARnD3I,EADF,EACEA,QACA+F,EAFF,EAEEA,UACA6C,EAHF,EAGEA,aACAC,EAJF,EAIEA,MACAtF,EALF,EAKEA,SACAuF,EANF,EAMEA,QACAC,EAPF,EAOEA,SAPF,IAQEC,UAAazI,EARf,EAQeA,OAAQ0I,EARvB,EAQuBA,QAASC,EARhC,EAQgCA,aAAcC,EAR9C,EAQ8CA,YAI9CxV,qBAAU,WAENkV,EADE/b,GAAUqH,EACN,CACJgT,KAAM,MACNC,QAASjT,EAAKiT,QACdC,QAASlT,EAAKkT,QACdC,UAAWnT,EAAKmT,UAChBC,aAAcpT,EAAKoT,aACnBC,YAAarT,EAAKqT,YAClBC,OAAQtT,EAAKsT,OACbG,WAAYzT,EAAKyT,WACjBC,WAAYuB,OAAOC,KAAKlV,EAAK0T,YAAYyB,QAAO,SAACC,EAAQtF,GAOvD,OANAsF,EAAOtF,GAAQ,CACb6D,YAAa7D,EACbC,UAAW/P,EAAK0T,WAAW5D,GAAMC,UACjC0B,gBAAiBzR,EAAK0T,WAAW5D,GAAM2B,gBACvCC,iBAAkB1R,EAAK0T,WAAW5D,GAAM4B,kBAEnC0D,IACN,IACHxB,QAAS5T,EAAK4T,QACdC,YAAa7T,EAAK6T,YAClBC,UAAW,IAAI7b,KAAK+H,EAAKqV,eACzBrB,QAAS,IAAI/b,KAAK+H,EAAKsV,cAGnBjH,KAAEkH,UAAU3C,GAAgB,OAACuB,QAAD,IAACA,OAAD,EAACA,EAAYtB,MAAb,OAAoBsB,QAApB,IAAoBA,OAApB,EAAoBA,EAAY7E,OAAhC,OAAwC6E,QAAxC,IAAwCA,OAAxC,EAAwCA,EAAYV,gBAEvF,CAACzT,EAAMrH,EAAM+b,EAAOP,IAIvB,MAAsC3X,oBAAS,GAA/C,mBAAOgZ,EAAP,KAAoBC,EAApB,KAGMC,EAAkB9F,aAAS,CAAE/D,UAASpK,KAAM,eAG5CkU,EAAe,iCAA6BrZ,EAAMO,OAAOD,UAC/D,EAAgCJ,mBAASmZ,GAAzC,mBAAOC,EAAP,KAAiBC,EAAjB,KACA,EAA0B/V,GAAoB8V,EAAU,IAAzCvG,EAAf,oBAASrP,KAGH8V,EAAgBxV,uBAAY,WACN,QAAtBsR,EAAU,QAEZiE,EAAYF,GAEZE,EACEF,EAAe,iBACH/D,EAAU,aAAavK,UADpB,gBACqCuK,EAAU,WAAWvK,WADzE,sBAEiBuK,EAAU,kBAG9B,CAAC+D,EAAiB/D,IAGrBpS,qBAAU,WACJ7G,GACFmd,MAED,CAACA,EAAend,EAAM+c,IAGzBlW,qBAAU,WACH7G,GAAM8c,GAAe,KACzB,CAAC9c,IAKJ,MAA8C6D,oBAAS,GAAvD,mBAAO+S,GAAP,KAAwBwG,GAAxB,KAGAvW,qBAAU,WAEgB,WAApBkW,GACFtG,EAAS,eAAgB,GAAI,CAAEY,aAAa,IAC5CZ,EAAS,cAAe,GAAI,CAAEY,aAAa,IAC3C+F,IAAmB,IAGnBA,IAAmB,KAEpB,CAAC3G,EAAUsG,IAGd,IAcMM,GAA+B,uCAAG,WAAOxK,GAAP,uBAAA3R,EAAA,+DAEhCmD,EAAM,GAF0B,KAG5BwO,EAASwH,KAHmB,OAI7B,QAJ6B,OAO7B,QAP6B,OAW7B,QAX6B,8BAKhChW,EAAM,gBAL0B,mCAQhCA,EAAM,gBAR0B,mCAYhCA,EAAM,gBAZ0B,8CAgBfuO,GAAcvO,EAAK,CAAEiZ,OAAQzK,EAAUwJ,YAAaA,IAhBrC,aAgB9BlY,EAhB8B,QAiBxBoZ,QAjBwB,oBAkBZ,QAAlB1K,EAASwH,KAlBqB,kCAkBC,IAAIvH,SAAQ,SAAC0K,GAAD,OAAOvW,WAAWuW,EAAG,QAlBlC,yBAmB5B5V,IAnB4B,QAoBlClC,IACAiB,EAAgBN,SAAS,CAAEf,KAAM,UAAWE,QAAS/B,EAAE,+BArBrB,wBAwBlC,GAAIU,EAAQsP,OAEV,IAASgK,KADHhK,EAAStP,EAAQsP,OAGrBwI,EADInT,EAAO2U,EACI,CAAEjY,QAAS/B,EAAEgQ,EAAO3K,GAAO,MA5BZ,0DAkCpCnC,EAAgBN,SAAS,CAAEf,KAAM,QAASE,QAAS,KAAiBA,UAlChC,0DAAH,sDAuC/BkY,GAAY,uCAAG,sBAAAxc,EAAA,sEACE8a,EAAQ,CAAC,YAAa,YADxB,kEAGnBmB,IACAL,GAAe,GAJI,2CAAH,qDAQZa,GAAqB,WACC,QAAtB1E,EAAU,UACT4D,GACHC,GAAe,KAsBnB,OACE,qCACE,cAACld,EAAD,CAASI,KAAMoc,IACf,cAACtG,GAAD,CAAU9V,KAAMA,EAAM0F,QAASA,EAASsE,MAAOvG,EAAE,qBAAjD,SACE,eAACma,EAAA,EAAD,CAAehgB,MAAO8b,GAAtB,YACKrS,GACD,cAACtC,EAAA,EAAD,CAAK2S,GAAI,EAAT,SAEQrQ,EAAKwW,sBAEA,mBAAG9d,UAAWF,EAAQ4Z,KAAtB,SAA6BhW,EAAE,0CAIpC,eAACmK,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAA0B5Y,UAAWF,EAAQmS,KAA7C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,uCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC3N,EAAE8U,GAAclR,EAAKoK,iBAF/C,mBAIR,qBAA2B1R,UAAWF,EAAQmS,KAA9C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,wCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKyW,oBAF/B,yBAWpB,iCACE,eAAC/Y,EAAA,EAAD,CAAKgZ,EAAG,EAAR,UACE,cAAC9K,GAAD,CAAqBnK,KAAK,UAAUoK,QAASA,EAASC,MAAO1P,EAAE,mCAAoC2P,UAAQ,EAACK,OAAQA,IAEpH,cAACQ,GAAD,CACEnL,KAAM,iBACNoK,QAASA,EACTC,MAAO1P,EAAE,0CACTgQ,OAAQA,EACRF,UAAU,EACVhL,MAAO,CAAEjI,QAAS,UAEpB,cAAC2T,GAAD,CACEnL,KAAM,kBACNoK,QAASA,EACTC,MAAO1P,EAAE,2CACTgQ,OAAQA,EACRF,SAAQ,OAAElM,QAAF,IAAEA,OAAF,EAAEA,EAAMwW,wBAElB,cAAC5J,GAAD,CACEnL,KAAM,kBACNoK,QAASA,EACTC,MAAO1P,EAAE,2CACTgQ,OAAQA,EACRF,SAAQ,OAAElM,QAAF,IAAEA,OAAF,EAAEA,EAAMwW,wBAGlB,cAAC9Y,EAAA,EAAD,CAAKiZ,GAAI,EAAGzV,MAASlB,EAAO,CAAE/G,QAAS,aAAWoU,EAAlD,SACE,cAACzB,GAAD,CACEnK,KAAM,aACNoK,QAASA,EACTC,MAAO1P,EAAE,iCACT2P,UAAQ,EACRC,WAAYX,GAA2B9J,KAAI,SAAC9F,GAC1C,MAAO,CAAEqQ,MAAO1P,EAAE,gCAAD,OAAiCX,IAAUA,MAAOA,MAErEyQ,WAAYlM,EACZoM,OAAQA,MAIZ,eAACoE,GAAA,EAAD,CAAM5M,WAAS,EAAC5K,QAAS,EAAzB,UACE,cAACwX,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAf,SACE,cAACkB,GAAD,CACElQ,KAAK,YACLoK,QAASA,EACT+F,UAAWA,EACX9F,MAAO1P,EAAE,sCACTyV,qBAhGY,WAC5B,IAAMmC,EAAUD,aAAWxB,GAAuBX,EAAU,cAAeqC,IAC3E7E,EAAS,UAAW4E,EAAS,CAAEhE,aAAa,IAC5CsG,MA8FgBlK,OAAQA,MAGZ,cAACoE,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAf,SACE,cAACkB,GAAD,CACElQ,KAAK,UACLoK,QAASA,EACT+F,UAAWA,EACX9F,MAAO1P,EAAE,oCACTyV,qBApGU,WAC1ByE,MAoGgBlK,OAAQA,MAGZ,cAACoE,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAGvP,MAAO,CAAE7H,OAAQ,QAAnC,SACE,cAACkE,EAAA,EAAD,CAAQC,QAAS6Y,GAAclf,QAAQ,YAAYU,MAAM,UAAU4F,WAAS,EAACyO,UAAc,OAAJlM,QAAI,IAAJA,OAAA,EAAAA,EAAMwW,yBAA0BhB,EAAvH,SACGpZ,EAAE,kCAMT4D,EAaA,mCACIA,EAAKwW,sBAeL,cAACD,EAAA,EAAD,CAAehgB,MAAO8T,GAAtB,SACG4K,OAAOC,KAAKlV,EAAK0T,YAAYnS,KAAI,SAAC+N,GACjC,OAAO,cAAC8B,GAAD,CAA6BpR,KAAMA,EAAK0T,WAAWpE,IAA9BA,SAf/BkG,GACC,cAACrG,GAAD,CACEtD,QAASA,EACTuD,SAAUA,EACVC,MAAOA,EACPC,OAAQ2F,OAAOC,KAAKlV,EAAK0T,YAAY,GACrClE,cAAc,EACdD,gBAAqC,WAApBvP,EAAKyT,WACtBrH,OAAQA,OAtBfoJ,GACC,cAACrG,GAAD,CACEtD,QAASA,EACTuD,SAAUA,EACVC,MAAOA,EACPC,OAAQqD,GACRpD,gBAAiBA,GACjBnD,OAAQA,IA6Bd,eAAC1O,EAAA,EAAD,CAAKgZ,EAAG,EAAGxV,MAAOqO,GAAkB,CAAEtW,QAAS,aAAWoU,EAA1D,UACE,cAACzB,GAAD,CACEnK,KAAK,eACLoK,QAASA,EACTC,MAAO1P,EAAE,mCACT2P,UAAWwD,GACXrD,SAAUqD,GACVnD,OAAQA,IAEV,cAACR,GAAD,CACEnK,KAAK,cACLoK,QAASA,EACTC,MAAO1P,EAAE,kCACT8P,SAAUqD,GACVnD,OAAQA,OAIZ,eAAC1O,EAAA,EAAD,CAAKgZ,EAAG,EAAR,UACE,cAAC9K,GAAD,CAAqBnK,KAAK,UAAUoK,QAASA,EAASC,MAAO1P,EAAE,6BAA8B6P,WAAS,EAACG,OAAQA,IAC/G,cAACR,GAAD,CAAqBnK,KAAK,cAAcoK,QAASA,EAASC,MAAO1P,EAAE,kCAAmCgQ,OAAQA,OAGhH,cAAC1O,EAAA,EAAD,CAAK2S,GAAI,EAAT,SACE,eAACG,GAAA,EAAD,CAAM5M,WAAS,EAACT,eAAe,gBAAgBnK,QAAS,EAAGN,UAAWF,EAAQ2Z,WAA9E,UACE,cAAC3B,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAKzQ,EAAY,EAAL,GAAvB,SACE,cAACzC,EAAA,EAAD,CACEC,QA3PC,WACjBiX,EAAauB,GAAbvB,IA2PgBtd,QAAQ,YACRU,MAAM,UACNqU,UAAW4I,GAAWU,EACtBoB,UAAW,cAAC,KAAD,IACXnZ,WAAS,EANX,SAQGrB,EAAE,0BAGP,cAACoU,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAGvP,MAAQlB,OAA6BqN,EAAtB,CAAEpU,QAAS,QAA5C,SACE,cAACsE,EAAA,EAAD,CAAQC,QAlQH,WACnB6W,GAAe,IAiQ8Bld,QAAQ,YAAYU,MAAM,UAA+B+e,UAAW,cAAC,KAAD,IAAgBnZ,WAAS,EAA5H,SACGrB,EAAE,yCAQjB,cAAC4S,GAAD,CAAqBrW,KAAMyb,EAAa/V,QAhMjB,SAACwY,GAC1BxC,GAAe,GACXwC,IAxEJzH,EAAS,OAAQ,OACjBqF,EAAauB,GAAbvB,UCpPJ,IAAMtc,GAAYC,aAAW,SAAC7B,GAAD,OAC3BmL,aAAa,CACXrJ,KAAM,CACJY,QAAS,OAET6d,SAAU,OACV,QAAS,CACPzd,OAAQ9C,EAAMyC,QAAQ,WAWvB,SAAS+d,GAAT,GAAuE,IAAxCX,EAAuC,EAAvCA,IAAKpW,EAAkC,EAAlCA,KACnCxH,EAAUL,KAChB,OACE,qBAAKO,UAAWF,EAAQH,KAAxB,SACG2H,EAAKuB,KAAI,SAACpG,EAAM6b,GAAP,OACR,cAAClJ,GAAA,EAAD,CAA0BhC,MAAO3Q,EAAKsG,MAAtC,UAAc2U,EAAd,YAAqBY,SCd7B,IAAM/F,GAAyBvG,KAQxB,SAASuM,GAAkBhgB,GAChC,IAAQ0B,EAAwB1B,EAAxB0B,KAAM0F,EAAkBpH,EAAlBoH,QAAS2B,EAAS/I,EAAT+I,KAEf5D,EAAMC,cAAND,EACF5D,EAAUyY,KAGhB,OAAKjR,EAAKkX,YASR,eAACzI,GAAD,CAAU9V,KAAMA,EAAM0F,QAASA,EAASsE,MAAOvG,EAAE,qBAAjD,UACE,cAACsB,EAAA,EAAD,CAAK2S,GAAI,EAAGpJ,GAAI,EAAhB,SACE,eAACV,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAAwB5Y,UAAWF,EAAQmS,KAA3C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,qCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKkT,YAF/B,iBAIR,qBAAmBxa,UAAWF,EAAQmS,KAAtC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,iCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKmX,aAF/B,YAIR,qBAA2Bze,UAAWF,EAAQmS,KAA9C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,wCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKyW,oBAF/B,yBAOZ,cAAC/Y,EAAA,EAAD,CAAK2S,GAAI,EAAGpJ,GAAI,EAAhB,SACE,eAACV,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAA0B5Y,UAAWF,EAAQmS,KAA7C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,6CAClC,qBAAK1D,UAAWF,EAAQ2S,UAAxB,SACE,cAAC4L,GAAD,CAA2C/W,KAAMA,EAAKsT,OAAOvH,UAApC,uBAHrB,mBAMR,qBAA0BrT,UAAWF,EAAQmS,KAA7C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,6CAClC,qBAAK1D,UAAWF,EAAQ2S,UAAxB,SACE,cAAC4L,GAAD,CAA2C/W,KAAMA,EAAKsT,OAAOE,UAApC,uBAHrB,wBASXyB,OAAOC,KAAKlV,EAAK0T,YAAYnS,KAAI,SAAC+N,GACjC,OAAO,cAAC8B,GAAD,CAA6BpR,KAAMA,EAAK0T,WAAWpE,IAA9BA,MAG9B,cAAC5R,EAAA,EAAD,CAAK2S,GAAI,EAAGpJ,GAAI,EAAG/F,MAA2B,WAApBlB,EAAKyT,WAA0B,CAAExa,QAAS,aAAWoU,EAA/E,SACE,eAAC9G,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAAwB5Y,UAAWF,EAAQmS,KAA3C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,qCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKoT,iBAF/B,iBAIR,qBAAuB1a,UAAWF,EAAQmS,KAA1C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,oCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKqT,gBAF/B,qBAOZ,cAAC3V,EAAA,EAAD,CAAKgZ,EAAG,EAAGzP,GAAI,EAAf,SACE,eAACV,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAAkB5Y,UAAWF,EAAQmS,KAArC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,+BAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAK4T,YAF/B,WAIR,qBAAuBlb,UAAWF,EAAQmS,KAA1C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,oCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAK6T,gBAF/B,wBAjEZ,cAACpF,GAAD,CAAU9V,KAAMA,EAAM0F,QAASA,EAASsE,MAAOvG,EAAE,qBAAjD,SACGA,EAAE,gCCNJ,IAAMgb,GAAoB,SAACrZ,EAAwBC,GACxD,OAAQA,EAAOC,MACb,IAAK,YACH,MAAO,CAAE+U,KAAM,UAAWqE,WAAW,EAAMC,UAAU,GACvD,IAAK,cACH,MAAO,CAAEtE,KAAM,UAAWqE,WAAW,EAAMC,UAAU,EAAOnD,WAAYnW,EAAOmW,YACjF,IAAK,aACH,OAAO,6BAAKpW,GAAZ,IAAmBsZ,WAAW,IAChC,IAAK,WACH,MAAO,CAAErE,KAAM,UAAWqE,WAAW,EAAOC,UAAU,GACxD,IAAK,YACH,OAAO,6BAAKvZ,GAAZ,IAAmBuZ,UAAU,IAC/B,QACE,OAAOvZ,IAeN,SAASwZ,GAActgB,GAC5B,IAAQugB,EAA4DvgB,EAA5DugB,eAAgB/a,EAA4CxF,EAA5CwF,UAAW8D,EAAiCtJ,EAAjCsJ,OAAQkX,EAAyBxgB,EAAzBwgB,WAAY3Y,EAAa7H,EAAb6H,SAGjD4Y,EAAsB,uCAAG,sBAAA7d,EAAA,sDAC7B2d,EAAexY,SAAS,CAAEf,KAAM,eADH,2CAAH,qDAItB0Z,EAAqB,uCAAG,sBAAA9d,EAAA,sDAC5B2d,EAAexY,SAAS,CAAEf,KAAM,cADJ,2CAAH,qDAI3B,OACE,eAACsY,EAAA,EAAD,CAAehgB,MAAO8T,GAAtB,UACE,cAAC9R,EAAD,CAASI,KAAM8D,IACdqC,EACD,cAACoV,GAAD,CACEvb,KAAM6e,EAAezZ,MAAMsZ,UAC3BhZ,QAASqZ,EACT1X,KAAoC,YAA9BwX,EAAezZ,MAAMiV,KAAqB,KAAOyE,EACvDlX,OAAQA,EACR4T,WAAYqD,EAAezZ,MAAMoW,eAEhCsD,GAAc,cAACR,GAAD,CAAmBte,KAAM6e,EAAezZ,MAAMuZ,SAAUjZ,QAASsZ,EAAuB3X,KAAMyX,OC5DrH,IAAMtf,GAAY4Q,KAeX,SAAS6O,GAAU3gB,GACxB,IAAQ4gB,EAAgC5gB,EAAhC4gB,YAAaL,EAAmBvgB,EAAnBugB,eAEbpb,EAAMC,cAAND,EACF5D,EAAUL,KACVmE,EAAQC,cAGd,EAA+CuD,GAAW,qCAC1B+X,EAAaxQ,UADa,qBACS/K,EAAMO,OAAOD,UAC9E,IAFF,0BAASoD,EAAT,EAASA,KAAMvD,EAAf,EAAeA,UAAW0D,EAA1B,EAA0BA,QAAWI,EAArC,KAMA,EAAoC/D,mBAA6B,MAAjE,mBAAOib,EAAP,KAAmBK,EAAnB,KAGMC,EAAmBzX,uBACvB,SAAC0X,GACKA,EAAYC,SACdT,EAAexY,SAAS,CAAEf,KAAM,cAEhCuZ,EAAexY,SAAS,CAAEf,KAAM,aAElC6Z,EAAcE,KAEhB,CAACR,IAGGU,EAAqB,CACzB,CAAEvV,MAAOvG,EAAE,+BAAgC2N,MAAO,YAClD,CAAEpH,MAAOvG,EAAE,+BAAgC2N,MAAO,YAClD,CAAEpH,MAAOvG,EAAE,mCAAoC2N,MAAO,WACtD,CAAEpH,MAAOvG,EAAE,mCAAoC2N,MAAO,gBACtD,CAAEpH,MAAOvG,EAAE,sCAAuC2N,MAAO,oBAI3D,OAAI5J,EACK,8BAAM/D,EAAE,6BAIf,cAACmb,GAAD,CAAeE,WAAYA,EAAYD,eAAgBA,EAAgB/a,UAAWA,EAAW8D,OAAQA,EAArG,SACE,cAAC,KAAD,CACE2X,QAASA,EACTC,WAAY,CAEVC,KAAM,SAACnhB,GAAD,OAAW,cAAC,cAAD,6BAAgBA,GAAhB,IAAuByB,UAAWoR,GAAU7S,EAAMohB,UAAUtO,MAAO9S,EAAM+S,QAASxR,QAErGwH,KAAMA,EACNsY,WAAY,SAACrZ,EAAQ+Y,GAAT,QAA4BA,GAAeD,EAAiBC,IACxEzK,QAAO,cACLgL,WAAW,EACXlhB,SAAS,EACTqI,QAAQ,EACR8Y,YAAa,CAAElf,gBAAiB+Q,GAAW5T,QAAQC,QAAQqU,OAC3D0N,YAAa,SACV9P,IAEL+P,MAAOnR,O,mCCvFTpP,GAAYC,YAAW,CAC3BugB,mBAAoB,CAClB,iCAAkC,CAAEpW,aAAc,MAmCvCqW,OAzBf,YAAiE,IAA3C9M,EAA0C,EAA1CA,MAAO0G,EAAmC,EAAnCA,KAAMrR,EAA6B,EAA7BA,SAC3B3I,EAAUL,KAChB,OACE,cAAC,KAAD,CACEkB,OAAO,SACP6M,GAAG,qBACH4F,MAAOA,EACPkG,OAAO,aACP6G,iBAAe,EACfpd,MAAO+W,EACPrR,SAAUA,EACV2X,oBAAqB,CACnB,aAAc,eAEhB9X,KAAK,QACLtI,UAAWF,EAAQmgB,mBACnB5H,WAAY,CACV7P,MAAO,CACLzH,MAAO,QCzBXtB,GAAYC,aAAW,iBAAO,CAClC2gB,WAAY,CACV1f,OAAQ,UAEVsJ,MAAO,CACLtJ,OAAQ,mBAaL,SAAS2f,GAAc/hB,GAC5B,IAAQ0L,EAAiE1L,EAAjE0L,MAAOsW,EAA0DhiB,EAA1DgiB,SAAUzG,EAAgDvb,EAAhDub,KAAM0G,EAA0CjiB,EAA1CiiB,aAAcla,EAA4B/H,EAA5B+H,SAAUma,EAAkBliB,EAAlBkiB,cAE/C/c,EAAMC,cAAND,EACF5D,EAAUL,KAOhB,OACE,mCACE,eAACqY,GAAA,EAAD,CAAM5M,WAAS,EAACzK,WAAW,UAAUgK,eAAe,gBAApD,UACE,eAACqN,GAAA,EAAD,CAAM5M,WAAS,EAACpI,MAAI,EAACiV,GAAI,GAAI2I,GAAMD,EAAgB,EAAI,EAAvD,UACE,cAAC3I,GAAA,EAAD,CAAMhV,MAAI,EAAC9C,UAAWF,EAAQugB,WAA9B,SACE,cAAC,GAAD,CAAYjN,MAAO1P,EAAE,4BAA6BoW,KAAMA,EAAMrR,SAAU+X,MAE1E,cAAC1I,GAAA,EAAD,CAAMhV,MAAI,EAAC9C,UAAWF,EAAQmK,MAA9B,SACE,cAAC/K,EAAA,EAAD,CAAYuF,UAAU,KAAtB,SAA4BwF,SAIhC,eAAC6N,GAAA,EAAD,CAAM5M,WAAS,EAACpI,MAAI,EAAC2H,eAAe,WAAWhK,WAAW,SAASH,QAAS,EAAGyX,GAAI,GAAI2I,GAAMD,EAAgB,EAAI,EAAjH,YACKA,GACDA,EAAc5X,KAAI,SAAC/F,EAAMmR,GACvB,OACE,cAAC6D,GAAA,EAAD,CAAMhV,MAAI,EAAV,SACGA,GADH,wBAAiCmR,OAKvC,cAAC6D,GAAA,EAAD,CAAMhV,MAAI,EAAV,SACE,cAAC+B,EAAA,EAAD,CAAQpG,QAAQ,YAAYU,MAAM,YAAY+e,UAAW,cAAC,KAAD,IAAmBpZ,QA1B5D,SAACyB,GACzBD,EAAS,CAAEf,KAAM,iBAyBT,SACG7B,EAAE,gCAKT,cAACsB,EAAA,EAAD,CAAKuJ,GAAI,EAAT,SAAagS,SCpDd,SAASI,KACd,IAAQjd,EAAMC,cAAND,EAGR,EAAsCI,oBAAS,GAA/C,mBAAO8c,EAAP,KAAoBC,EAApB,KACA/Z,qBAAU,WACR+Z,GAAe,KACd,IAGH,MAAwCrS,KAAxC,mBAAOC,EAAP,KAAqBC,EAArB,KAYA,EAA8CrI,qBAAWqY,GANnB,CACpCpE,KAAM,UACNqE,WAAW,EACXC,UAAU,IAGZ,mBAAOkC,EAAP,KAAwBC,EAAxB,KAaA,OATAja,qBAAU,WACFzD,MACJqL,EAAgB,IAAInP,KAAKyhB,OAAO7d,EAAe,mBAC/CG,OAGD,IAID,cAAC,GAAD,UACE,eAAC2d,GAAA,EAAD,CAAOC,QAAM,EAAb,UACE,cAAClc,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAACsC,GAAD,CACErW,MAAOvG,EAAE,wBACT6c,SAAU7c,EAAE,0BAAD,OAA2Bkd,EAAc,gBAAkB,KACtE9G,KAAMrL,EACN+R,aAhCe,SAAC1G,GACxBpL,EAAgBoL,IAgCRxT,SAAUya,MAGd,cAAC/b,EAAA,EAAD,CAAK2S,GAAI,EAAGwJ,GAAI,EAAhB,SACE,cAACjC,GAAD,CAAWC,YAAa1Q,EAAeqQ,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,Y,wEC7B/FK,GAAuB,CAC3BrgB,MAAO,IACPsgB,UAAW,GACXC,MAAO,EACPC,UAAW,CAAEC,GAAI,IAAKC,EAAG,IAcrBC,GAAa,GAGbC,GAAc,SAACC,EAAYC,GAC/B,IAAMC,EAAOC,aAAWH,GACxB,OAAOI,aAAoBJ,EAAME,GAAQD,EAASP,OAQ9CW,GAAa,SAACnf,EAAoB+e,EAAoB1C,GAC1D,IAAMhF,EAAQ,IAAI5a,KAAKuD,EAAKqX,OACtB+H,EAAM,IAAI3iB,KAAKuD,EAAKof,KACtBV,EAAIG,GAAYxH,EAAO0H,GACvBM,EAAKR,GAAYO,EAAKL,GAE1B,IAAKO,aAAUjI,EAAO+H,GAAM,CAC1B,IAAMG,EAAiBN,aAAW5C,GAC5BmD,EAAeC,aAASpD,GAE1BqD,aAASF,EAAcJ,KACzBC,EAAKR,GAAYW,EAAcT,IAG7BY,aAAQJ,EAAgBlI,KAC1BqH,EAAIG,GAAYU,EAAgBR,IAGpC,MAAO,CACLL,EAAGA,EACHzgB,MAAOohB,EAAKX,EACZxhB,UAAW8C,EAAK2V,SAIdiK,GAAQ,SAACC,EAAc5hB,GAAf,OAAkC4hB,EAAO,GAAK5hB,EAxCpC,GA0ClB6hB,GAAkB,SAACf,GACvB,MAAM,aAAN,OAAoBA,EAASN,UAAUC,EAAvC,YAA4CK,EAASN,UAAUE,EAA/D,MAGIoB,GAAcC,cAAW,SAACjlB,GAAD,MAAY,CACzCkB,QAAS,CACP6B,gBAAiB/C,EAAME,QAAQ6T,KAAK,KACpCzS,MAAOtB,EAAME,QAAQglB,KAAK/kB,QAC1B0G,SAAU,IACV1F,SAAUnB,EAAMO,WAAW4kB,QAAQ,IACnC9R,OAAO,aAAD,OAAerT,EAAME,QAAQ6T,KAAK,UANxBkR,CAQhB9U,MAEEvO,GAAYC,aAAW,SAAC7B,GAAD,OAC3BmL,aAAa,CACXkC,UAAW,CACT3K,QAAS,OACTC,cAAe,SACfqK,aAAc,SAEd,QAAS,CACP7L,SAAU,SACV,SAAU,CACRikB,YAAa,GAEf,mBAAoB,CAClBC,OAAQrlB,EAAME,QAAQ6T,KAAK,MAE7B,wBAAyB,CACvBsR,OAAQrlB,EAAME,QAAQ6T,KAAK,MAE7B,SAAU,CACRuR,KAAMtlB,EAAME,QAAQ6T,KAAK,MAE3B,iBAAkB,CAChBuR,KAAM,OACNnkB,SAAU,SACVokB,iBAAkB,UAClBC,OAAQ,WAEV,SAAU,CACRJ,YAAa,EACbK,YAAa,IAEf,uBAAwB,CACtBA,YAAa,GAEf,eAAgB,CACdJ,OAAQrlB,EAAME,QAAQyf,QAAQ3c,KAC9BsiB,KAAMtlB,EAAME,QAAQyf,QAAQnL,MAC5BiR,YAAa,GACbD,OAAQ,WAEV,eAAgB,CACdH,OAAQrlB,EAAME,QAAQwlB,KAAK1iB,KAC3BsiB,KAAMtlB,EAAME,QAAQwlB,KAAKlR,OAE3B,cAAe,CACb6Q,OAAQrlB,EAAME,QAAQylB,QAAQnR,MAC9B8Q,KAAMtlB,EAAME,QAAQylB,QAAQ3iB,MAE9B,cAAe,CACbqiB,OAAQrlB,EAAME,QAAQ2D,MAAM2Q,MAC5B8Q,KAAMtlB,EAAME,QAAQ2D,MAAMb,QAIhCoJ,MAAO,CAELjL,SAAU,OACVoM,cAAe,QAmBd,SAASqY,GAAQllB,GACtB,IAAQugB,EAAwFvgB,EAAxFugB,eAAgB4E,EAAwEnlB,EAAxEmlB,SAAUC,EAA8DplB,EAA9DolB,OAAQC,EAAsDrlB,EAAtDqlB,gBAAiBC,EAAqCtlB,EAArCslB,SAAUC,EAA2BvlB,EAA3BulB,SAAUC,EAAiBxlB,EAAjBwlB,aACzEjkB,EAAUL,KAEhB,EAAgCqE,mBAASsd,IAAzC,mBAAOS,EAAP,KACA,GADA,KACkC/d,mBAAS8e,GAAgBf,KAA3D,mBAAON,EAAP,KAAkByC,EAAlB,KAMAld,qBAAU,WACRkd,EAAapB,GAAgBf,MAC5B,CAACA,EAAU8B,IAEd,IACMM,EAAQvC,GACRwC,EAAa,GACbC,EAAkC,SAAlBT,EAASne,KAvJd,GAuJ6C2e,GAAcR,EAASU,cAAchc,OAAS,GAAK8b,EAvJhG,GA0JXG,EAAoBzc,uBACxB,SAAC9E,EAAoBmR,EAAeqQ,EAAmBC,GACrD,IAAMC,EAAUvC,GAAWnf,EAAM+e,EAAU,IAAItiB,KAAK+kB,IACpD,OACE,sBAEEtkB,UAAWwkB,EAAQxkB,UACnBwhB,EAAGgD,EAAQhD,EACXC,EAAGwC,EAAQC,EAAaK,EACxBxjB,MAAOyjB,EAAQzjB,MACfiK,OAAQkZ,EACRO,GAAI,EACJC,GAAI,GARN,UACUZ,EADV,eACyB7P,MAW7B,CAAC4N,EAAUiC,EAAUG,EAAOC,IAIxBS,EAAiB/c,uBACrB,SAACc,EAAoBuL,EAAeqQ,EAAmBC,GACrD,IAAMzhB,EAAqB,CAAE2V,OAAQ,QAAS0B,MAAOzR,EAAMiU,cAAeuF,IAAKxZ,EAAMkU,aAC/E4H,EAAUvC,GAAWnf,EAAM+e,EAAU,IAAItiB,KAAK+kB,IAC9C9C,EAAIgD,EAAQhD,EACZC,EAAIwC,EAAQC,EAAaK,EACzBxjB,EAAQyjB,EAAQzjB,MAEhB6jB,EAAUlc,EAAM8V,YAAc,QAAU,GAC9C,OACE,cAACqE,GAAD,CAEE5Y,MACE,qCACE,cAAC/K,EAAA,EAAD,CAAYT,QAAQ,QAApB,SAA6BiK,EAAM8R,UACnC,6BAAK9R,EAAM+V,WAFb,IAE4B,4BAAI/V,EAAMqV,qBAGxCjZ,QAAS,WACP8e,EAAgBlb,IATpB,SAYE,qBAAK8Y,EAAGA,EAAGC,EAAGA,EAAG1gB,MAAOA,EAAOiK,OAfpBkZ,GAeoCW,QAAO,cAAS9jB,EAAT,YAf3CmjB,IAeX,SACE,8BACE,sBAAMlkB,UAAWgN,aAAKwX,EAAQxkB,UAAW4kB,GAAUpD,EAAG,EAAGC,EAAG,EAAG1gB,MAAOA,EAAOiK,OAjBtEkZ,GAiBsFO,GAAI,EAAGC,GAAI,IACxG,sBAAM1kB,UAAU,UAAUwhB,EAAG,EAAGC,EAAG,MAAnC,SACG/Y,EAAM8R,gBAhBf,UACUsJ,EADV,eACyB7P,MAsB7B,CAAC4N,EAAUoC,EAAOC,EAAYJ,EAAUF,IA6BpCkB,EAAgBC,mBAAQ,WAC5B,OAAO,mCAAGrB,EAASU,cAAcvb,KAAI,SAACmc,EAAKT,GAAN,OAAmBS,EAAInc,KAAI,SAAC/F,EAAMmR,GAAP,OAAiBoQ,EAAkBvhB,EAAMmR,EAAOyP,EAAS5J,KAAMyK,aAC9H,CAACF,EAAmBX,IAGjBuB,EAAaF,mBAAQ,WACzB,OAAO,mCAAGpB,EAAO9a,KAAI,SAACmc,EAAKT,GAAN,OAAmBS,EAAInc,KAAI,SAACH,EAAOuL,GAAR,OAAkB0Q,EAAejc,EAAOuL,EAAOyP,EAAS5J,KAAMyK,aAC7G,CAACI,EAAgBhB,EAAQD,IAE5B,OACE,qCAEE,cAAC7e,EAAA,EAAD,CACE1F,MAAM,YACNa,UAAWF,EAAQmK,MACnB3B,KAAK,QACLxD,QAAS,kBAAMif,EAAaL,EAAS5J,KAAM4J,EAASwB,WAAYxB,EAAS9M,SAJ3E,SAMGiN,IAEH,qBAAK7jB,UAAWF,EAAQoL,UAAxB,SACE,qBAAK2Z,QAAO,cA/PEM,KA+PF,YAA0BhB,GAAiBiB,oBAAoB,OAA3E,SACE,oBAAG7D,UAAWA,EAAd,UACE,sBAAMvhB,UAAU,YAAYqlB,GAAI,EAAGC,GAAI,EAAGnD,GAAI,EAAGoD,GAAIpB,IACrD,sBAAMnkB,UAAU,iBAAiBqlB,GAAIxD,EAASR,UAAWiE,GAAI5D,GAAYS,GAAIN,EAASR,UAAWkE,GAAIpB,IACpGxO,KAAE6P,MAAM,EAAG,IAAI3c,KAAI,SAAC4c,GACnB,IAAMjE,EAAIkB,GAAM+C,EAAG5D,EAAS9gB,OACtB2kB,EAAOlE,EAAIK,EAASR,UACpBsE,EAAQF,EAAI5D,EAAS9gB,MApQtB,EAqQL,OACE,eAAC,WAAD,WACE,sBAA6Bf,UAAU,YAAYqlB,GAAI7D,EAAG8D,GAAI,EAAGnD,GAAIX,EAAG+D,GAAIpB,GAA5E,oBAAwBsB,IACxB,sBAAkCzlB,UAAU,iBAAiBqlB,GAAIK,EAAMJ,GAAI5D,GAAYS,GAAIuD,EAAMH,GAAIpB,GAArG,yBAA6BsB,IAC7B,sBAA6BjE,EAAGmE,EAAOlE,EAAGC,GAA1C,SACG+D,GADH,oBAAwBA,MAH1B,mBAA2BA,OAS/B,sBACEzlB,UAAU,gBACVwhB,EAAG,EACHC,EAAGwC,EACHljB,MAAO2hB,GAAM,GAAIb,EAAS9gB,OAC1BiK,OAAQmZ,EAAgBF,EACxBnf,QAAS,SAACoT,GAAD,OAtEK,SACxBxP,EACA4b,EACA1N,EACAmE,GAEA,IAAM6K,EAA4Bld,EAAM2E,cAAcwY,QAAQ,OAC9D,GAAKD,EAAL,CAEA,IAAMrX,EAAKqX,EAAIE,iBACfvX,EAAGiT,EAAI9Y,EAAMqd,QACbxX,EAAGkT,EAAI/Y,EAAMsd,QACb,IAAMC,EAAML,EAAIM,eAChB,GAAKD,EAAL,CAEA,IAEME,EAzNU,SAACC,EAAevE,GAElC,OAASuE,EADM,GACYvE,EAASP,MAAS,GAAK,IAuNlC+E,CAFD9X,EAAG+X,gBAAgBL,EAAIM,WACjB/E,EAAIK,EAASN,UAAUC,EAlOtB,EAmOaK,GAC3BD,EAA4C,IAArC7H,KAAKyM,MAAML,EAAQ,IAAO,GAAK,IAAa,GAAK,GACxDhM,EAAQ,IAAI5a,KAAKwiB,aAAWuC,GAAW3V,UAAYiT,GAEzD9C,EAAexY,SAAS,CAAEf,KAAM,cAAekW,WAAY,CAAEtB,MAAOA,EAAOvD,OAAQA,EAAQmE,WAAYA,OAiD7E0L,CAAkBvO,EAAGwL,EAAS5J,KAAM4J,EAAS9M,OAAQ8M,EAAS3I,eAE/E+J,EACAG,YChTN,SAAS/F,GAAU3gB,GACxB,IAAQ4gB,EAAsD5gB,EAAtD4gB,YAAaL,EAAyCvgB,EAAzCugB,eAAgB4H,EAAyBnoB,EAAzBmoB,OAAQ3C,EAAiBxlB,EAAjBwlB,aAErCrgB,EAAMC,cAAND,EACFE,EAAQC,cAGd,EAA+CuD,GAAW,kCAC7B+X,EAAaxQ,UADgB,qBACM/K,EAAMO,OAAOD,SADnB,qBACwCwiB,QAChG/R,GAFF,0BAASrN,EAAT,EAASA,KAAMvD,EAAf,EAAeA,UAAW0D,EAA1B,EAA0BA,QAAWI,EAArC,KAMA,EAAoC/D,mBAA6B,MAAjE,mBAAOib,EAAP,KAAmBK,EAAnB,KAGMC,EAAmBzX,uBACvB,SAAC0X,GACKA,EAAYC,SACdT,EAAexY,SAAS,CAAEf,KAAM,cAEhCuZ,EAAexY,SAAS,CAAEf,KAAM,aAElC6Z,EAAcE,KAEhB,CAACR,IAIG6H,EAAW5B,mBAAQ,WACvB,OAAKzd,EAEH,mCACGA,EAAKsf,UAAU/d,KAAI,SAAC6a,EAAUmD,GAAX,OAClB,cAACpD,GAAD,CAEE3E,eAAgBA,EAChB4E,SAAUA,EACVC,OAAQD,EAASoD,YAAYje,KAAI,SAACmc,GAAD,OAASA,EAAInc,KAAI,SAACke,GAAD,OAAgBzf,EAAMqc,OAAOoD,SAC/EnD,gBAAiBvE,EACjBwE,SAAUH,EAAS7K,SACnBiL,SAAUJ,EAAS5K,UACnBiL,aAAcA,GAPT8C,QALK,+BAiBjB,CAACvf,EAAMwX,EAAgBO,EAAkB0E,IAG5C,OAAItc,EACK,8BAAM/D,EAAE,6BAIf,cAACmb,GAAD,CAAeE,WAAYA,EAAYD,eAAgBA,EAAgB/a,UAAWA,EAAW8D,OAAQA,EAArG,SACG8e,I,uBCtDA,SAASK,GAAgBzoB,GAC9B,IAAQ4gB,EAAsD5gB,EAAtD4gB,YAAaL,EAAyCvgB,EAAzCugB,eAAgB4H,EAAyBnoB,EAAzBmoB,OAAQ3C,EAAiBxlB,EAAjBwlB,aAErCrgB,EAAMC,cAAND,EACFE,EAAQC,cACRojB,EAAiBpgB,qBAAWqgB,MAGlC,EAA+C9f,GAAW,yCACtB+X,EAAaxQ,UADS,qBACa/K,EAAMO,OAAOD,SAD1B,iBAC2CwiB,QACnG/R,GAFF,0BAASrN,EAAT,EAASA,KAAMvD,EAAf,EAAeA,UAAW0D,EAA1B,EAA0BA,QAAWI,EAArC,KAMA,EAAoC/D,mBAA6B,MAAjE,mBAAOib,EAAP,KAAmBK,EAAnB,KAGMC,EAAmBzX,uBACvB,SAAC0X,GACKA,EAAYC,SACdT,EAAexY,SAAS,CAAEf,KAAM,cAEhCuZ,EAAexY,SAAS,CAAEf,KAAM,aAElC6Z,EAAcE,KAEhB,CAACR,IAIG6H,EAAW5B,mBAAQ,WACvB,OAAKzd,EAEH,mCACGA,EAAKsf,UAAU/d,KAAI,SAAC6a,EAAUmD,GAAX,OAClB,cAACpD,GAAD,CAEE3E,eAAgBA,EAChB4E,SAAUA,EACVC,OAAQD,EAASoD,YAAYje,KAAI,SAACmc,GAAD,OAASA,EAAInc,KAAI,SAACke,GAAD,OAAgBzf,EAAMqc,OAAOoD,SAC/EnD,gBAAiBvE,EACjBwE,SAAUvK,mBAAOoK,EAAS5J,KAAM,iBAAkB,CAAEqN,OAAM,OAAEF,QAAF,IAAEA,OAAF,EAAEA,EAAgBE,SAC5ErD,SAAUJ,EAAS5J,KAAKlL,WACxBmV,aAAcA,GAPT8C,QALK,+BAiBjB,CAACvf,EAAMwX,EAAgBO,EAAvB,OAAyC4H,QAAzC,IAAyCA,OAAzC,EAAyCA,EAAgBE,OAAQpD,IAGpE,OAAItc,EACK,8BAAM/D,EAAE,6BAIf,cAACmb,GAAD,CAAeE,WAAYA,EAAYD,eAAgBA,EAAgB/a,UAAWA,EAAW8D,OAAQA,EAArG,SACG8e,I,4CCpEA,SAASS,GAAiC7oB,GAC/C,IAAQ+I,EAAoC/I,EAApC+I,KAAM+f,EAA8B9oB,EAA9B8oB,gBAAiBnf,EAAa3J,EAAb2J,SAG/B,EAAsCpE,oBAAS,GAA/C,mBAAOwjB,EAAP,KAAoBC,EAApB,KACAzgB,qBAAU,kBAAMygB,GAAe,KAAO,IAGtC,MAAgCzjB,mBAAS,IAAzC,mBAAO0jB,EAAP,KAAiBC,EAAjB,KAGA3gB,qBAAU,WAEN2gB,EADIvf,GAGQZ,EAAK,GAAGkG,MAErB,CAAClG,EAAMY,IAIVpB,qBAAU,WACHzD,KACHR,EAAgB,WAAY2kB,KAE7B,CAACA,IAIJ,IAAME,EAAkB,SAACnhB,EAA+BohB,GACtDF,EAAYE,IAIRC,EAAU7C,mBAAQ,WACtB,OACE,cAAC8C,GAAA,EAAD,CAASC,eAAe,UAAUC,UAAU,UAAUtpB,QAAQ,aAAagK,SAAUif,EAAiB,aAAW,YAAjH,gBACGpgB,QADH,IACGA,OADH,EACGA,EAAMuB,KAAI,SAAC/F,EAAMmR,GAAP,OACT,cAAC+T,GAAA,EAAD,CAA0B5U,MAAOtQ,EAAKiG,KAAMhG,MAAK,UAAKD,EAAK0K,KAA3D,cAAiByG,WAItB,CAAC3M,IAGE2gB,EAAYlD,mBAAQ,WACxB,OACE,0CACGzd,QADH,IACGA,OADH,EACGA,EAAMuB,KAAI,SAAC/F,EAAMmR,GAChB,OACE,cAACiU,GAAA,EAAD,CAAqCnlB,MAAK,UAAKD,EAAK0K,IAApD,SACG2a,uBAAad,EAAiB,CAAEX,OAAQ5jB,EAAK0K,MADhD,oBAA4ByG,WAOnC,CAAC3M,EAAM+f,IAEV,OAAKC,EAKH,eAACc,GAAA,EAAD,CAAYrlB,MAAOykB,EAAnB,UACE,cAACza,GAAA,EAAD,CAAQ3C,SAAS,SAASjL,MAAM,UAAhC,SACGyoB,IAEFK,KARI,6BCnEJ,SAASI,GAAmB9pB,GACjC,IAAQ8oB,EAA8B9oB,EAA9B8oB,gBAAiBnf,EAAa3J,EAAb2J,SAEnBtE,EAAQC,cAGd,EAAmBuD,GAAW,qCAA2CxD,EAAMO,OAAOD,UAAY,IAAzFoD,EAAT,oBAASA,KAET,OAAO,sCAAI,OAACA,QAAD,IAACA,OAAD,EAACA,EAAMc,SAAU,cAACgf,GAAD,CAAc9f,KAAMA,EAAM+f,gBAAiBA,EAAiBnf,SAAUA,MCL7F,SAASogB,GAAe/pB,GAC7B,IAAQ8oB,EAAoC9oB,EAApC8oB,gBAAiB9hB,EAAmBhH,EAAnBgH,KAAM2C,EAAa3J,EAAb2J,SAEzBtE,EAAQC,cAER0kB,EAAchjB,EAAF,gBAAkBA,GAAS,GAG7C,EAAmB6B,GAAW,iCAAmCxD,EAAMO,OAAOD,UAAhD,OAA2DqkB,GAAa,IAA7FjhB,EAAT,oBAASA,KAET,OAAO,sCAAI,OAACA,QAAD,IAACA,OAAD,EAACA,EAAMc,SAAU,cAACgf,GAAD,CAAc9f,KAAMA,EAAM+f,gBAAiBA,EAAiBnf,SAAUA,MCI7F,IAAMsgB,GAAgB,SAACnjB,EAAoBC,GAChD,OAAQA,EAAOC,MACb,IAAK,UACH,MAAO,CAAEkjB,QAAQ,EAAOC,UAAWpjB,EAAOojB,UAAWC,WAAY,oBAAqBC,cAAe,wBACvG,IAAK,SACH,MAAO,CACLH,QAAQ,EACRC,UAAWpjB,EAAOojB,UAClBC,WAAY,2BACZC,cAAe,+BAEnB,QACE,OAAOvjB,IAIN,SAASwjB,KACd,IAAQnlB,EAAMC,cAAND,EAGR,EAAwC8K,KAAxC,mBAAOC,EAAP,KAAqBC,EAArB,KAYA,EAA8CrI,qBAAWqY,GANnB,CACpCpE,KAAM,UACNqE,WAAW,EACXC,UAAU,IAGZ,mBAAOkC,EAAP,KAAwBC,EAAxB,KAGA,EAAsC1a,qBAAWmiB,GAAe,CAC9DC,QAAQ,EACRC,eAAW/T,EACXgU,WAAY,oBACZC,cAAe,yBAJjB,mBAAOE,EAAP,KAAoBC,EAApB,KASAjiB,qBAAU,WACFzD,MACJqL,EAAgB,IAAInP,KAAKyhB,OAAO7d,EAAe,mBAC/C4lB,EAAe,CAAExjB,KAAQpC,EAAe,UAAY,SAAW,UAAWulB,UAAWvlB,EAAe,cACpGG,OAGD,IAEHwD,qBAAU,WACHzD,KACHR,EAAgB,SAAUimB,EAAYL,OAAS,IAAM,MAEtD,CAACK,EAAYL,SAehB,OACE,cAAC,GAAD,UACE,eAACxH,GAAA,EAAD,CAAOC,QAAM,EAAb,UACE,cAAClc,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAACsC,GAAD,CACErW,MAAOvG,EAAEolB,EAAYH,YACrBpI,SAAU7c,EAAEolB,EAAYF,eACxB9O,KAAMrL,EACN+R,aA3De,SAAC1G,GACxBpL,EAAgBoL,IA2DRxT,SAAUya,OAKX+H,EAAYL,QACX,cAACJ,GAAD,CACEhB,gBACE,cAAC,GAAD,CACElI,YAAa1Q,EACbqQ,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,GACpD2F,OAAO,UACP3C,aAhCW,SAACO,EAAmB0E,EAAqBpS,GAClElI,EAAgB,IAAInP,KAAK+kB,IACzByE,EAAe,CAAExjB,KAAM,SAAUmjB,UAAW9R,OAiClC1O,SAAU4gB,EAAYJ,YAM1BI,EAAYL,QACV,cAACH,GAAD,CACEjB,gBACE,cAACL,GAAD,CACE7H,YAAa1Q,EACbqQ,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,GACpD2F,OAAO,UACP3C,aA1CU,SAACO,EAAmBY,EAAoB+D,GAChEva,EAAgB,IAAInP,KAAK+kB,IACzByE,EAAe,CAAExjB,KAAM,UAAWmjB,UAAWxD,OA2CnChd,SAAU4gB,EAAYJ,iB,8CCxH9BnQ,GAAyBvG,KAEzBvS,GAAYC,YAAW,CAC3BwpB,YAAa,CACXtR,UAAW,SACX/M,aAAc,OACd,WAAY,CACVlK,OAAQ,OACRI,MAAO,UAiBN,SAASooB,GAAmB5qB,GACjC,IAAQ0B,EAAgC1B,EAAhC0B,KAAM0F,EAA0BpH,EAA1BoH,QAAS2B,EAAiB/I,EAAjB+I,KAAMO,EAAWtJ,EAAXsJ,OAErBnE,EAAMC,cAAND,EACF5D,EAAUyY,KACV6Q,EAAe3pB,KACfwnB,EAAiBpgB,qBAAWqgB,MAC5BtgB,EAAkBC,qBAAWZ,IAGnC,EAMI4V,aAAgB,CAAEC,eAAgB,aALpCuN,EADF,EACEA,SACAtN,EAFF,EAEEA,aACArF,EAHF,EAGEA,SACAsF,EAJF,EAIEA,MAJF,IAKEG,UAAazI,EALf,EAKeA,OAAQ2I,EALvB,EAKuBA,aAAcC,EALrC,EAKqCA,YAIrCxV,qBAAU,WACJ7G,EACF+b,EAAM,CACJxO,GAAIlG,EAAKmT,UACT6O,QAAShiB,EAAKgiB,QACdC,SAAUjiB,EAAKiiB,SACfC,kBAAmBliB,EAAKkiB,oBAG1BxN,MAED,CAAC1U,EAAMrH,EAAM+b,IAEhB,IAAMsI,EAAY,kBAAMhL,mBAAO,IAAI/Z,KAAQ,sBAAuB,CAAE4nB,OAAM,OAAEF,QAAF,IAAEA,OAAF,EAAEA,EAAgBE,UAgBtF7J,EAAQ,uCAAG,WAAOxK,GAAP,SAAA3R,EAAA,+EAEQ0R,GAAc,UAAD,OAAWC,EAASwH,MAAQ,CAAEiD,OAAQzK,EAAUwJ,YAAaA,IAFlF,kBAGDkB,QAHC,iCAIL3V,IAJK,OAKXlC,IACAiB,EAAgBN,SAAS,CAAEf,KAAM,UAAWE,QAAS/B,EAAE,+BAN5C,wBAQXkD,EAAgBN,SAAS,CAAEf,KAAM,QAASE,QAAS/B,EAAE,8BAR1C,0DAWbkD,EAAgBN,SAAS,CAAEf,KAAM,QAASE,QAAS,KAAiBA,UAXvD,0DAAH,sDAed,OACE,qCACE,cAAC5F,EAAD,CAASI,KAAMoc,IACf,eAACtG,GAAD,CAAU9V,KAAMA,EAAM0F,QAASA,EAASsE,MAAOvG,EAAE,qBAAjD,UACE,cAACsB,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,iCACE,sBAAKhe,UAAWopB,EAAaF,YAA7B,UACE,cAACrkB,EAAA,EAAD,CAAQC,QAnCE,WACpB4R,EAAS,OAAQ,WACjBA,EAAS,UAAW4N,IAAa,CAAEhN,aAAa,IAChDyE,EAAauB,EAAbvB,IAgC0Ctd,QAAQ,YAAYU,MAAM,YAAYqU,WAAYlM,EAAKiiB,SAAvF,SACG7lB,EAAE,iCAEL,cAACmB,EAAA,EAAD,CAAQC,QAhCG,WACrB4R,EAAS,OAAQ,YACjBA,EAAS,WAAY4N,IAAa,CAAEhN,aAAa,IACjDyE,EAAauB,EAAbvB,IA6B2Ctd,QAAQ,YAAYU,MAAM,YAAYqU,UAAWlM,EAAKgiB,QAAvF,SACG5lB,EAAE,qCAGP,8BACE,cAACmQ,GAAA,EAAD,2BACElT,OAAO,SACPoE,WAAS,EACT0kB,aAAa,MACbtqB,MAAM,YACNqO,GAAG,oBACH4F,MAAO1P,EAAE,wCAET8S,WAAS,GACL6S,EAAS,oBAAqB,KATpC,IAYE3nB,QAASgS,EAAO8V,kBAChBzV,WAAYL,EAAO8V,mBAAqB9V,EAAO8V,kBAAkB/jB,kBAMzE,cAACT,EAAA,EAAD,CAAK2S,GAAI,EAAGpJ,GAAI,EAAhB,SACE,eAACV,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAAmB5Y,UAAWF,EAAQmS,KAAtC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,iCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKmX,aAF/B,YAIR,qBAAmBze,UAAWF,EAAQmS,KAAtC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,gCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKgiB,YAF/B,YAIR,qBAAoBtpB,UAAWF,EAAQmS,KAAvC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,iCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKiiB,aAF/B,aAQR,qBAAwBvpB,UAAWF,EAAQmS,KAA3C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,qCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKoT,iBAF/B,iBAIR,qBAAuB1a,UAAWF,EAAQmS,KAA1C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,oCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKqT,gBAF/B,gBAIR,qBAAkB3a,UAAWF,EAAQmS,KAArC,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,+BAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAK4T,YAF/B,gBAOXqB,OAAOC,KAAKlV,EAAK0T,YAAYnS,KAAI,SAAC+N,GACjC,OAAO,cAAC8B,GAAD,CAA6BpR,KAAMA,EAAK0T,WAAWpE,IAA9BA,MAG9B,cAAC5R,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,eAACnQ,GAAA,EAAD,CAAM+K,gBAAgB,EAAtB,UACE,qBAA2B5Y,UAAWF,EAAQmS,KAA9C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,wCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAKyW,oBAF/B,oBAIR,qBAAuB/d,UAAWF,EAAQmS,KAA1C,UACE,qBAAKjS,UAAWF,EAAQmK,MAAxB,SAAgCvG,EAAE,oCAClC,qBAAK1D,UAAWF,EAAQuR,MAAxB,SAAgC/J,EAAK6T,gBAF/B,2BCtKpB,IAAM1b,GAAY4Q,KAqBX,SAAS6O,GAAU3gB,GACxB,IAAQ4gB,EAAwC5gB,EAAxC4gB,YAAaL,EAA2BvgB,EAA3BugB,eAAgB4H,EAAWnoB,EAAXmoB,OAE7BhjB,EAAMC,cAAND,EACF5D,EAAUL,KACVmE,EAAQC,cAGd,EAA+CuD,GAAW,qCAC1B+X,EAAaxQ,UADa,qBACS/K,EAAMO,OAAOD,SADtB,qBAC2CwiB,GACnG,IAFF,0BAASpf,EAAT,EAASA,KAAMvD,EAAf,EAAeA,UAAW0D,EAA1B,EAA0BA,QAAWI,EAArC,KAMA,EAA8C/D,oBAAS,GAAvD,mBAAO4lB,EAAP,KAAwBC,EAAxB,KAGA,EAAoC7lB,mBAA8B,MAAlE,mBAAOib,EAAP,KAAmBK,EAAnB,KAGMC,EAAmBzX,uBACvB,SAAC0X,GACKA,EAAYC,SACdT,EAAexY,SAAS,CAAEf,KAAM,cAEhCuZ,EAAexY,SAAS,CAAEf,KAAM,aAElC6Z,EAAcE,KAEhB,CAACR,IAIG8K,EAAwBhiB,uBAAY,SAAC0X,GACzCqK,GAAmB,GACnBvK,EAAcE,KACb,IAEGuK,EAAsB,uCAAG,sBAAA1oB,EAAA,sDAC7BwoB,GAAmB,GADU,2CAAH,qDAItBnK,EAAqB,CACzB,CAAEvV,MAAOvG,EAAE,+BAAgC2N,MAAO,YAClD,CAAEpH,MAAOvG,EAAE,+BAAgC2N,MAAO,YAClD,CACEpH,MAAOvG,EAAE,gCACT2N,MAAO,YACPuC,OAAQ,SAACtC,GACP,IAAMsF,EAAS2F,OAAOC,KAAKlL,EAAQ0J,YAAY,GACzC8O,EAAe,UAAMpmB,EAAE,iDAAR,YAA4D4N,EAAQ0J,WAAWpE,GAAQmC,iBACtGgR,EAAgB,UAAMrmB,EAAE,kDAAR,YAA6D4N,EAAQ0J,WAAWpE,GAAQoC,kBAC9G,MAAM,GAAN,OAAU8Q,EAAV,aAA8BC,KAGlC,CAAE9f,MAAOvG,EAAE,mCAAoC2N,MAAO,gBACtD,CAAEpH,MAAOvG,EAAE,kCAAmC2N,MAAO,eACrD,CAAEpH,MAAOvG,EAAE,8BAA+B2N,MAAO,UAAW9L,KAAM,WAClE,CAAE0E,MAAOvG,EAAE,+BAAgC2N,MAAO,WAAY9L,KAAM,WACpE,CAAE0E,MAAOvG,EAAE,sCAAuC2N,MAAO,mBACzD,CAAEpH,MAAOvG,EAAE,6BAA8B2N,MAAO,YAIlD,OAAI5J,EACK,8BAAM/D,EAAE,6BAIf,eAACmb,GAAD,CAAeE,WAAYA,EAAYD,eAAgBA,EAAgB/a,UAAWA,EAAW8D,OAAQA,EAArG,UACE,cAAC,KAAD,CACE2X,QAASA,EACTC,WAAY,CACVC,KAAM,SAACnhB,GAAD,OAAW,cAAC,cAAD,6BAAgBA,GAAhB,IAAuByB,UAAWoR,GAAU7S,EAAMohB,UAAUtO,MAAO9S,EAAM+S,QAASxR,QAErGwH,KAAMA,EACNsY,WAAY,SAACrZ,EAAQ+Y,GAAT,QAA4BA,GAAesK,EAAsBtK,IAC7E0K,QAAS,CACP,CACEC,KAAM,kBAAM,cAAC,KAAD,KACZlrB,QAAS2E,EAAE,iCACXoB,QAAS,SAAC6Q,EAAGrE,GAAJ,QAAkBA,GAAW+N,EAAiB/N,MAG3D4Y,aAAc,CACZC,OAAQ,CAAEH,QAAS,KAErBnV,QAAO,cACLgL,WAAW,EACXlhB,SAAS,EACTqI,QAAQ,EACR8Y,YAAa,CAAElf,gBAAiB+Q,GAAW5T,QAAQC,QAAQqU,OAC3D0N,YAAa,SAEV9P,IAEL+P,MAAOnR,KAERkQ,GAAc,cAACoK,GAAD,CAAoBlpB,KAAMypB,EAAiB/jB,QAASkkB,EAAwBviB,KAAMyX,EAAYlX,OAAQA,O,6CCtHrHpI,GAAYC,YAAW,CAC3BugB,mBAAoB,CAClB,iCAAkC,CAAEpW,aAAc,IAEpDugB,QAAS,CAAExS,UAAW,YAWlByS,GAAmB,CACvB,WACA,WACA,WACA,YACA,kBACA,mBACA,eACA,cACA,UACA,oBACA,WACA,kBACA,cACA,UACA,WAaK,SAASC,GAAgB/rB,GAC9B,IAAQ0B,EAAkB1B,EAAlB0B,KAAM0F,EAAYpH,EAAZoH,QAENjC,EAAMC,cAAND,EACF5D,EAAUL,KACVmE,EAAQC,cACR+C,EAAkBC,qBAAWZ,IAE7BskB,EAAaC,iBAAkE,MAGrF,EAA8B1mB,mBAAwB,IAAtD,mBAAO2mB,EAAP,KAAgBC,EAAhB,KAGM9O,EAAgBmJ,mBAAQ,WAC5B,MAAO,CAAE7gB,SAAUN,EAAMO,OAAOD,SAAUmW,UAAW,IAAI9a,KAAQorB,QAASC,aAAS,IAAIrrB,KAAQ,MAC9F,CAACqE,EAAMO,OAAOD,WAEjB,EAOI2X,aAAyB,CAAED,gBAAeE,eAAgB,aAN5D3I,EADF,EACEA,QACA+F,EAFF,EAEEA,UACA6C,EAHF,EAGEA,aACAC,EAJF,EAIEA,MACAtF,EALF,EAKEA,SALF,IAMEyF,UAAazI,EANf,EAMeA,OAAQ2I,EANvB,EAMuBA,aAAcC,EANrC,EAMqCA,YAIrCxV,qBAAU,WACJ7G,GACF+b,EAAMJ,KAEP,CAACA,EAAe3b,EAAM+b,IAGzB,IAMM6O,EAAe,uCAAG,sBAAA1pB,EAAA,sDACtB4a,EAAauB,EAAbvB,GADsB,2CAAH,qDAKf+O,EAA2BT,GAAiBxhB,KAAI,SAAC9F,GACrD,MAAO,CAAEqQ,MAAO1P,EAAE,0BAAD,OAA2BiS,KAAEoV,UAAUhoB,KAAW2a,IAAK3a,MAIpEioB,EAAQ,kBAAc1R,mBAAOJ,EAAU,aAAc,YAA7C,YAA4DI,mBAAOJ,EAAU,WAAY,YAAzF,QAGRoE,EAAwC,uCAAG,WAAOxK,GAAP,mBAAA3R,EAAA,+EAExB0R,GAA4D,gBAAiB,CAChG0K,OAAQzK,EACRwJ,YAAaA,IAJ8B,QAEvClY,EAFuC,QAMjCoZ,QACJpZ,EAAOrB,QACLkoB,EAAiB7mB,EAAOrB,MAAM8F,KAAI,SAACyI,GACvC,IAAM4Z,EAAW5Z,EAAQ4Z,SACzB,OAAO5Z,EAAQhK,KAAKuB,KAAI,SAAC/F,GACvB,IAAM8T,EAAS2F,OAAOC,KAAK1Z,EAAKkY,YAAY,GAC5C,MAAO,CACLkQ,SAAUA,EACVzM,SAAU3b,EAAK2b,SACf5F,SAAU/V,EAAK+V,SACfxB,UAAWvU,EAAKkY,WAAWpE,GAAQS,UAAY3T,EAAE,kCAAoCA,EAAE,iCACvFqV,gBAAiBjW,EAAKkY,WAAWpE,GAAQmC,gBAAgBnK,WACzDoK,iBAAkBlW,EAAKkY,WAAWpE,GAAQoC,iBAAiBpK,WAC3D8L,aAAc5X,EAAK4X,aACnBC,YAAa7X,EAAK6X,YAClB2O,QAASxmB,EAAKwmB,QACdE,kBAAmB1mB,EAAK0mB,kBACxBD,SAAUzmB,EAAKymB,SACfxL,gBAAiBjb,EAAKib,gBACtB5C,YAAarY,EAAKqY,YAClBX,QAAS1X,EAAK0X,QACdU,QAASpY,EAAKoY,eAIpBwP,EAAWO,EAAeE,QAChB,OAAVZ,QAAU,IAAVA,GAAA,UAAAA,EAAYa,eAAZ,SAAqB/f,KAAKggB,QAC1BzkB,EAAgBN,SAAS,CAAEf,KAAM,UAAWE,QAAS/B,EAAE,oCAIzDkD,EAAgBN,SAAS,CAAEf,KAAM,QAASE,QAAS/B,EAAE,kCArCV,gDAwC7CkD,EAAgBN,SAAS,CAAEf,KAAM,QAASE,QAAS,KAAiBA,UAxCvB,yDAAH,sDA6CxC4a,EAAa,SAAC9a,GAAD,OACjB,cAAC,KAAD,CACEwD,KAAI,UAAKxD,EAAL,QACJ4N,QAASA,EACTQ,MAAO,CACLN,SAAU3P,EAAE,wBACZmU,SAAU,kBACRkK,aAAW7I,EAAU,cAAcvK,WAAaoT,aAAW7I,EAAU,YAAYvK,WAChFjL,EAAE,sCAEPkQ,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAAC,KAAD,6BACMA,GADN,IAEE5I,SAAU,SAACyP,GACT7G,EAAM5I,SAASyP,GACF,UAAT3S,GA/EgB,WAC5B,IAAMolB,EAAUC,aAAS1R,EAAU,aAAc,GACjDxC,EAAS,UAAWiU,EAAS,CAAErT,aAAa,IA6EdgU,IAExBhS,OAAO,aACPlG,MAAO1P,EAAE,cAAD,OAAe6B,EAAf,UACR4a,iBAAe,EACfC,oBAAqB,CACnB,aAAc,eAEhB9X,KAAK,QACLtI,UAAWF,EAAQmgB,mBACnBve,QAASgS,EAAO,GAAD,OAAInO,EAAJ,SACfwO,WAAYL,EAAO,GAAD,OAAInO,EAAJ,UAAmBmO,EAAO,GAAD,OAAInO,EAAJ,SAAiBE,eAMpE,OACE,qCACE,cAAC5F,EAAD,CAASI,KAAMoc,IACf,eAACtG,GAAD,CAAU9V,KAAMA,EAAM0F,QAASA,EAASsE,MAAOvG,EAAE,oBAAjD,UACE,iCACE,cAACsB,EAAA,EAAD,CAAK2S,GAAI,EAAGpJ,GAAI,EAAhB,SACE,eAACuJ,GAAA,EAAD,CAAM5M,WAAS,EAACT,eAAe,SAAShK,WAAW,SAAnD,UACE,cAACqX,GAAA,EAAD,CAAM5M,WAAS,EAACpI,MAAI,EAACiV,GAAI,GAAI2I,GAAI,EAAjC,SACGL,EAAW,WAEd,cAACvI,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,GAAI2I,GAAI,EAAG1gB,UAAWF,EAAQsqB,QAA7C,SACE,cAAC,KAAD,MAEF,cAACtS,GAAA,EAAD,CAAM5M,WAAS,EAACpI,MAAI,EAACiV,GAAI,GAAI2I,GAAI,EAAjC,SACGL,EAAW,cAIlB,cAACrb,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAACnZ,EAAA,EAAD,CAAQC,QAAS+lB,EAAiBpsB,QAAQ,YAAYU,MAAM,UAAU4F,WAAS,EAA/E,SACGrB,EAAE,uCAKT,cAAC,WAAD,CAAS8E,MAAO,CAAEjI,QAAS,QAAU+G,KAAMmjB,EAASK,QAASA,EAASE,SAAUA,EAAUhc,IAAKub,EAA/F,SACG,yBC5MJ,SAASgB,KACd,IAAQ7nB,EAAMC,cAAND,EAGR,EAAwC8K,KAAxC,mBAAOC,EAAP,KAAqBC,EAArB,KAYA,EAA8CrI,qBAAWqY,GANnB,CACpCpE,KAAM,UACNqE,WAAW,EACXC,UAAU,IAGZ,mBAAOkC,EAAP,KAAwBC,EAAxB,KAGA,EAA0Cjd,oBAAS,GAAnD,mBAAO0nB,EAAP,KAAsBC,EAAtB,KAGA,EAAkC3nB,mBAAS,IAA3C,mBAAO4kB,EAAP,KAAkBgD,EAAlB,KAIA5kB,qBAAU,WACFzD,MACJqL,EAAgB,IAAInP,KAAKyhB,OAAO7d,EAAe,mBAC/CuoB,EAAavoB,EAAe,aAC5BG,OAGD,IAIH,IASMqoB,EACJ,cAAC9mB,EAAA,EAAD,CAAQpG,QAAQ,YAAYyf,UAAW,cAAC,KAAD,IAAyBpZ,QAVtC,WAC1B2mB,GAAiB,IASjB,SACG/nB,EAAE,4BAIP,OACE,eAAC,GAAD,CAAciI,WAAS,EAAvB,UACE,eAACsV,GAAA,EAAD,CAAOC,QAAM,EAAb,UACE,cAAClc,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAACsC,GAAD,CACErW,MAAOvG,EAAE,oBACToW,KAAMrL,EACN+R,aAtDe,SAAC1G,GACxBpL,EAAgBoL,IAsDRxT,SAAUya,EACVN,cAAe,CAACkL,OAGpB,cAACtD,GAAD,CACEhB,gBACE,cAAC,GAAD,CAAWlI,YAAa1Q,EAAeqQ,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,GAAsB2F,OAAO,YAE1Hxe,SAAUwgB,QAAwB/T,OAGtC,cAAC2V,GAAD,CAAiBrqB,KAAMurB,EAAe7lB,QA9Bd,WAC1B8lB,GAAiB,SC9Cd,SAASnV,GAAoB/X,GAClC,IAAQ0B,EAAkB1B,EAAlB0B,KAAM0F,EAAYpH,EAAZoH,QAENjC,EAAMC,cAAND,EAYR,OACE,8BACE,eAACuS,GAAA,EAAD,CAAQhW,KAAMA,EAAM0F,QAZJ,WAClBA,GAAQ,IAWoC,kBAAgB,qBAAqB,mBAAiB,2BAAhG,UAEE,cAACwQ,GAAA,EAAD,UACE,cAACI,GAAA,EAAD,CAAmB/I,GAAG,2BAAtB,SAAkD9J,EAAE,iCAEtD,eAAC2S,GAAA,EAAD,WACE,cAACxR,EAAA,EAAD,CAAQC,QAfM,WACpBa,GAAQ,IAc8BxG,MAAM,YAAtC,gBAGA,cAAC0F,EAAA,EAAD,CAAQC,QAfU,WACxBa,GAAQ,IAckCxG,MAAM,YAAYqX,WAAS,EAA/D,4BCjBV,IAAM/W,GAAYC,aAAW,SAACiS,GAC5B,OAAO3I,aAAa,CAClByQ,WAAY,CACVpZ,UAAWsR,EAAWrR,QAAQ,GAC9BuK,aAAc8G,EAAWrR,QAAQ,IAEnCoZ,KAAM,CACJva,MAAO,MACPH,SAAU,QACV2B,OAAQ,QAKRgZ,GAAiB7b,YAAY,CACjCC,QAAS,CACPC,QAAS,CACP6C,KAAM5C,KAAO,MAEfC,UAAW,CACT2C,KAAM+Q,KAAK,OAGfrT,MAAO,CACLC,aAAc,CACZC,QAAS,WACTkC,OAAQ,QACRoE,WAAW,EACX6U,QAAS,MA6BR,SAAS4B,GAA4Bjd,GAC1C,IAAQqtB,EAA6CrtB,EAA7CqtB,YAAa3rB,EAAgC1B,EAAhC0B,KAAM0F,EAA0BpH,EAA1BoH,QAAS2B,EAAiB/I,EAAjB+I,KAAMO,EAAWtJ,EAAXsJ,OAElCnE,EAAMC,cAAND,EACF5D,EAAUL,KACVmH,EAAkBC,qBAAWZ,IAGnC,EAAsCnC,oBAAS,GAA/C,mBAAO4X,EAAP,KAAoBC,EAApB,KAGMkQ,EAAUhQ,aAAQ,CAAED,cAAc,gBAAMgQ,EAAYhQ,eAAiBE,eAAgB,aAGzFC,EAKE8P,EALF9P,aACAC,EAIE6P,EAJF7P,MACAtF,EAGEmV,EAHFnV,SACAwF,EAEE2P,EAFF3P,SAJF,EAMI2P,EADF1P,UAAaC,EALf,EAKeA,QAASC,EALxB,EAKwBA,aAAcC,EALtC,EAKsCA,YAItCxV,qBAAU,WACR,GAAI7G,GAAUqH,EAAM,CAClB,IAAMwkB,EAASvP,OAAOC,KAAKoP,EAAYhQ,eAAea,QAAO,SAACC,EAAqBgB,GAMjF,MALY,SAARA,EACFhB,EAAM,KAAW,MAEjBA,EAAOgB,GAAQpW,EAAqBoW,GAE/BhB,IACN,IACHV,EAAMrG,KAAEkH,UAAUiP,SAElB9P,EAAMrG,KAAEkH,UAAU+O,EAAYhQ,kBAE/B,CAACtU,EAAMskB,EAAa3rB,EAAM+b,IAG7B,IAcMsB,EAAwC,uCAAG,WAAOxK,GAAP,uBAAA3R,EAAA,+DAEzCmD,EAAM,GAFmC,KAGrCwO,EAASwH,KAH4B,OAItC,QAJsC,OAOtC,QAPsC,OAUtC,QAVsC,8BAKzChW,EAAG,WAAOsnB,EAAYrmB,KAAnB,WALsC,mCAQzCjB,EAAG,WAAOsnB,EAAYrmB,KAAnB,WARsC,mCAWzCjB,EAAG,WAAOsnB,EAAYrmB,KAAnB,WAXsC,8CAcxBsN,GAAcvO,EAAK,CAAEiZ,OAAQzK,EAAUwJ,YAAaA,IAd5B,aAcvClY,EAduC,QAejCoZ,QAfiC,oBAgBrB,QAAlB1K,EAASwH,KAhB8B,kCAgBR,IAAIvH,SAAQ,SAAC0K,GAAD,OAAOvW,WAAWuW,EAAG,QAhBzB,yBAiBrC5V,IAjBqC,WAkB3ClC,IACAiB,EAAgBN,SAAS,CAAEf,KAAM,UAAWE,QAAS/B,EAAE,+BAE9B,SAArBkoB,EAAYrmB,MAAwC,aAArBqmB,EAAYrmB,KArBJ,kCAsBnC,IAAIwN,SAAQ,kBAChB7L,YAAW,WACTN,EAAgBN,SAAS,CAAEf,KAAM,UAAWE,QAAS/B,EAAE,gCACtD,SAzBoC,gCA8B3C,GAAIU,EAAQsP,OAEV,IAASgK,KADHhK,EAAStP,EAAQsP,OAGrBwI,EADInT,EAAO2U,EACI,CAAEjY,QAAS/B,EAAEgQ,EAAO3K,GAAO,MAlCH,0DAwC7CnC,EAAgBN,SAAS,CAAEf,KAAM,QAASE,QAAS,KAAiBA,UAxCvB,0DAAH,sDAoD9C,OACE,qCACE,cAAC5F,EAAD,CAASI,KAAMoc,IACf,cAACtG,GAAD,CAAU9V,KAAMA,EAAM0F,QAASA,EAASsE,MAAOvG,EAAE,kBAAD,OAAmBkoB,EAAYrmB,OAA/E,SACE,cAACsY,EAAA,EAAD,CAAehgB,MAAO8b,GAAtB,SACE,cAAC,KAAD,6BAAkBkS,GAAlB,aACE,iCACE,cAAC7mB,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SAAY4N,EAAY9oB,OACxB,cAACkC,EAAA,EAAD,CAAK2S,GAAI,EAAT,SACE,eAACG,GAAA,EAAD,CAAM5M,WAAS,EAACT,eAAe,gBAAgBnK,QAAS,EAAGN,UAAWF,EAAQ2Z,WAA9E,UACE,cAAC3B,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAKzQ,EAAY,EAAL,GAAvB,SACE,cAACzC,EAAA,EAAD,CAAQC,QA7EP,WACjBiX,EAAauB,EAAbvB,IA4E6Ctd,QAAQ,YAAYU,MAAM,UAAUqU,UAAW4I,EAAS8B,UAAW,cAAC,KAAD,IAAcnZ,WAAS,EAAvH,SACGrB,EAAE,0BAGP,cAACoU,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,EAAGvP,MAAQlB,OAA6BqN,EAAtB,CAAEpU,QAAS,QAA5C,SACE,cAACsE,EAAA,EAAD,CAAQC,QA9EL,WACnB6W,GAAe,IA6EgCld,QAAQ,YAAYU,MAAM,UAA+B+e,UAAW,cAAC,KAAD,IAAgBnZ,WAAS,EAA5H,SACGrB,EAAE,2CASnB,cAAC,GAAD,CAAqBzD,KAAMyb,EAAa/V,QAjCjB,SAACwY,GAC1BxC,GAAe,GACXwC,IApDJzH,EAAS,OAAkC,OAC3CqF,EAAauB,EAAbvB,UC/GG,IAAM2C,GAAoB,SAACrZ,EAAwBC,GACxD,OAAQA,EAAOC,MACb,IAAK,YACH,MAAO,CAAE+U,KAAM,UAAWqE,WAAW,GACvC,IAAK,cACH,MAAO,CAAErE,KAAM,UAAWqE,WAAW,GACvC,IAAK,aACH,OAAO,6BAAKtZ,GAAZ,IAAmBsZ,WAAW,IAChC,QACE,OAAOtZ,IAgBN,SAASwZ,GAAuBtgB,GACrC,IAAQqtB,EAAyErtB,EAAzEqtB,YAAa9M,EAA4DvgB,EAA5DugB,eAAgB/a,EAA4CxF,EAA5CwF,UAAW8D,EAAiCtJ,EAAjCsJ,OAAQkX,EAAyBxgB,EAAzBwgB,WAAY3Y,EAAa7H,EAAb6H,SAG9D4Y,EAAsB,uCAAG,sBAAA7d,EAAA,sDAC7B2d,EAAexY,SAAS,CAAEf,KAAM,eADH,2CAAH,qDAI5B,OACE,eAACsY,EAAA,EAAD,CAAehgB,MAAO8T,GAAtB,UACE,cAAC9R,EAAD,CAASI,KAAM8D,IACdqC,EACD,cAAC,GAAD,CACEwlB,YAAaA,EACb3rB,KAAM6e,EAAezZ,MAAMsZ,UAC3BhZ,QAASqZ,EACT1X,KAAoC,YAA9BwX,EAAezZ,MAAMiV,KAAqB,KAAOyE,EACvDlX,OAAQA,OC5ChB,IAAMpI,GAAY4Q,KAmBX,SAAS6O,GAAkC3gB,GAChD,IAAQqtB,EAAyCrtB,EAAzCqtB,YAAapM,EAA4BjhB,EAA5BihB,QAASV,EAAmBvgB,EAAnBugB,eAEtBpb,EAAMC,cAAND,EACF5D,EAAUL,KAGhB,EAA+C2H,GAAW,WAAgBwkB,EAAYrmB,KAA5B,SAAyC,IAAnG,0BAAS+B,EAAT,EAASA,KAAMvD,EAAf,EAAeA,UAAW0D,EAA1B,EAA0BA,QAAWI,EAArC,KAGA,EAAoC/D,mBAAyB,MAA7D,mBAAOib,EAAP,KAAmBK,EAAnB,KAGMC,EAAmBzX,uBACvB,SAAC0X,GACCR,EAAexY,SAAS,CAAEf,KAAM,cAChC6Z,EAAcE,KAEhB,CAACR,IAIH,OAAIrX,EACK,8BAAM/D,EAAE,6BAIf,cAAC,GAAD,CAAwBkoB,YAAaA,EAAa7M,WAAYA,EAAYD,eAAgBA,EAAgB/a,UAAWA,EAAW8D,OAAQA,EAAxI,SACE,cAAC,KAAD,CACE2X,QAASA,EACTC,WAAY,CAEVC,KAAM,SAACnhB,GAAD,OAAW,cAAC,cAAD,6BAAgBA,GAAhB,IAAuByB,UAAWoR,GAAU7S,EAAMohB,UAAUtO,MAAO9S,EAAM+S,QAASxR,QAErGwH,KAAMA,EACNsY,WAAY,SAACrZ,EAAQ+Y,GAAT,QAA4BA,GAAeD,EAAiBC,IACxEzK,QAAO,cACLgL,WAAW,EACXlhB,SAAS,EACTqI,QAAQ,EACR8Y,YAAa,CAAElf,gBAAiB+Q,GAAW5T,QAAQC,QAAQqU,OAC3D0N,YAAa,SACV9P,IAEL+P,MAAOnR,OCrEf,IAAMpP,GAAYC,aAAW,iBAAO,CAClCqsB,iBAAkB,CAChBnU,UAAW,QACXjX,OAAQ,YAcL,SAAS2f,GAAc/hB,GAC5B,IAAQytB,EAAqBztB,EAArBytB,OAAQ1lB,EAAa/H,EAAb+H,SAER5C,EAAMC,cAAND,EACF5D,EAAUL,KAOhB,OACE,mCACE,eAACqY,GAAA,EAAD,CAAM5M,WAAS,EAACzK,WAAW,UAAUgK,eAAe,gBAApD,UACE,cAACqN,GAAA,EAAD,CAAM5M,WAAS,EAACpI,MAAI,EAACiV,GAAI,GAAI2I,GAAI,EAAjC,SACE,cAACxhB,EAAA,EAAD,CAAYuF,UAAU,KAAKhG,QAAQ,KAAnC,SACGiF,EAAE,kBAAD,OAAmBsoB,QAGzB,cAAClU,GAAA,EAAD,CAAMhV,MAAI,EAACiV,GAAI,GAAI2I,GAAI,EAAG1gB,UAAWF,EAAQisB,iBAA7C,SACE,cAAClnB,EAAA,EAAD,CAAQpG,QAAQ,YAAYU,MAAM,YAAY+e,UAAW,cAAC,KAAD,IAAmBpZ,QAb1D,SAACyB,GACzBD,EAAS,CAAEf,KAAM,iBAYX,SACG7B,EAAE,gCC5CR,IAAMuoB,GAAiB,CAAC,QAAS,SCSjC,SAASC,KACd,MAGIC,eAFFhZ,EADF,EACEA,QACaO,EAFf,EAEEyI,UAAazI,OAGPhQ,EAAMC,cAAND,EAER,OACE,qCACE,cAACwP,GAAD,CACEnK,KAAM,OACNoK,QAASA,EACTC,MAAO1P,EAAE,6BACT2P,UAAQ,EACRC,WAAY2Y,GAAepjB,KAAI,SAAC9F,GAC9B,MAAO,CAAEqQ,MAAO1P,EAAE,2BAAD,OAA4BX,IAAUA,MAAOA,MAEhE2Q,OAAQA,IAEV,cAACQ,GAAD,CAAsBnL,KAAM,UAAWoK,QAASA,EAASC,MAAO1P,EAAE,gCAAiCgQ,OAAQA,OCjB1G,SAAS0Y,KACd,IAAQ1oB,EAAMC,cAAND,EAQR,EAA8C2C,qBAAWqY,GALnB,CACpCpE,KAAM,UACNqE,WAAW,IAGb,mBAAOmC,EAAP,KAAwBC,EAAxB,KAEMvB,EAA2B,CAC/B,CACEvV,MAAOvG,EAAE,6BACT2N,MAAO,OACPuC,OAAQ,SAACtC,GAAD,OAAa5N,EAAE,2BAAD,OAA4B4N,EAAQvI,UAY9D,OACE,cAAC,GAAD,CAAc2C,WAAS,EAACE,UAAQ,EAAhC,SACE,eAACqV,GAAA,EAAD,CAAOC,QAAM,EAAb,UACE,cAAClc,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CAAegO,OAAO,OAAO1lB,SAAUya,MAEzC,cAAC/b,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CACE4N,YAAa,CAAErmB,KAAM,OAAQzC,KAAM,cAACopB,GAAD,IAAgBtQ,cAfzB,CAClCtB,KAAM,MACN9M,GAAI,GACJzE,KAAM,QACNsjB,QAAS,KAYD7M,QAASA,EACTV,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,YC1CzD,SAASmL,KACd,MAGIC,eAFFhZ,EADF,EACEA,QACaO,EAFf,EAEEyI,UAAazI,OAGPhQ,EAAMC,cAAND,EAER,OACE,qCACE,cAACwP,GAAD,CAAqBnK,KAAM,OAAQoK,QAASA,EAASC,MAAO1P,EAAE,iCAAkC2P,UAAQ,EAACK,OAAQA,IACjH,cAACR,GAAD,CACEnK,KAAM,MACNoK,QAASA,EACTC,MAAO1P,EAAE,gCACT2P,UAAQ,EACRI,WAAY,CACV6Y,QAAS,CACPvpB,MAAO,cACP0C,QAAS/B,EAAE,8CAGfgQ,OAAQA,IAEV,cAACR,GAAD,CAAqBnK,KAAM,OAAQoK,QAASA,EAASC,MAAO1P,EAAE,iCAAkCgQ,OAAQA,OCnBvG,SAAS6Y,KACd,IAAQ7oB,EAAMC,cAAND,EAQR,EAA8C2C,qBAAWqY,GALnB,CACpCpE,KAAM,UACNqE,WAAW,IAGb,mBAAOmC,EAAP,KAAwBC,EAAxB,KAEMvB,EAA+B,CACnC,CAAEvV,MAAOvG,EAAE,iCAAkC2N,MAAO,QACpD,CAAEpH,MAAOvG,EAAE,gCAAiC2N,MAAO,OACnD,CAAEpH,MAAOvG,EAAE,iCAAkC2N,MAAO,SAWtD,OACE,cAAC,GAAD,CAAc3F,WAAS,EAACE,UAAQ,EAAhC,SACE,eAACqV,GAAA,EAAD,CAAOC,QAAM,EAAb,UACE,cAAClc,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CAAegO,OAAO,WAAW1lB,SAAUya,MAE7C,cAAC/b,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CACE4N,YAAa,CAAErmB,KAAM,WAAYzC,KAAM,cAAC,GAAD,IAAgB8Y,cAhBzB,CACtCtB,KAAM,MACN9M,GAAI,GACJzE,KAAM,GACNzE,IAAK,GACLkoB,KAAM,KAYEhN,QAASA,EACTV,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,YCrCzD,SAASmL,KACd,MAIIC,eAHFhZ,EADF,EACEA,QACAuD,EAFF,EAEEA,SACahD,EAHf,EAGEyI,UAAazI,OAGPhQ,EAAMC,cAAND,EAGF+oB,EAAkBvV,aAAS,CAC/B/D,UACApK,KAAM,kBAIR,EAAsCjF,oBAAS,GAA/C,mBAAO4oB,EAAP,KAAoBC,EAApB,KAUA,OAPA7lB,qBAAU,WACR6lB,EAAeF,GACVA,GACH/V,EAAS,UAAW,GAAI,CAAEY,aAAa,MAExC,CAACmV,EAAiB/V,IAGnB,qCACE,cAACxD,GAAD,CAAqBnK,KAAM,OAAQoK,QAASA,EAASC,MAAO1P,EAAE,iCAAkC2P,UAAQ,EAACK,OAAQA,IACjH,cAACR,GAAD,CAAqBnK,KAAM,OAAQoK,QAASA,EAASC,MAAO1P,EAAE,iCAAkCgQ,OAAQA,IACxG,cAACsE,GAAA,EAAD,CACE7E,QACE,cAAC,KAAD,CACEpK,KAAM,gBACNoK,QAASA,EACTS,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OAAe,cAAC4G,GAAA,EAAD,CAAQxP,SAAU,SAACyP,GAAD,OAAO7G,EAAM5I,SAASyP,EAAEvP,OAAOwP,UAAUA,QAAS9G,EAAMtO,MAAO5D,MAAM,eAGlHiU,MAAO1P,EAAE,6CAEX,cAACwQ,GAAD,CACEnL,KAAM,UACNoK,QAASA,EACTC,MAAO1P,EAAE,oCACTgQ,OAAQA,EACRlL,MAAQkkB,OAAoC/X,EAAtB,CAAEpU,QAAS,aC3ClC,SAASqsB,KACd,IAAQlpB,EAAMC,cAAND,EAQR,EAA8C2C,qBAAWqY,GALnB,CACpCpE,KAAM,UACNqE,WAAW,IAGb,mBAAOmC,EAAP,KAAwBC,EAAxB,KAEMvB,EAA+B,CACnC,CAAEvV,MAAOvG,EAAE,iCAAkC2N,MAAO,QACpD,CAAEpH,MAAOvG,EAAE,iCAAkC2N,MAAO,QACpD,CAAEpH,MAAOvG,EAAE,2CAA4C2N,MAAO,gBAAiB9L,KAAM,YAavF,OACE,cAAC,GAAD,CAAcmG,WAAS,EAACE,UAAQ,EAAhC,SACE,eAACqV,GAAA,EAAD,CAAOC,QAAM,EAAb,UACE,cAAClc,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CAAegO,OAAO,WAAW1lB,SAAUya,MAE7C,cAAC/b,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CACE4N,YAAa,CAAErmB,KAAM,WAAYzC,KAAM,cAAC,GAAD,IAAgB8Y,cAjBzB,CACtCtB,KAAM,MACN9M,GAAI,GACJzE,KAAM,GACNyjB,KAAM,GACNK,eAAe,EACfR,QAAS,KAYD7M,QAASA,EACTV,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,YCjCzD,SAASmL,GAAT,GAAiE,IAA3CnkB,EAA0C,EAA1CA,UAAW+kB,EAA+B,EAA/BA,WACtC,EAIIX,eAHFhZ,EADF,EACEA,QACAuD,EAFF,EAEEA,SACahD,EAHf,EAGEyI,UAAazI,OAGPhQ,EAAMC,cAAND,EAGR,EAAkDI,oBAAS,GAA3D,mBAAOiT,EAAP,KAA0BC,EAA1B,KAGM+V,EAAY7V,aAAS,CAAE/D,UAASpK,KAAM,SAY5C,OATAjC,qBAAU,WACU,SAAdimB,GACFrW,EAAS,aAAa,EAAO,CAAEY,aAAa,IAC5CN,GAAqB,IAErBA,GAAqB,KAEtB,CAACN,EAAUqW,IAGZ,qCACE,cAAC7Z,GAAD,CAAqBnK,KAAM,OAAQoK,QAASA,EAASC,MAAO1P,EAAE,6BAA8B2P,UAAQ,EAACK,OAAQA,IAC7G,cAACR,GAAD,CACEnK,KAAM,QACNoK,QAASA,EACTC,MAAO1P,EAAE,8BACT2P,UAAQ,EACRI,WAAY,CACV6Y,QAAS,CAEPvpB,MAAO,wEACP0C,QAAS/B,EAAE,4CAGfgQ,OAAQA,IAEV,cAACR,GAAD,CAAqBnK,KAAM,OAAQoK,QAASA,EAASC,MAAO1P,EAAE,6BAA8BgQ,OAAQA,IACpG,cAACR,GAAD,CACEnK,KAAM,aACNoK,QAASA,EACTC,MAAO1P,EAAE,oCACT2P,UAAQ,EACRC,WAAYV,GAAiB/J,KAAI,SAAC9F,GAChC,MAAO,CAAEqQ,MAAO1P,EAAE,kCAAD,OAAmCX,IAAUA,MAAOA,MAEvE2Q,OAAQA,IAEV,cAACR,GAAD,CACEnK,KAAM,OACNoK,QAASA,EACTC,MAAO1P,EAAE,6BACT2P,UAAQ,EACRC,WAAYZ,GAAe7J,KAAI,SAAC9F,GAC9B,MAAO,CAAEqQ,MAAO1P,EAAE,2BAAD,OAA4BX,IAAUA,MAAOA,MAEhE2Q,OAAQA,IAEV,cAACsE,GAAA,EAAD,CACE7E,QACE,cAAC,KAAD,CACEpK,KAAM,YACNoK,QAASA,EACTS,OAAQ,gBAAGvC,EAAH,EAAGA,MAAH,OACN,cAAC4G,GAAA,EAAD,CAAQxP,SAAU,SAACyP,GAAD,OAAO7G,EAAM5I,SAASyP,EAAEvP,OAAOwP,UAAUA,QAAS9G,EAAMtO,MAAO5D,MAAM,UAAUqU,SAAUuD,OAIjH3D,MAAO1P,EAAE,mCACT8E,MAAOuO,EAAoB,CAAExW,QAAS,aAAWoU,IAEnD,cAACzB,GAAD,CACEnK,KAAM,WACNoK,QAASA,EACTC,MAAO1P,EAAE,iCACT2P,UAAQ,EACRC,WAAU,OAAEvL,QAAF,IAAEA,OAAF,EAAEA,EAAWc,KAAI,SAAC3E,GAC1B,MAAO,CAAEkP,MAAOlP,EAAS6E,KAAMhG,MAAOmB,EAASsJ,OAEjDkG,OAAQA,IAEV,cAACR,GAAD,CACEnK,KAAM,WACNoK,QAASA,EACTC,MAAO1P,EAAE,iCACT2P,UAAQ,EACRC,WAAU,OAAEwZ,QAAF,IAAEA,OAAF,EAAEA,EAAYjkB,KAAI,SAACqiB,GAC3B,MAAO,CAAE9X,MAAO8X,EAASniB,KAAMhG,MAAOmoB,EAAS1d,OAEjDkG,OAAQA,OC/FT,SAASsZ,KACd,IAAQtpB,EAAMC,cAAND,EAQR,EAA8C2C,qBAAWqY,GALnB,CACpCpE,KAAM,UACNqE,WAAW,IAGb,mBAAOmC,EAAP,KAAwBC,EAAxB,KAGA,EAA8B3Z,GAAW,oBAAkC,IAA5DW,EAAf,oBAAST,KAGT,EAA+BF,GAAW,oBAAkC,IAA7D0lB,EAAf,oBAASxlB,KAEHkY,EAA2B,CAC/B,CAAEvV,MAAOvG,EAAE,6BAA8B2N,MAAO,QAEhD,CAAEpH,MAAOvG,EAAE,6BAA8B2N,MAAO,QAChD,CACEpH,MAAOvG,EAAE,oCACT2N,MAAO,aACPuC,OAAQ,SAACtC,GAAD,OAAa5N,EAAE,kCAAD,OAAmC4N,EAAQyJ,eAEnE,CAAE9Q,MAAOvG,EAAE,6BAA8B2N,MAAO,OAAQuC,OAAQ,SAACtC,GAAD,OAAa5N,EAAE,2BAAD,OAA4B4N,EAAQ/L,SAClH,CAAE0E,MAAOvG,EAAE,mCAAoC2N,MAAO,YAAa9L,KAAM,WACzE,CACE0E,MAAOvG,EAAE,iCACT2N,MAAO,WACPuC,OAAQ,SAACtC,GACP,IAAM3I,EAAM,OAAGZ,QAAH,IAAGA,OAAH,EAAGA,EAAWklB,MAAK,SAAC/oB,GAAD,OAAcA,EAASsJ,KAAO8D,EAAQpN,YACrE,cAAOyE,QAAP,IAAOA,OAAP,EAAOA,EAAQI,OAGnB,CACEkB,MAAOvG,EAAE,iCACT2N,MAAO,WACPuC,OAAQ,SAACtC,GACP,IAAM3I,EAAM,OAAGmkB,QAAH,IAAGA,OAAH,EAAGA,EAAYG,MAAK,SAAC/B,GAAD,OAAcA,EAAS1d,KAAO8D,EAAQ4Z,YACtE,cAAOviB,QAAP,IAAOA,OAAP,EAAOA,EAAQI,QAkBrB,OACE,cAAC,GAAD,CAAc2C,WAAS,EAACE,UAAQ,EAAhC,SACE,eAACqV,GAAA,EAAD,CAAOC,QAAM,EAAb,UACE,cAAClc,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CAAegO,OAAO,OAAO1lB,SAAUya,MAEzC,cAAC/b,EAAA,EAAD,CAAKgZ,EAAG,EAAR,SACE,cAAC,GAAD,CACE4N,YAAa,CAAErmB,KAAM,OAAQzC,KAAM,cAAC,GAAD,CAAYiF,UAAWA,EAAW+kB,WAAYA,IAAgBlR,cArBvE,CAClCtB,KAAM,MACN9M,GAAI,GACJzE,KAAM,GACN0D,MAAO,GACPsO,WAAY,OACZxV,KAAM,QACNinB,KAAM,GACNnV,WAAW,EACXnT,SAAU,GACVgnB,SAAU,KAYF1L,QAASA,EACTV,eAAgB,CAAEzZ,MAAOyb,EAAiBxa,SAAUya,YC1EzD,SAASmM,KACd,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,OAAK,EAACprB,KAAK,oBAAoB0C,UAAWhB,KACjD,cAAC,IAAD,CAAO0pB,OAAK,EAACprB,KAAK,kBAAkB0C,UAAWiC,KAC/C,cAAC,IAAD,CAAOymB,OAAK,EAACprB,KAAK,kBAAkB0C,UAAWkc,KAC/C,cAAC,IAAD,CAAOwM,OAAK,EAACprB,KAAK,yBAAyB0C,UAAWokB,KACtD,cAAC,IAAD,CAAOsE,OAAK,EAACprB,KAAK,mBAAmB0C,UAAW8mB,KAChD,cAAC,IAAD,CAAO4B,OAAK,EAACprB,KAAK,4BAA4B0C,UAAW2nB,KACzD,cAAC,IAAD,CAAOe,OAAK,EAACprB,KAAK,gCAAgC0C,UAAW8nB,KAC7D,cAAC,IAAD,CAAOY,OAAK,EAACprB,KAAK,gCAAgC0C,UAAWmoB,KAC7D,cAAC,IAAD,CAAOO,OAAK,EAACprB,KAAK,4BAA4B0C,UAAWuoB,KAEzD,cAAC,IAAD,CAAUI,KAAK,eAAetf,GAAG,2B,gECnBpBuf,G,+KACnB,SAAsBvT,GACpB,OAAOR,mBAAOQ,EAAM,SAAU,CAAEqN,OAAQmG,S,qCAG1C,SAAwBxT,GACtB,OAAOR,mBAAOQ,EAAM,aAAS,CAAEqN,OAAQmG,W,GANCC,YCY7BC,OAXf,WACE,OACE,eAAC3P,EAAA,EAAD,CAAehgB,MAAOA,EAAtB,UACE,cAAC4vB,EAAA,EAAD,IACA,cAAC,KAAD,CAAyBC,MAAOL,GAAgBlG,OAAQmG,KAAxD,SACE,cAACJ,GAAD,U,8BCRFS,GAAY,CAChBC,GAAI,CACFC,YAAaC,IAEfC,GAAI,CACFF,YAAaG,KAIjBC,KAAKC,IAAIC,MAAkBC,KAAK,CAC9BC,IAAK,KACLC,YAAa,KACbC,cAAe,CACbC,aAAa,GAEfC,MAAO,CAELC,aAAa,GAEff,UAAWA,KAGEM,GAAf,ECtBAU,IAAS/a,OACP,cAAC,IAAMgb,WAAP,UACE,cAAC,GAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.27a67ba6.chunk.js","sourcesContent":["import { createTheme } from '@material-ui/core/styles';\r\nimport purple from '@material-ui/core/colors/purple';\r\nimport amber from '@material-ui/core/colors/amber';\r\n\r\nexport const theme = createTheme({\r\n  palette: {\r\n    primary: purple,\r\n    secondary: amber,\r\n  },\r\n  typography: {\r\n    button: {\r\n      textTransform: 'none',\r\n    },\r\n  },\r\n  props: {\r\n    MuiTextField: {\r\n      variant: 'outlined',\r\n    },\r\n  },\r\n  mixins: {\r\n    toolbar: { minHeight: 50 },\r\n  },\r\n  overrides: {\r\n    MuiTooltip: {\r\n      tooltip: {\r\n        fontSize: '1em',\r\n      },\r\n    },\r\n  },\r\n});\r\n","import { Link, Typography } from '@material-ui/core';\r\n\r\n/**\r\n * コピーライトコンポーネント\r\n * @param props 引数\r\n * @returns コンポーネント\r\n */\r\nexport function Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Version. 1.0.0-beta.3 - Copyright © '}\r\n      <Link color=\"inherit\" href=\"https://www.liveness.co.jp/\">\r\n        liveness, Inc.\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n","import { Backdrop, CircularProgress, makeStyles } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    zIndex: theme.zIndex.tooltip + 1,\r\n    color: '#fff',\r\n  },\r\n}));\r\n\r\ntype SpinnerProps = {\r\n  open: boolean;\r\n};\r\n\r\nexport function Spinner(props: SpinnerProps) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Backdrop className={classes.root} open={props.open}>\r\n      <CircularProgress color=\"inherit\" />\r\n    </Backdrop>\r\n  );\r\n}\r\n","import { makeStyles } from '@material-ui/core';\r\n\r\nexport const makeLoginStyles = () => {\r\n  return makeStyles((theme) => ({\r\n    paper: {\r\n      marginTop: theme.spacing(8),\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      alignItems: 'center',\r\n    },\r\n    avatar: {\r\n      margin: theme.spacing(1),\r\n      backgroundColor: theme.palette.secondary.main,\r\n    },\r\n    form: {\r\n      width: '100%', // Fix IE 11 issue.\r\n      marginTop: theme.spacing(1),\r\n    },\r\n    submit: {\r\n      margin: theme.spacing(3, 0, 2),\r\n    },\r\n  }));\r\n};\r\n","export type PostDataResult<T, U> = {\r\n  success: boolean;\r\n  value?: U;\r\n  errors?: { [P in keyof T]?: string[] };\r\n};\r\n\r\ntype ServerErrorType = { body: string };\r\n\r\nexport interface HttpResponse<T> extends Response {\r\n  parsedBody?: T & ServerErrorType;\r\n}\r\nexport async function http<T>(request: RequestInfo): Promise<HttpResponse<T>> {\r\n  const response: HttpResponse<T> = await fetch(request);\r\n\r\n  try {\r\n    // may error if there is no body\r\n    response.parsedBody = await response.json();\r\n  } catch (ex) {}\r\n\r\n  if (!response.ok) {\r\n    console.error('Server Error: ', response.parsedBody?.body);\r\n    throw new Error(response.statusText);\r\n  }\r\n  return response;\r\n}\r\nexport async function get<T>(path: string, args: RequestInit = { method: 'get' }): Promise<HttpResponse<T>> {\r\n  return await http<T>(new Request(path, args));\r\n}\r\n\r\nexport async function post<T>(path: string, body: any, args: RequestInit = { method: 'post', body: JSON.stringify(body) }): Promise<HttpResponse<T>> {\r\n  return await http<T>(new Request(path, args));\r\n}\r\n","/**\r\n * login時のlocation設定を一時的に格納します\r\n */\r\nconst temp_key = 'liveness-visitor-temp';\r\nexport const saveTempLocation = (location: string) => {\r\n  sessionStorage.setItem(temp_key, location);\r\n};\r\nexport const getTempLocation = () => {\r\n  return sessionStorage.getItem(temp_key);\r\n};\r\nexport const removeTempLocation = () => {\r\n  sessionStorage.removeItem(temp_key);\r\n};\r\n/**\r\n * user情報を格納します\r\n */\r\nconst user_key = 'liveness-visitor-user';\r\nexport const saveUserInfo = (user: string) => {\r\n  sessionStorage.setItem(user_key, user);\r\n};\r\nexport const getUserInfo = () => {\r\n  return sessionStorage.getItem(user_key);\r\n};\r\nexport const removeUserInfo = () => {\r\n  sessionStorage.removeItem(user_key);\r\n};\r\n/**\r\n * reload用stage情報を格納します\r\n */\r\nconst reload_key = 'liveness-visitor-reload';\r\nexport const initReloadState = () => {\r\n  sessionStorage.setItem(reload_key, `{}`);\r\n};\r\nexport const saveReloadState = (item: string, value: string) => {\r\n  const states = JSON.parse(sessionStorage.getItem(reload_key)!);\r\n  states[item] = value;\r\n  sessionStorage.setItem(reload_key, JSON.stringify(states));\r\n};\r\nexport const getReloadState = (item: string): string => {\r\n  const states = JSON.parse(sessionStorage.getItem(reload_key)!);\r\n  return states[item];\r\n};\r\nexport const removeReloadState = () => {\r\n  sessionStorage.removeItem(reload_key);\r\n};\r\n/**\r\n * reload用stageを保持するか否かのフラグ\r\n */\r\nconst reloadFlg_key = 'liveness-visitor-reload-flg';\r\nexport const setReloadStateFlg = () => {\r\n  sessionStorage.setItem(reloadFlg_key, '1');\r\n};\r\nexport const getReloadStateFlg = () => {\r\n  return sessionStorage.getItem(reloadFlg_key);\r\n};\r\nexport const removeReloadStateFlg = () => {\r\n  sessionStorage.removeItem(reloadFlg_key);\r\n};\r\n/**\r\n * SessionStrageの一括削除\r\n */\r\nexport const removeSessionStrage = () => {\r\n  removeUserInfo();\r\n  removeReloadState();\r\n  removeReloadStateFlg();\r\n};\r\n","import { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useRouteMatch } from 'react-router-dom';\r\n\r\nimport { Avatar, Box, Button, Container, Typography } from '@material-ui/core';\r\nimport { LockOutlined as LockOutlinedIcon } from '@material-ui/icons';\r\n\r\nimport { Copyright } from '../_components/Copyright';\r\nimport { Spinner } from '../_components/Spinner';\r\nimport { makeLoginStyles } from '_styles/LoginStyles';\r\nimport { get } from '_utils/Http';\r\nimport { saveTempLocation } from '_utils/SessionStrage';\r\nimport { LocationParams } from '_models/Location';\r\n\r\ntype Response = {\r\n  url: string;\r\n};\r\n\r\nconst useStyles = makeLoginStyles();\r\n\r\nexport function SignIn() {\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // スピナーの状態\r\n  const [isLoading, setLoding] = useState(false);\r\n\r\n  const handleClick = async () => {\r\n    try {\r\n      setLoding(true);\r\n      saveTempLocation(match.params.location); // sessionStrageにlocationを格納\r\n      const result = await get<Response>('/oauth/signin');\r\n      if (result.parsedBody) {\r\n        window.location.href = result.parsedBody.url;\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <Spinner open={isLoading} />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          LIVENESS Visitors for Microsoft\r\n        </Typography>\r\n        <Button onClick={handleClick} fullWidth variant=\"contained\" color=\"primary\" className={classes.submit}>\r\n          {t('login.msal.login')}\r\n        </Button>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n","import Snackbar from '@material-ui/core/Snackbar';\r\nimport MuiAlert, { AlertProps } from '@material-ui/lab/Alert';\r\nimport { Color } from '@material-ui/lab';\r\n\r\nfunction Alert(props: AlertProps) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nexport type MySnackberState = {\r\n  severity: Color;\r\n  message: string;\r\n  open: boolean;\r\n};\r\n\r\nexport type MySnackberProps = {\r\n  onClose: () => void;\r\n} & MySnackberState;\r\n\r\nexport type MySnackberAction =\r\n  | {\r\n      type: Color;\r\n      message: string;\r\n    }\r\n  | {\r\n      type: 'hide';\r\n    };\r\n\r\nexport const mySnackberReducer = (state: MySnackberState, action: MySnackberAction) => {\r\n  switch (action.type) {\r\n    case 'hide':\r\n      return { ...state, open: false };\r\n    case 'success':\r\n    case 'info':\r\n    case 'warning':\r\n    case 'error':\r\n      return { ...state, open: true, severity: action.type, message: action.message };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default function MySnackbar(props: MySnackberProps) {\r\n  const { severity, message, open, onClose } = props;\r\n\r\n  return (\r\n    <Snackbar open={open} autoHideDuration={1500} onClose={onClose} anchorOrigin={{ vertical: 'top', horizontal: 'center' }}>\r\n      <Alert onClose={onClose} severity={severity}>\r\n        {message}\r\n      </Alert>\r\n    </Snackbar>\r\n  );\r\n}\r\n","import { createContext, useReducer } from 'react';\r\n\r\nimport MySnackbar, { MySnackberAction, mySnackberReducer, MySnackberState } from './MySnackbar';\r\n\r\nexport type MySnackberContextType = {\r\n  state: MySnackberState;\r\n  dispatch: React.Dispatch<MySnackberAction>;\r\n};\r\n\r\nexport const MySnackberContext = createContext({} as MySnackberContextType);\r\n\r\ntype MySnackberProviderProps = {\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport function MySnackberProvider(props: MySnackberProviderProps) {\r\n  const { children } = props;\r\n\r\n  // スナックバーの初期値\r\n  const initialState: MySnackberState = {\r\n    severity: 'info',\r\n    message: '',\r\n    open: false,\r\n  };\r\n  // スナックバーの状態管理\r\n  const [state, dispatch] = useReducer(mySnackberReducer, initialState);\r\n\r\n  const handleClose = (_event?: React.SyntheticEvent, reason?: string) => {\r\n    if (reason === 'clickaway') {\r\n      return;\r\n    }\r\n    dispatch({ type: 'hide' });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <MySnackbar {...state} onClose={handleClose} />\r\n      <MySnackberContext.Provider value={{ state, dispatch }}>{children}</MySnackberContext.Provider>\r\n    </>\r\n  );\r\n}\r\n","import { Avatar, Box, Container, Typography } from '@material-ui/core';\r\nimport { LockOutlined as LockOutlinedIcon } from '@material-ui/icons';\r\nimport { Copyright } from '../_components/Copyright';\r\nimport { Spinner } from '../_components/Spinner';\r\nimport { MySnackberContext, MySnackberProvider } from '_components/MySnackbarContext';\r\nimport { makeLoginStyles } from '_styles/LoginStyles';\r\nimport { useContext, useEffect, useState } from 'react';\r\nimport { get } from '_utils/Http';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { getTempLocation, removeTempLocation } from '_utils/SessionStrage';\r\nimport { Location } from '_models/Location';\r\n\r\ntype Response = {\r\n  ok: boolean;\r\n};\r\n\r\nconst useStyles = makeLoginStyles();\r\n\r\nexport function AuthorizeWrapper() {\r\n  return (\r\n    <MySnackberProvider>\r\n      <Authorize />\r\n    </MySnackberProvider>\r\n  );\r\n}\r\n\r\nexport function Authorize() {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n  const snackberContext = useContext(MySnackberContext); // スナックバー取得用\r\n\r\n  // スピナーの状態\r\n  const [isLoading, setLoding] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // 認可コードをバックエンドへ渡す\r\n    const sendAuthCode = async () => {\r\n      try {\r\n        const search = window.location.search;\r\n        const result = await get<Response>('/oauth/callback' + search);\r\n        if (result.parsedBody) {\r\n          setLoding(false);\r\n          if (result.parsedBody.ok) {\r\n            snackberContext.dispatch({ type: 'success', message: t('common.msg.login-success') });\r\n          } else {\r\n            snackberContext.dispatch({ type: 'error', message: t('common.msg.login-failed') });\r\n          }\r\n          // ロケーションを取得\r\n          let location = getTempLocation(); // sessionStrageからlocationを取得\r\n          removeTempLocation(); // sessionStrageからlocationを削除\r\n          if (!location || location === 'undefined') {\r\n            const first = await get<Location>('/location/first');\r\n            if (first.parsedBody) {\r\n              location = first.parsedBody.url;\r\n            } else {\r\n              // throw new Error('Location is not registered.');\r\n            }\r\n          }\r\n          // urlを設定\r\n          let url = `/${location}/main`;\r\n          // ロケーション設定が未だの場合\r\n          if (location === 'undefined') {\r\n            url = '/settings/location';\r\n          }\r\n          setTimeout(() => {\r\n            window.location.replace(url);\r\n          }, 1500);\r\n        }\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    sendAuthCode();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <Spinner open={isLoading} />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          LIVENESS Visitors for Microsoft\r\n        </Typography>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { get } from '_utils/Http';\r\n\r\n/**\r\n * データ取得用カスタムフック\r\n * @param url 取得先URL\r\n * @param initialData データ取得前の初期表示データ\r\n * @returns\r\n */\r\nexport function useLoadData<T>(url: string, initialData: T | undefined) {\r\n  // データの状態\r\n  const [data, setData] = useState<T | undefined>(initialData);\r\n  // ローディングの状態\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  // エラーの状態\r\n  const [isError, setIsError] = useState(false);\r\n\r\n  // データ取得\r\n  const fetchData = useCallback(async () => {\r\n    setIsError(false);\r\n    setIsLoading(true);\r\n    try {\r\n      const result = await get<T>(url);\r\n      // console.log(url); // TODO: debug\r\n      // console.log(result.parsedBody); // TODO: debug\r\n      if (result.parsedBody) setData(result.parsedBody);\r\n    } catch (error) {\r\n      setIsError(true);\r\n      console.log(error);\r\n    }\r\n    setIsLoading(false);\r\n  }, [url]);\r\n\r\n  // データ再取得\r\n  const reload = useCallback(async () => fetchData(), [fetchData]);\r\n\r\n  // データ初回表示\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  return [{ data, isLoading, isError }, reload] as const;\r\n}\r\n","import { useState } from 'react';\r\nimport { useHistory, useRouteMatch } from 'react-router-dom';\r\nimport { FormControl, MenuItem, Select } from '@material-ui/core';\r\n\r\nimport { Location, LocationParams } from '_models/Location';\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\nexport function MyLocation() {\r\n  // ロケーション一覧取得\r\n  const [{ data: locations }] = useLoadData<Location[]>(`/location/choices`, []);\r\n\r\n  const history = useHistory();\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // ロケーションの状態\r\n  const [selected, setSelected] = useState<string>(match.params.location);\r\n  const handleOnChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n    setSelected(event.target.value as string);\r\n    const url = match.path.replace(/:location/i, event.target.value as string);\r\n    history.push(url);\r\n  };\r\n\r\n  if (!locations || locations.length === 0) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <FormControl color=\"primary\" margin=\"dense\" size=\"small\">\r\n      <Select style={{ color: 'white' }} value={selected} onChange={handleOnChange}>\r\n        {locations.map((data) => {\r\n          return (\r\n            <MenuItem key={data.url} value={data.url}>\r\n              {data.name}\r\n            </MenuItem>\r\n          );\r\n        })}\r\n      </Select>\r\n    </FormControl>\r\n  );\r\n}\r\n","import React, { useCallback, useEffect, useReducer, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link, useRouteMatch } from 'react-router-dom';\r\nimport clsx from 'clsx';\r\n\r\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport Box from '@material-ui/core/Box';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport Container from '@material-ui/core/Container';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport { ListItemText, Menu, MenuItem, Tooltip } from '@material-ui/core';\r\nimport { AccountCircle } from '@material-ui/icons';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport FaceIcon from '@material-ui/icons/Face';\r\nimport MeetingRoomIcon from '@material-ui/icons/MeetingRoom';\r\nimport PeopleIcon from '@material-ui/icons/People';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport ExpandLess from '@material-ui/icons/ExpandLess';\r\nimport ExpandMore from '@material-ui/icons/ExpandMore';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\n\r\nimport { get } from '_utils/Http';\r\nimport { getReloadStateFlg, getUserInfo, initReloadState, removeSessionStrage, saveUserInfo, setReloadStateFlg } from '_utils/SessionStrage';\r\n\r\nimport { Copyright } from './Copyright';\r\nimport { MySnackberProvider } from './MySnackbarContext';\r\nimport { MyLocation } from '_components/MyLocation';\r\n\r\nimport { User } from '_models/User';\r\nimport { LocationParams } from '_models/Location';\r\n\r\nconst useStyles = makeStyles((theme) => {\r\n  const drawerWidth = 230;\r\n\r\n  return createStyles({\r\n    root: {\r\n      display: 'flex',\r\n    },\r\n    appBar: {\r\n      zIndex: theme.zIndex.drawer + 1,\r\n      transition: theme.transitions.create(['width', 'margin'], {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.leavingScreen,\r\n      }),\r\n    },\r\n    appBarShift: {\r\n      marginLeft: drawerWidth,\r\n      width: `calc(100% - ${drawerWidth}px)`,\r\n      transition: theme.transitions.create(['width', 'margin'], {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.enteringScreen,\r\n      }),\r\n    },\r\n    toolbar: {\r\n      paddingRight: 24,\r\n    },\r\n    menuButton: {\r\n      marginRight: 36,\r\n    },\r\n    menuButtonHidden: {\r\n      display: 'none',\r\n    },\r\n    title: {\r\n      flexGrow: 1,\r\n    },\r\n    location: {\r\n      color: 'white',\r\n    },\r\n    drawerPaper: {\r\n      position: 'relative',\r\n      whiteSpace: 'nowrap',\r\n      width: drawerWidth,\r\n      transition: theme.transitions.create('width', {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.enteringScreen,\r\n      }),\r\n    },\r\n    drawerPaperClose: {\r\n      overflowX: 'hidden',\r\n      transition: theme.transitions.create('width', {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.leavingScreen,\r\n      }),\r\n      width: theme.spacing(7),\r\n      // [theme.breakpoints.up('sm')]: {\r\n      //   width: theme.spacing(9),\r\n      // },\r\n    },\r\n    drawerCloseIcon: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'flex-end',\r\n      padding: '0 8px',\r\n      ...theme.mixins.toolbar,\r\n    },\r\n    calendarHidden: {\r\n      display: 'none',\r\n    },\r\n    pageTitle: {\r\n      marginBottom: theme.spacing(1),\r\n    },\r\n    appBarSpacer: theme.mixins.toolbar,\r\n    content: {\r\n      flexGrow: 1,\r\n      height: '100vh',\r\n      overflow: 'auto',\r\n    },\r\n    container: {\r\n      paddingTop: theme.spacing(4),\r\n      paddingBottom: theme.spacing(4),\r\n    },\r\n    paper: {\r\n      padding: theme.spacing(2),\r\n      display: 'flex',\r\n      overflow: 'auto',\r\n      flexDirection: 'column',\r\n    },\r\n    link: {\r\n      textDecoration: 'none',\r\n      // color: theme.palette.text.secondary,\r\n      color: 'rgba(0, 0, 0, 0.87)',\r\n    },\r\n    nested: {\r\n      // paddingLeft: theme.spacing(4),\r\n      paddingLeft: theme.spacing(10),\r\n    },\r\n  });\r\n});\r\n\r\ntype UserStorageState = { signedIn: boolean } & User;\r\ntype UserStorageAction = { type: 'signedIn'; user: User } | { type: 'signedOut' };\r\n\r\ntype BaseTemplateProps = {\r\n  children: React.ReactNode;\r\n  adminMode?: true;\r\n  frontMode?: true;\r\n  menuOpen?: true;\r\n};\r\n\r\nconst BaseTemplate = ({ children, adminMode, frontMode, menuOpen }: BaseTemplateProps) => {\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // 左メニューエリアの開閉\r\n  const [open, setOpen] = useState(menuOpen ? true : false);\r\n\r\n  // 左メニュー：設定の詳細開閉\r\n  const [settingsOpen, setSettingsOpen] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!open) {\r\n      setSettingsOpen(false);\r\n    }\r\n  }, [open]);\r\n\r\n  const handleDrawerOpen = () => {\r\n    setOpen(true);\r\n  };\r\n  const handleDrawerClose = () => {\r\n    setOpen(false);\r\n  };\r\n  const handleSettingsClick = () => {\r\n    if (!open) {\r\n      setOpen(true);\r\n    }\r\n    setSettingsOpen(!settingsOpen);\r\n  };\r\n\r\n  // アカウントアイコンの制御\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n  const accountIconOpen = Boolean(anchorEl);\r\n  const handleAccountMenu = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n  const handleMenuClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  // ログアウトアクション\r\n  const handleSignOut = async () => {\r\n    try {\r\n      const result = await get<string | undefined>('/oauth/signout');\r\n      if (result.ok) {\r\n        removeSessionStrage(); //sessionStrageから情報を削除\r\n        window.location.href = '/login';\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  // ストレージの状態初期値\r\n  const initialState: UserStorageState = {\r\n    signedIn: false,\r\n    email: '',\r\n    name: '',\r\n    isAdmin: false,\r\n    isFront: false,\r\n  };\r\n  // ストレージの状態設定\r\n  const userStorageReducer = (state: UserStorageState, action: UserStorageAction) => {\r\n    switch (action.type) {\r\n      case 'signedIn':\r\n        return { signedIn: true, email: action.user.email, name: action.user.name, isAdmin: action.user.isAdmin, isFront: action.user.isFront };\r\n      case 'signedOut':\r\n        return initialState;\r\n      default:\r\n        return state;\r\n    }\r\n  };\r\n  // ストレージの状態管理\r\n  const [userStorage, dispatch] = useReducer(userStorageReducer, initialState);\r\n\r\n  // MS認証状態の確認\r\n  const checkAuth = useCallback(async () => {\r\n    try {\r\n      const data = getUserInfo(); //sessionStrageからUser情報を取得\r\n      if (data) {\r\n        // sessionStrageから復元\r\n        const user = JSON.parse(data) as User;\r\n        dispatch({ type: 'signedIn', user: user });\r\n      } else {\r\n        // サーバーのセッションにユーザー情報が登録されているか確認\r\n        const result = await get<User>('/user/me');\r\n        if (result.parsedBody) {\r\n          const user = result.parsedBody;\r\n          saveUserInfo(JSON.stringify(user)); //sessionStrageにUser情報を格納\r\n          dispatch({ type: 'signedIn', user: user });\r\n        } else {\r\n          removeSessionStrage();\r\n          dispatch({ type: 'signedOut' });\r\n          console.log('Failed to retrieve email');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      // serverのpoliciesで弾かれた場合、ここへ遷移\r\n      removeSessionStrage();\r\n      window.location.href = '/login';\r\n    }\r\n  }, []);\r\n\r\n  // 画面リフレッシュ\r\n  const refreshPage = () => {\r\n    setReloadStateFlg(); // リフレッシュ後にstateを復元できるようフラグをONにする\r\n    window.location.reload();\r\n  };\r\n\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, [checkAuth]);\r\n\r\n  // ================================\r\n  // ReloadStateStrageの初期化\r\n  useEffect(() => {\r\n    if (!getReloadStateFlg()) initReloadState();\r\n  }, []);\r\n  // ================================\r\n\r\n  // 権限制御をつけてchildrenを表示する\r\n  let conditionalChildren = children;\r\n  const error = <>{t('common.msg.authority-error')}</>;\r\n  if (adminMode && !userStorage.isAdmin) {\r\n    conditionalChildren = error; // 管理者Roleエラー\r\n  }\r\n  if (frontMode && !userStorage.isFront) {\r\n    conditionalChildren = error; // フロントRoleエラー\r\n  }\r\n\r\n  if (!userStorage.signedIn) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <MySnackberProvider>\r\n      <div className={classes.root}>\r\n        <AppBar position=\"absolute\" className={clsx(classes.appBar, open && classes.appBarShift)}>\r\n          <Toolbar className={classes.toolbar}>\r\n            <IconButton\r\n              edge=\"start\"\r\n              color=\"inherit\"\r\n              aria-label=\"open drawer\"\r\n              onClick={handleDrawerOpen}\r\n              className={clsx(classes.menuButton, open && classes.menuButtonHidden)}\r\n            >\r\n              <MenuIcon />\r\n            </IconButton>\r\n            <Typography component=\"h1\" variant=\"h6\" color=\"inherit\" noWrap className={classes.title}>\r\n              LIVENESS Visitors for Microsoft\r\n            </Typography>\r\n            <div>\r\n              <MyLocation></MyLocation>\r\n            </div>\r\n            <div>\r\n              <IconButton\r\n                aria-label=\"account of current user\"\r\n                aria-controls=\"menu-appbar\"\r\n                aria-haspopup=\"true\"\r\n                onClick={handleAccountMenu}\r\n                color=\"inherit\"\r\n              >\r\n                <AccountCircle />\r\n              </IconButton>\r\n              <Menu\r\n                id=\"menu-appbar\"\r\n                anchorEl={anchorEl}\r\n                anchorOrigin={{\r\n                  vertical: 'top',\r\n                  horizontal: 'right',\r\n                }}\r\n                keepMounted\r\n                transformOrigin={{\r\n                  vertical: 'top',\r\n                  horizontal: 'right',\r\n                }}\r\n                open={accountIconOpen}\r\n                onClose={handleMenuClose}\r\n              >\r\n                <MenuItem onClick={handleMenuClose}>{userStorage.email}</MenuItem>\r\n                <MenuItem onClick={handleSignOut}>{t('main.menu.logout')}</MenuItem>\r\n              </Menu>\r\n            </div>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <Drawer\r\n          variant=\"permanent\"\r\n          classes={{\r\n            paper: clsx(classes.drawerPaper, !open && classes.drawerPaperClose),\r\n          }}\r\n          open={open}\r\n        >\r\n          <div className={classes.drawerCloseIcon}>\r\n            <IconButton onClick={handleDrawerClose}>\r\n              <ChevronLeftIcon />\r\n            </IconButton>\r\n          </div>\r\n          <Divider />\r\n          <List>\r\n            <Link to={`/${match.params.location}/main`} className={classes.link}>\r\n              <ListItem button>\r\n                <Tooltip title={t('main.menu.created-visit-info') as string}>\r\n                  <ListItemIcon>\r\n                    <FaceIcon />\r\n                  </ListItemIcon>\r\n                </Tooltip>\r\n                <ListItemText primary={t('main.menu.created-visit-info')} />\r\n              </ListItem>\r\n            </Link>\r\n            <Link to={`/${match.params.location}/main/byroom`} className={classes.link}>\r\n              <ListItem button>\r\n                <Tooltip title={t('main.menu.by-meeting-room') as string}>\r\n                  <ListItemIcon>\r\n                    <MeetingRoomIcon />\r\n                  </ListItemIcon>\r\n                </Tooltip>\r\n                <ListItemText primary={t('main.menu.by-meeting-room')} />\r\n              </ListItem>\r\n            </Link>\r\n            {userStorage.isFront && (\r\n              <Link to={`/${match.params.location}/front`} className={classes.link}>\r\n                <ListItem button>\r\n                  <Tooltip title={t('main.menu.front') as string}>\r\n                    <ListItemIcon>\r\n                      <PeopleIcon />\r\n                    </ListItemIcon>\r\n                  </Tooltip>\r\n                  <ListItemText primary={t('main.menu.front')} />\r\n                </ListItem>\r\n              </Link>\r\n            )}\r\n            {userStorage.isAdmin && (\r\n              <>\r\n                <ListItem button onClick={handleSettingsClick}>\r\n                  <ListItemIcon>\r\n                    <SettingsIcon />\r\n                  </ListItemIcon>\r\n                  <ListItemText primary={t('main.menu.settings')} />\r\n                  {settingsOpen ? <ExpandLess /> : <ExpandMore />}\r\n                </ListItem>\r\n                <Collapse in={settingsOpen} timeout=\"auto\" unmountOnExit>\r\n                  <Link to={`/${match.params.location}/settings/role`} className={classes.link}>\r\n                    <ListItem button className={classes.nested}>\r\n                      <ListItemText primary={t('main.menu.settings.role')} />\r\n                    </ListItem>\r\n                  </Link>\r\n                  <Link to={`/${match.params.location}/settings/location`} className={classes.link}>\r\n                    <ListItem button className={classes.nested}>\r\n                      <ListItemText primary={t('main.menu.settings.location')} />\r\n                    </ListItem>\r\n                  </Link>\r\n                  <Link to={`/${match.params.location}/settings/category`} className={classes.link}>\r\n                    <ListItem button className={classes.nested}>\r\n                      <ListItemText primary={t('main.menu.settings.category')} />\r\n                    </ListItem>\r\n                  </Link>\r\n                  <Link to={`/${match.params.location}/settings/room`} className={classes.link}>\r\n                    <ListItem button className={classes.nested}>\r\n                      <ListItemText primary={t('main.menu.settings.room')} />\r\n                    </ListItem>\r\n                  </Link>\r\n                </Collapse>\r\n              </>\r\n            )}\r\n            <ListItem button onClick={refreshPage}>\r\n              <Tooltip title={t('main.menu.refresh') as string}>\r\n                <ListItemIcon>\r\n                  <RefreshIcon />\r\n                </ListItemIcon>\r\n              </Tooltip>\r\n              <ListItemText primary={t('main.menu.refresh')} />\r\n            </ListItem>\r\n          </List>\r\n        </Drawer>\r\n        <main className={classes.content}>\r\n          <div className={classes.appBarSpacer} />\r\n          <Container maxWidth=\"lg\" className={classes.container}>\r\n            {/* <Typography component=\"h2\" variant=\"h5\" color=\"inherit\" noWrap className={classes.pageTitle}>\r\n              {title}\r\n            </Typography> */}\r\n            {conditionalChildren}\r\n            <Box pt={4}>\r\n              <Copyright />\r\n            </Box>\r\n          </Container>\r\n        </main>\r\n      </div>\r\n    </MySnackberProvider>\r\n  );\r\n};\r\n\r\nexport default BaseTemplate;\r\n","import { useEffect, useState } from 'react';\r\nimport { getReloadStateFlg, saveReloadState } from './SessionStrage';\r\n\r\n/**\r\n * カレンダー選択用カスタムフック\r\n */\r\nexport function useSelectedDate() {\r\n  // カレンダー選択日の状態\r\n  const [selectedDate, setSelectedDate] = useState<Date | null>(new Date());\r\n\r\n  // ================================\r\n  // ReloadStateStrageの設定\r\n  useEffect(() => {\r\n    if (!getReloadStateFlg()) {\r\n      saveReloadState('selectedDate', selectedDate!.getTime().toString());\r\n    }\r\n  }, [selectedDate]);\r\n  // ================================\r\n\r\n  return [selectedDate, setSelectedDate] as const;\r\n}\r\n","import { forwardRef } from 'react';\r\nimport AddBox from '@material-ui/icons/AddBox';\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpward';\r\nimport Check from '@material-ui/icons/Check';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport Clear from '@material-ui/icons/Clear';\r\nimport DeleteOutline from '@material-ui/icons/DeleteOutline';\r\nimport Edit from '@material-ui/icons/Edit';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\nimport Remove from '@material-ui/icons/Remove';\r\nimport SaveAlt from '@material-ui/icons/SaveAlt';\r\nimport Search from '@material-ui/icons/Search';\r\nimport ViewColumn from '@material-ui/icons/ViewColumn';\r\nimport { Icons } from 'material-table';\r\n\r\n/**\r\n * MaterialTableでMaterialIconを表示するための定義\r\n */\r\nexport const tableIcons: Icons = {\r\n  Add: forwardRef((props, ref) => <AddBox {...props} ref={ref} />),\r\n  Check: forwardRef((props, ref) => <Check {...props} ref={ref} />),\r\n  Clear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n  Delete: forwardRef((props, ref) => <DeleteOutline {...props} ref={ref} />),\r\n  DetailPanel: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n  Edit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\r\n  Export: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\r\n  Filter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\r\n  FirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\r\n  LastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\r\n  NextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n  PreviousPage: forwardRef((props, ref) => <ChevronLeft {...props} ref={ref} />),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref} />),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref} />),\r\n  ThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\r\n  ViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />),\r\n};\r\n\r\n/**\r\n * ページ設定共通用\r\n */\r\nexport const pageingOntions = {\r\n  paging: true,\r\n  pageSize: 10, // make initial page size\r\n  // emptyRowsWhenPaging: false, // To avoid of having empty rows\r\n  pageSizeOptions: [5, 10, 20, 50], // rows selection options\r\n};\r\n","import { makeStyles } from '@material-ui/core';\r\nimport { ClassNameMap } from '@material-ui/core/styles/withStyles';\r\nimport i18next from 'i18next';\r\nimport clsx from 'clsx';\r\nimport { FrontRowData } from 'main/front/DataTable';\r\nimport { RowDataType } from 'main/DataTableBase';\r\n\r\nexport const makeVisitorTableStyles = () => {\r\n  return makeStyles(() => ({\r\n    //cell default\r\n    cellApptTime: {},\r\n    cellRoomName: {},\r\n    cellRoomStatus: {},\r\n    cellReservationName: {},\r\n    cellVisitCompany: {},\r\n    cellSubject: {},\r\n    cellContactAddr: {},\r\n    cellCheckIn: {},\r\n    cellCheckOut: {},\r\n    // 会議室状態が辞退の場合\r\n    declinedApptTime: { textDecoration: 'line-through 2px solid red' },\r\n    declinedRoomName: {\r\n      '&::after': {\r\n        wordBreak: 'keep-all',\r\n        marginLeft: 5,\r\n        padding: '1px 5px',\r\n        color: 'red',\r\n        border: '1px solid red',\r\n        content: `\"${i18next.t('visitdialog.view.resource-status-declined')}\"`,\r\n      },\r\n    },\r\n  }));\r\n};\r\n\r\nexport const cellStyle = (field: String, rowData: RowDataType | FrontRowData, classes: ClassNameMap<string>) => {\r\n  const className = field.charAt(0).toUpperCase() + field.slice(1);\r\n  return clsx(\r\n    classes[`cell${className}` as keyof ClassNameMap],\r\n    rowData.roomStatus === 'declined' && classes[`declined${className}` as keyof ClassNameMap]\r\n  );\r\n};\r\n","import { createTheme, makeStyles } from '@material-ui/core';\r\nimport { grey, purple } from '@material-ui/core/colors';\r\n\r\nexport const tableTheme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      main: grey[300],\r\n    },\r\n    secondary: {\r\n      main: purple[500],\r\n    },\r\n  },\r\n  props: {\r\n    MuiTableRow: {\r\n      // hover: true,\r\n      // selected: true,\r\n    },\r\n  },\r\n  overrides: {\r\n    MuiTable: {\r\n      root: {\r\n        borderCollapse: 'separate',\r\n      },\r\n    },\r\n  },\r\n});\r\n\r\nexport const makeTableDialogStyle = () => {\r\n  const border = 'thin solid rgba(0, 0, 0, 0.12)';\r\n  return makeStyles((tableTheme) => ({\r\n    list: {\r\n      display: 'flex',\r\n      // flexFlow: 'row-wrap',\r\n      // width: '100%',\r\n      '&:first-child > div': {\r\n        borderTop: border,\r\n      },\r\n    },\r\n    title: {\r\n      boxSizing: 'border-box',\r\n      flexBasis: '25%',\r\n      padding: '0.7em',\r\n      backgroundColor: tableTheme.palette.primary.light,\r\n      borderLeft: border,\r\n      borderBottom: border,\r\n    },\r\n    field: {\r\n      boxSizing: 'border-box',\r\n      flexBasis: '75%',\r\n      padding: '0.7em',\r\n      borderRight: border,\r\n      borderBottom: border,\r\n      whiteSpace: 'pre-wrap',\r\n    },\r\n    fieldSlim: {\r\n      boxSizing: 'border-box',\r\n      flexBasis: '75%',\r\n      padding: '0.2em',\r\n      borderRight: border,\r\n      borderBottom: border,\r\n      whiteSpace: 'pre-wrap',\r\n    },\r\n  }));\r\n};\r\n","export const nameOfRoomType = ['rooms', 'free'] as const;\r\nexport type RoomType = typeof nameOfRoomType[number];\r\n\r\nexport const nameOfUsageRangeForVisitor = ['outside', 'inside'] as const;\r\nexport type UsageRangeForVisitor = typeof nameOfUsageRangeForVisitor[number];\r\nexport const nameOfUsageRange = ['none', ...nameOfUsageRangeForVisitor] as const;\r\nexport type UsageRange = typeof nameOfUsageRange[number];\r\n\r\nexport type Room = {\r\n  id: string;\r\n  name: string;\r\n  email: string;\r\n  sort: string;\r\n  usageRange: UsageRange;\r\n  type: RoomType;\r\n  teaSupply: boolean;\r\n  location: string;\r\n  category: string;\r\n};\r\n","import { post, HttpResponse, PostDataResult } from '_utils/Http';\r\nimport { DeepMap, DeepPartial } from 'react-hook-form/dist/types/utils';\r\n\r\ntype FormDataType<T, U> = {\r\n  inputs: T;\r\n  // dirtyFields: { [P in keyof T]?: boolean };\r\n  dirtyFields: DeepMap<DeepPartial<U>, boolean>;\r\n};\r\n\r\nexport async function fetchPostData<T, U, P>(url: string, formData: FormDataType<T, U>) {\r\n  let response: HttpResponse<PostDataResult<T, P>>;\r\n  try {\r\n    // console.log('formData', formData); // TODO: debug\r\n    response = await post<PostDataResult<T, P>>(url, formData);\r\n    // console.log('response', response); // TODO: debug\r\n\r\n    const result = response.parsedBody;\r\n    if (result) {\r\n      return Promise.resolve(result);\r\n    } else {\r\n      return Promise.reject(new Error('No Result Error'));\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n    return Promise.reject(error);\r\n  }\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\nimport { MenuItem, TextField } from '@material-ui/core';\r\nimport { Control, Controller, DeepMap, DeepPartial, FieldError, FieldValues, Path, RegisterOptions } from 'react-hook-form';\r\n\r\ntype ControllerTextFieldProps<TFieldValues extends FieldValues, TName extends Path<TFieldValues>> = {\r\n  name: TName;\r\n  control: Control<TFieldValues>;\r\n  label: string;\r\n  required?: true | boolean;\r\n  validation?: RegisterOptions;\r\n  multiline?: true | boolean;\r\n  disabled?: true | boolean;\r\n  selectList?: SelectOption[];\r\n  errors: DeepMap<DeepPartial<TFieldValues>, FieldError>;\r\n};\r\nexport type SelectOption = {\r\n  label: string;\r\n  value: string;\r\n};\r\n\r\nexport function ControllerTextField<TFieldValues extends FieldValues, TName extends Path<TFieldValues>>(\r\n  props: ControllerTextFieldProps<TFieldValues, TName>\r\n) {\r\n  const { name, control, label, required, selectList, multiline, disabled, validation, errors } = props;\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const rules: RegisterOptions = { required: required ? (t('common.form.required') as string) : false, ...validation };\r\n\r\n  return (\r\n    <Controller<TFieldValues, TName>\r\n      name={name}\r\n      control={control}\r\n      rules={rules}\r\n      render={({ field }) => (\r\n        <TextField\r\n          {...field}\r\n          label={label}\r\n          disabled={disabled}\r\n          multiline={multiline}\r\n          select={!!selectList}\r\n          error={!!errors[name]}\r\n          helperText={errors[name] && (errors[name] as FieldError).message}\r\n        >\r\n          {!!selectList &&\r\n            selectList.map((option, index) => (\r\n              <MenuItem key={`${name}-${index}`} value={option.value}>\r\n                {option.label}\r\n              </MenuItem>\r\n            ))}\r\n        </TextField>\r\n      )}\r\n    />\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Control, Controller, DeepMap, DeepPartial, FieldError, FieldValues, Path } from 'react-hook-form';\r\n\r\nimport { Autocomplete } from '@material-ui/lab';\r\nimport { Chip, CircularProgress, TextField } from '@material-ui/core';\r\nimport { CSSProperties } from '@material-ui/styles';\r\n\r\nimport { EmailAddress } from '_models/User';\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\ntype AddrBookAutoCompleteType<TFieldValues extends FieldValues, TName extends Path<TFieldValues>> = {\r\n  name: TName;\r\n  control: Control<TFieldValues>;\r\n  label: string;\r\n  errors: DeepMap<DeepPartial<TFieldValues>, FieldError>;\r\n  disabled?: boolean;\r\n  style?: CSSProperties;\r\n};\r\n\r\nexport function AddrBookAutoComplete<TFieldValues extends FieldValues, TName extends Path<TFieldValues>>(\r\n  props: AddrBookAutoCompleteType<TFieldValues, TName>\r\n) {\r\n  const { name, control, label, errors, disabled, style } = props;\r\n\r\n  const { t } = useTranslation();\r\n\r\n  // アドレス帳の取得\r\n  const [filter, setFilter] = useState('');\r\n  const [{ data: addressbook, isLoading: loading }] = useLoadData<EmailAddress[]>(`/user/addressbook?filter=${filter}`, []);\r\n\r\n  // アドレス帳検索の状態\r\n  const [open, setOpen] = useState(false);\r\n\r\n  // アドレス帳検索の初期化\r\n  useEffect(() => {\r\n    if (!open) {\r\n      setFilter('');\r\n    }\r\n  }, [open]);\r\n\r\n  // アドレス帳検索値のリアルタイム取得\r\n  const onChangeHandle = async (value: string) => {\r\n    setFilter(value);\r\n  };\r\n\r\n  return (\r\n    <Controller<TFieldValues, TName>\r\n      name={name}\r\n      control={control}\r\n      render={({ field }) => (\r\n        <Autocomplete\r\n          {...field}\r\n          disabled={disabled}\r\n          style={style}\r\n          multiple\r\n          limitTags={disabled ? undefined : 2}\r\n          size=\"small\"\r\n          open={open}\r\n          onOpen={() => {\r\n            setOpen(true);\r\n          }}\r\n          onClose={() => {\r\n            setOpen(false);\r\n          }}\r\n          options={!!addressbook && !!filter ? addressbook : []}\r\n          noOptionsText={t('auto-complete.no-options-text')}\r\n          loading={loading}\r\n          getOptionLabel={(option) => `${option.name} <${option.address}>`}\r\n          renderTags={(tagValue, getTagProps) =>\r\n            tagValue.map((option, index) => <Chip label={option.name} title={option.address} {...getTagProps({ index })} />)\r\n          }\r\n          filterSelectedOptions\r\n          getOptionSelected={(option, value) => option.address === value.address}\r\n          renderInput={(params) => (\r\n            <TextField\r\n              {...params}\r\n              label={label}\r\n              error={!!errors[name]}\r\n              helperText={errors[name] && (errors[name] as FieldError).message}\r\n              InputProps={{\r\n                ...params.InputProps,\r\n                endAdornment: (\r\n                  <>\r\n                    {loading ? <CircularProgress color=\"inherit\" size={20} /> : null}\r\n                    {params.InputProps.endAdornment}\r\n                  </>\r\n                ),\r\n              }}\r\n              onChange={(ev) => {\r\n                if (ev.target.value !== '' || ev.target.value !== null) {\r\n                  onChangeHandle(ev.target.value);\r\n                }\r\n              }}\r\n            />\r\n          )}\r\n          onChange={(_, data) => field.onChange(data)}\r\n        />\r\n      )}\r\n    />\r\n  );\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\n\r\nimport { Button, makeStyles, createStyles, IconButton } from '@material-ui/core';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nconst useStyles = makeStyles((theme) =>\r\n  createStyles({\r\n    root: {\r\n      margin: 0,\r\n      padding: theme.spacing(1.5),\r\n      paddingLeft: theme.spacing(2),\r\n    },\r\n    closeButton: {\r\n      position: 'absolute',\r\n      right: theme.spacing(0.75),\r\n      top: theme.spacing(0.75),\r\n      color: theme.palette.grey[500],\r\n    },\r\n  })\r\n);\r\n\r\ntype MyDialogProps = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  title: string;\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport function MyDialog(props: MyDialogProps) {\r\n  const { open, onClose, title, children } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n\r\n  const handleCancel = () => {\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={open} onClose={onClose} fullWidth={true} maxWidth=\"sm\" aria-labelledby=\"form-dialog-title\">\r\n        <DialogTitle id=\"form-dialog-title\" className={classes.root}>\r\n          {title}\r\n          <IconButton className={classes.closeButton} onClick={handleCancel}>\r\n            <CloseIcon />\r\n          </IconButton>\r\n        </DialogTitle>\r\n        <DialogContent dividers>{children}</DialogContent>\r\n        <DialogActions style={{ display: 'none' }}>\r\n          <Button onClick={handleCancel}>{t('common.button.cancel')}</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n","import Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\ntype DeleteConfirmDialogPorps = {\r\n  open: boolean;\r\n  onClose: (deleteOk: boolean) => void;\r\n};\r\n\r\nexport function DeleteConfirmDialog(props: DeleteConfirmDialogPorps) {\r\n  const { open, onClose } = props;\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const handleClose = () => {\r\n    onClose(false);\r\n  };\r\n  const handleOkClose = () => {\r\n    onClose(true);\r\n  };\r\n  const handleCancelClose = () => {\r\n    onClose(false);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Dialog open={open} onClose={handleClose} aria-labelledby=\"alert-dialog-title\" aria-describedby=\"alert-dialog-description\">\r\n        {/* <DialogTitle id=\"alert-dialog-title\">{t('visitorinfoform.delete-confirm-title')}</DialogTitle> */}\r\n        <DialogContent>\r\n          <DialogContentText id=\"alert-dialog-description\">{t('visitorinfoform.delete-confirm-message')}</DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleOkClose} color=\"secondary\">\r\n            OK\r\n          </Button>\r\n          <Button onClick={handleCancelClose} color=\"secondary\" autoFocus>\r\n            CANCEL\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Control, Controller, DeepMap, DeepPartial, FieldError, UseFormSetValue, useWatch } from 'react-hook-form';\r\nimport { Box, FormControlLabel, Grid, MenuItem, Switch, TextField } from '@material-ui/core';\r\nimport { Room } from '_models/Room';\r\nimport { Inputs } from './RowDataInputDialog';\r\nimport { get } from 'lodash';\r\n\r\ntype RoomInputFieldsProps = {\r\n  control: Control<Inputs, object>;\r\n  setValue: UseFormSetValue<Inputs>;\r\n  rooms: Room[] | undefined;\r\n  roomId: string;\r\n  disabledVisitor: boolean;\r\n  disabledRoom?: boolean;\r\n  errors: DeepMap<DeepPartial<Inputs>, FieldError>;\r\n};\r\n\r\nexport function RoomInputFields(props: RoomInputFieldsProps) {\r\n  const { control, setValue, rooms, roomId, disabledVisitor, disabledRoom, errors } = props;\r\n\r\n  const { t } = useTranslation();\r\n\r\n  // 給茶選択の制御\r\n  const [disabledTeaSupply, setDisabledTeaSupply] = useState(false);\r\n\r\n  // 給茶選択の制御用に会議室選択を監視\r\n  const roomWatch = useWatch({ control, name: `resourcies.${roomId}.roomForEdit` });\r\n\r\n  // 給茶選択のエフェクト\r\n  useEffect(() => {\r\n    if (!!roomWatch && !!rooms) {\r\n      const result = rooms.some((room) => room.id === roomWatch && room.teaSupply);\r\n      if (!result) setValue(`resourcies.${roomId}.teaSupply`, false, { shouldDirty: true });\r\n      setDisabledTeaSupply(!result);\r\n    } else {\r\n      setValue(`resourcies.${roomId}.teaSupply`, false, { shouldDirty: true });\r\n      setDisabledTeaSupply(true);\r\n    }\r\n  }, [roomId, roomWatch, rooms, setValue]);\r\n\r\n  // 給茶人数の入力制御\r\n  const [disabledTeaMember, setDisabledTeaMember] = useState(false);\r\n\r\n  // 給茶人数の制御用に給茶選択を監視\r\n  const teaWatch = useWatch({ control, name: `resourcies.${roomId}.teaSupply` });\r\n\r\n  // 給茶人数のエフェクト\r\n  useEffect(() => {\r\n    if (!teaWatch) {\r\n      setValue(`resourcies.${roomId}.numberOfVisitor`, 0, { shouldDirty: true });\r\n      setValue(`resourcies.${roomId}.numberOfEmployee`, 0, { shouldDirty: true });\r\n    }\r\n    setDisabledTeaMember(!teaWatch);\r\n  }, [teaWatch, setValue, roomId]);\r\n\r\n  // 利用範囲のエフェクト（来訪者数のリセット）\r\n  useEffect(() => {\r\n    if (disabledVisitor) {\r\n      setValue(`resourcies.${roomId}.numberOfVisitor`, 0, { shouldDirty: true });\r\n    }\r\n  }, [setValue, disabledVisitor, roomId]);\r\n\r\n  // 多階層になっている場合の取得回避策\r\n  const getNestedError = (name: string): FieldError => {\r\n    return get(errors, `resourcies.${roomId}.${name}`) as FieldError;\r\n  };\r\n\r\n  if (rooms?.length === 0) {\r\n    return (\r\n      <Box px={2} style={{ textAlign: 'center', color: 'red' }}>\r\n        {t('visitdialog.notes.no-relevant-rooms')}\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box px={2}>\r\n      <Controller\r\n        name={`resourcies.${roomId}.roomForEdit`}\r\n        control={control}\r\n        rules={{\r\n          required: t('common.form.required') as string,\r\n          // 何らかの挙動で選択リストから消えた会議室を選択している場合のエラー処理\r\n          validate: (roomId) => (rooms!.some((room) => room.id === roomId) ? undefined : (t('visitdialog.form.error.room-not-covered') as string)),\r\n        }}\r\n        render={({ field }) => (\r\n          <TextField\r\n            {...field}\r\n            select\r\n            disabled={disabledRoom}\r\n            label={t('visittable.header.event-room')}\r\n            error={!!getNestedError('roomForEdit')}\r\n            helperText={!!getNestedError('roomForEdit') && getNestedError('roomForEdit').message}\r\n          >\r\n            {rooms!.map((option) => (\r\n              <MenuItem key={option.id} value={option.id}>\r\n                {option.name} {'<'}\r\n                {option.email}\r\n                {'>'}\r\n              </MenuItem>\r\n            ))}\r\n          </TextField>\r\n        )}\r\n      />\r\n\r\n      <Grid container spacing={1} style={disabledTeaSupply ? { display: 'none' } : undefined}>\r\n        <Grid item xs={4}>\r\n          <FormControlLabel\r\n            control={\r\n              <Controller\r\n                name={`resourcies.${roomId}.teaSupply`}\r\n                control={control}\r\n                render={({ field }) => (\r\n                  <Switch onChange={(e) => field.onChange(e.target.checked)} checked={field.value} color=\"primary\" disabled={disabledTeaSupply} />\r\n                )}\r\n              />\r\n            }\r\n            label={t('visittable.header.tea-supply')}\r\n          />\r\n        </Grid>\r\n\r\n        <Grid item xs={4} style={disabledVisitor ? { opacity: 0 } : undefined}>\r\n          <Controller\r\n            name={`resourcies.${roomId}.numberOfVisitor`}\r\n            control={control}\r\n            rules={{ required: t('common.form.required') as string }}\r\n            render={({ field }) => (\r\n              <TextField\r\n                type=\"number\"\r\n                inputProps={{ min: 0, style: { textAlign: 'right' } }}\r\n                {...field}\r\n                disabled={disabledTeaMember || disabledVisitor}\r\n                label={t('visittable.header.number-of-visitor')}\r\n                error={!!getNestedError('numberOfVisitor')}\r\n                helperText={!!getNestedError('numberOfVisitor') && getNestedError('numberOfVisitor').message}\r\n              />\r\n            )}\r\n          />\r\n        </Grid>\r\n\r\n        <Grid item xs={4}>\r\n          <Controller\r\n            name={`resourcies.${roomId}.numberOfEmployee`}\r\n            control={control}\r\n            rules={{ required: t('common.form.required') as string }}\r\n            render={({ field }) => (\r\n              <TextField\r\n                type=\"number\"\r\n                inputProps={{ min: 0, style: { textAlign: 'right' } }}\r\n                {...field}\r\n                disabled={disabledTeaMember}\r\n                label={t('visittable.header.number-of-employee')}\r\n                error={!!getNestedError('numberOfEmployee')}\r\n                helperText={!!getNestedError('numberOfEmployee') && getNestedError('numberOfEmployee').message}\r\n              />\r\n            )}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n    </Box>\r\n  );\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\nimport { Box, List } from '@material-ui/core';\r\nimport { ResourciesReadOnly, VisitorInfoResourcies } from '_models/VisitorInfo';\r\nimport { makeTableDialogStyle } from '_styles/TableTheme';\r\n\r\nconst useRowDataDialogStyles = makeTableDialogStyle();\r\n\r\nexport const strRoomStatus = (status: string | undefined) => {\r\n  switch (status) {\r\n    case 'accepted':\r\n      return 'visitdialog.view.resource-status-accepted';\r\n    case 'declined':\r\n      return 'visitdialog.view.resource-status-declined';\r\n    default:\r\n      return '';\r\n  }\r\n};\r\n\r\ntype RoomReadFieldsProps = {\r\n  data: VisitorInfoResourcies & ResourciesReadOnly;\r\n  hiddenTeaSupply?: boolean;\r\n};\r\n\r\nexport function RoomReadFields(props: RoomReadFieldsProps) {\r\n  const { data, hiddenTeaSupply } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useRowDataDialogStyles();\r\n\r\n  return (\r\n    <Box px={2} pt={2}>\r\n      <List disablePadding={true}>\r\n        <li key=\"room-name\" className={classes.list}>\r\n          <div className={classes.title}>{t('visittable.header.room-name')}</div>\r\n          <div className={classes.field}>\r\n            {data.roomName} {'<'}\r\n            {data.roomEmail}\r\n            {'>'}\r\n          </div>\r\n        </li>\r\n        <li key=\"resource-status\" className={classes.list}>\r\n          <div className={classes.title}>{t('visittable.header.resource-status')}</div>\r\n          <div className={classes.field}>{t(strRoomStatus(data.roomStatus))}</div>\r\n        </li>\r\n\r\n        {!hiddenTeaSupply && (\r\n          <>\r\n            <li key=\"tea-supply\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.tea-supply')}</div>\r\n              <div className={classes.field}>{data.teaSupply ? t('visitdialog.form.tea-supply-yes') : t('visitdialog.form.tea-supply-no')}</div>\r\n            </li>\r\n\r\n            {data.teaSupply && (\r\n              <>\r\n                <li key=\"number-of-visitor\" className={classes.list}>\r\n                  <div className={classes.title}>{t('visittable.header.number-of-visitor')}</div>\r\n                  <div className={classes.field} style={{ flexBasis: '25%', borderRight: 'none' }}>\r\n                    {data.numberOfVisitor}\r\n                  </div>\r\n                  <div className={classes.title} style={{ flexBasis: '25%', borderLeft: 'none' }}>\r\n                    {t('visittable.header.number-of-employee')}\r\n                  </div>\r\n                  <div className={classes.field} style={{ flexBasis: '25%' }}>\r\n                    {data.numberOfEmployee}\r\n                  </div>\r\n                </li>\r\n              </>\r\n            )}\r\n          </>\r\n        )}\r\n      </List>\r\n    </Box>\r\n  );\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\nimport { Control, Controller, DeepMap, DeepPartial, FieldError, UseFormGetValues } from 'react-hook-form';\r\n\r\nimport { Inputs } from './RowDataInputDialog';\r\n\r\ntype ControllerDateTimePickerProps = {\r\n  name: 'startTime' | 'endTime';\r\n  control: Control<Inputs, object>;\r\n  getValues: UseFormGetValues<Inputs>;\r\n  label: string;\r\n  handleDateTimeChange: () => void;\r\n  errors: DeepMap<DeepPartial<Inputs>, FieldError>;\r\n};\r\n\r\nexport function ControllerDateTimePicker(props: ControllerDateTimePickerProps) {\r\n  const { name, control, getValues, label, handleDateTimeChange, errors } = props;\r\n\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <Controller\r\n      name={name}\r\n      control={control}\r\n      rules={{\r\n        required: t('common.form.required') as string,\r\n        validate: () => getValues('startTime').getTime() < getValues('endTime').getTime() || (t('visitdialog.form.error.event-time') as string),\r\n      }}\r\n      render={({ field }) => (\r\n        <DateTimePicker\r\n          {...field}\r\n          onChange={(e) => {\r\n            field.onChange(e);\r\n            handleDateTimeChange();\r\n          }}\r\n          ampm={false}\r\n          format=\"yyyy/MM/dd HH:mm\"\r\n          disablePast\r\n          minutesStep={5} //TODO: Interval config化？\r\n          label={label}\r\n          error={!!errors[name]}\r\n          helperText={errors[name] && (errors[name] as FieldError).message}\r\n          ref={null}\r\n        />\r\n      )}\r\n    />\r\n  );\r\n}\r\n","import { useCallback, useContext, useEffect, useState } from 'react';\r\nimport { useRouteMatch } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { SubmitHandler, useForm, useWatch } from 'react-hook-form';\r\n\r\nimport { Box, Grid, Button, List } from '@material-ui/core';\r\nimport { makeStyles, createStyles, createTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport { grey, purple } from '@material-ui/core/colors';\r\n\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\n\r\nimport { addMinutes } from 'date-fns';\r\nimport _ from 'lodash';\r\n\r\nimport { VisitorInfo, EventInputType, RoomInputType } from '_models/VisitorInfo';\r\nimport { nameOfUsageRangeForVisitor, Room, UsageRangeForVisitor } from '_models/Room';\r\nimport { LocationParams } from '_models/Location';\r\n\r\nimport { tableTheme, makeTableDialogStyle } from '_styles/TableTheme';\r\n\r\nimport { fetchPostData } from '_utils/FetchPostData';\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\nimport { MySnackberContext } from '_components/MySnackbarContext';\r\nimport { Spinner } from '_components/Spinner';\r\nimport { ControllerTextField } from '_components/ControllerTextField';\r\nimport { AddrBookAutoComplete } from '_components/AddrBookAutoComplete';\r\nimport { MyDialog } from '_components/MyDialog';\r\n\r\nimport { RowDataType } from './DataTableBase';\r\nimport { DeleteConfirmDialog } from './DeleteConfirmDialog';\r\nimport { RoomInputFields } from './RoomInputFields';\r\nimport { RoomReadFields, strRoomStatus } from './RoomReadFields';\r\nimport { ControllerDateTimePicker } from './ControllerDateTimePicker';\r\n\r\nconst useRowDataDialogStyles = makeTableDialogStyle();\r\n\r\nconst useStyles = makeStyles((tableTheme) => {\r\n  return createStyles({\r\n    formAction: {\r\n      marginTop: tableTheme.spacing(1),\r\n      marginBottom: tableTheme.spacing(1),\r\n    },\r\n    note: {\r\n      color: 'red',\r\n      fontSize: '0.9em',\r\n      margin: 0,\r\n    },\r\n  });\r\n});\r\n\r\nconst inputformTheme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      main: purple[500],\r\n    },\r\n    secondary: {\r\n      main: grey[300],\r\n    },\r\n  },\r\n  props: {\r\n    MuiTextField: {\r\n      variant: 'outlined',\r\n      margin: 'dense',\r\n      fullWidth: true,\r\n      minRows: 4,\r\n    },\r\n  },\r\n});\r\n\r\nconst startTimeBufferMinute = 0;\r\nconst endTimeBufferMinute = 30; //TODO: Interval config化？\r\nconst change5MinuteIntervals = (date: Date) => Math.ceil(date.getTime() / 1000 / 60 / 5) * 1000 * 60 * 5; //TODO: Interval config化？\r\n\r\nexport type Inputs = {\r\n  mode: 'ins' | 'upd' | 'del';\r\n} & VisitorInfo &\r\n  EventInputType;\r\n\r\nexport const ADD_ROOM_KEY = 'add-room-01';\r\n\r\nexport type AddDefaultType = {\r\n  start: Date;\r\n  roomId: string;\r\n  usageRange: UsageRangeForVisitor;\r\n};\r\n\r\n// 入力フォームの初期値\r\nconst getDefaultValues = (start?: Date, roomId?: string, usage?: UsageRangeForVisitor) => {\r\n  const startDate = start ? start : new Date();\r\n  const room = roomId ? roomId : '';\r\n  const usageRange = usage ? usage : 'outside';\r\n  return {\r\n    mode: 'ins',\r\n    iCalUId: '',\r\n    subject: '',\r\n    visitorId: '',\r\n    visitCompany: '',\r\n    visitorName: '',\r\n    mailto: { authors: [], required: [], optional: [] },\r\n    usageRange: usageRange,\r\n    resourcies: {\r\n      [ADD_ROOM_KEY]: {\r\n        roomForEdit: room,\r\n        teaSupply: false,\r\n        numberOfVisitor: 0,\r\n        numberOfEmployee: 0,\r\n      },\r\n    },\r\n    comment: '',\r\n    contactAddr: '',\r\n    startTime: addMinutes(change5MinuteIntervals(startDate), startTimeBufferMinute),\r\n    endTime: addMinutes(change5MinuteIntervals(startDate), startTimeBufferMinute + endTimeBufferMinute),\r\n  } as Inputs;\r\n};\r\n\r\ntype RowDataInputDialogProps = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  data: RowDataType | null;\r\n  reload: () => void;\r\n  addDefault?: AddDefaultType;\r\n};\r\n\r\nexport function RowDataInputDialog(props: RowDataInputDialogProps) {\r\n  const { open, onClose, data, reload, addDefault } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = { ...useRowDataDialogStyles(), ...useStyles() };\r\n  const snackberContext = useContext(MySnackberContext); // スナックバー取得用\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // 削除確認メッセージの状態\r\n  const [delConfOpen, setDelConfOpen] = useState(false);\r\n\r\n  // 入力フォームの登録\r\n  const defaultValues = getDefaultValues();\r\n  const {\r\n    control,\r\n    getValues,\r\n    handleSubmit,\r\n    reset,\r\n    setValue,\r\n    trigger,\r\n    setError,\r\n    formState: { errors, isDirty, isSubmitting, dirtyFields },\r\n  } = useForm<Inputs>({ defaultValues, reValidateMode: 'onSubmit' });\r\n\r\n  // 入力フォームの初期化\r\n  useEffect(() => {\r\n    if (open && !!data) {\r\n      reset({\r\n        mode: 'upd',\r\n        iCalUId: data.iCalUId,\r\n        subject: data.subject,\r\n        visitorId: data.visitorId,\r\n        visitCompany: data.visitCompany,\r\n        visitorName: data.visitorName,\r\n        mailto: data.mailto,\r\n        usageRange: data.usageRange,\r\n        resourcies: Object.keys(data.resourcies).reduce((newObj, room) => {\r\n          newObj[room] = {\r\n            roomForEdit: room,\r\n            teaSupply: data.resourcies[room].teaSupply,\r\n            numberOfVisitor: data.resourcies[room].numberOfVisitor,\r\n            numberOfEmployee: data.resourcies[room].numberOfEmployee,\r\n          };\r\n          return newObj;\r\n        }, {} as RoomInputType),\r\n        comment: data.comment,\r\n        contactAddr: data.contactAddr,\r\n        startTime: new Date(data.startDateTime),\r\n        endTime: new Date(data.endDateTime),\r\n      });\r\n    } else {\r\n      reset(_.cloneDeep(getDefaultValues(addDefault?.start, addDefault?.roomId, addDefault?.usageRange)));\r\n    }\r\n  }, [data, open, reset, addDefault]);\r\n\r\n  // ::空き会議室の制御関連 start -------------------------->\r\n  // 会議室コンポーネントの表示状態\r\n  const [hiddenRooms, setHiddenRooms] = useState(false);\r\n\r\n  // 利用範囲選択を監視\r\n  const usageRangeWatch = useWatch({ control, name: 'usageRange' });\r\n\r\n  // 空き会議室一覧の取得\r\n  const defaultRoomsUrl = `/room/choices?location=${match.params.location}`;\r\n  const [roomsUrl, setRoomsUrl] = useState(defaultRoomsUrl);\r\n  const [{ data: rooms }] = useLoadData<Room[]>(roomsUrl, []);\r\n\r\n  // 空き会議室一覧のURL更新\r\n  const buildRoomsUrl = useCallback(() => {\r\n    if (getValues('mode') === 'upd') {\r\n      // 更新時、会議室変更は出来ないためデフォルト値\r\n      setRoomsUrl(defaultRoomsUrl);\r\n    } else {\r\n      setRoomsUrl(\r\n        defaultRoomsUrl +\r\n          `&start=${getValues('startTime').getTime()}&end=${getValues('endTime').getTime()}` +\r\n          `&usagerange=${getValues('usageRange')}`\r\n      );\r\n    }\r\n  }, [defaultRoomsUrl, getValues]);\r\n\r\n  // 空き会議室一覧のURLリセット\r\n  useEffect(() => {\r\n    if (open) {\r\n      buildRoomsUrl();\r\n    }\r\n  }, [buildRoomsUrl, open, usageRangeWatch]); // 利用範囲変更時もリセット対象\r\n\r\n  // 会議室コンポーネントの表示リセット\r\n  useEffect(() => {\r\n    if (!open) setHiddenRooms(false);\r\n  }, [open]);\r\n\r\n  // ::空き会議室の制御関連 end --------------------------<\r\n\r\n  // 来訪情報の制御状態\r\n  const [disabledVisitor, setDisabledVisitor] = useState(false);\r\n\r\n  // 利用範囲のエフェクト（来訪情報の制御）\r\n  useEffect(() => {\r\n    // 社内会議\r\n    if (usageRangeWatch === 'inside') {\r\n      setValue('visitCompany', '', { shouldDirty: true });\r\n      setValue('visitorName', '', { shouldDirty: true });\r\n      setDisabledVisitor(true);\r\n    } else {\r\n      // 社外会議\r\n      setDisabledVisitor(false);\r\n    }\r\n  }, [setValue, usageRangeWatch]);\r\n\r\n  // 保存アクション\r\n  const handleSave = () => {\r\n    handleSubmit(onSubmit)();\r\n  };\r\n  // 削除アクション(確認メッセージ)\r\n  const handleDelete = () => {\r\n    setDelConfOpen(true);\r\n  };\r\n  // 削除アクション\r\n  const deleteAction = () => {\r\n    setValue('mode', 'del');\r\n    handleSubmit(onSubmit)();\r\n  };\r\n\r\n  // データ送信submit\r\n  const onSubmit: SubmitHandler<Inputs> = async (formData) => {\r\n    try {\r\n      let url = '';\r\n      switch (formData.mode) {\r\n        case 'ins':\r\n          url = '/event/create';\r\n          break;\r\n        case 'upd':\r\n          url = '/event/update';\r\n          // url = !data?.visitorId ? '/visitor/create' : '/visitor/update';\r\n          break;\r\n        case 'del':\r\n          url = '/event/delete';\r\n          // url = '/visitor/delete';\r\n          break;\r\n      }\r\n      const result = await fetchPostData(url, { inputs: formData, dirtyFields: dirtyFields });\r\n      if (result!.success) {\r\n        if (formData.mode === 'del') await new Promise((r) => setTimeout(r, 1000)); // MSGraphのイベント削除が反映されるまでのタイムラグを考慮\r\n        await reload();\r\n        onClose();\r\n        snackberContext.dispatch({ type: 'success', message: t('common.msg.update-success') });\r\n      } else {\r\n        // エラー判定のセット\r\n        if (result!.errors) {\r\n          const errors = result!.errors;\r\n          for (let key in errors) {\r\n            let name = key as keyof Inputs;\r\n            setError(name, { message: t(errors[name]![0]) });\r\n          }\r\n        }\r\n        // snackberContext.dispatch({ type: 'error', message: t('common.msg.update-failed') });\r\n      }\r\n    } catch (error) {\r\n      snackberContext.dispatch({ type: 'error', message: (error as Error).message });\r\n    }\r\n  };\r\n\r\n  // 検索ボタンアクション\r\n  const handleSearch = async () => {\r\n    const result = await trigger(['startTime', 'endTime']); //validate\r\n    if (!result) return;\r\n    buildRoomsUrl();\r\n    setHiddenRooms(false);\r\n  };\r\n\r\n  // 検索ボタン活性化\r\n  const activeSearchButton = () => {\r\n    if (getValues('mode') === 'upd') return; // 更新時、会議室変更は出来ないため非対応\r\n    if (!hiddenRooms) {\r\n      setHiddenRooms(true);\r\n    }\r\n  };\r\n  // 開始日時の変更アクション\r\n  const handleStartTimeChange = () => {\r\n    const endTime = addMinutes(change5MinuteIntervals(getValues('startTime')), startTimeBufferMinute + endTimeBufferMinute);\r\n    setValue('endTime', endTime, { shouldDirty: true });\r\n    activeSearchButton();\r\n  };\r\n  // 終了日時の変更アクション\r\n  const handleEndTimeChange = () => {\r\n    activeSearchButton();\r\n  };\r\n\r\n  // 削除確認アクション\r\n  const handleDelConfClose = (deleteOk: boolean) => {\r\n    setDelConfOpen(false);\r\n    if (deleteOk) {\r\n      deleteAction();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Spinner open={isSubmitting} />\r\n      <MyDialog open={open} onClose={onClose} title={t('visitdialog.title')}>\r\n        <ThemeProvider theme={inputformTheme}>\r\n          {!!data && (\r\n            <Box px={2}>\r\n              {(() => {\r\n                if (data.isMSMultipleLocations) {\r\n                  /* mode=upd & 複数会議室 */\r\n                  return <p className={classes.note}>{t('visitdialog.notes.multiple-locations')}</p>;\r\n                } else {\r\n                  /* mode=upd & 単一会議室 */\r\n                  return (\r\n                    <List disablePadding={true}>\r\n                      <li key=\"resource-status\" className={classes.list}>\r\n                        <div className={classes.title}>{t('visittable.header.resource-status')}</div>\r\n                        <div className={classes.field}>{t(strRoomStatus(data.roomStatus))}</div>\r\n                      </li>\r\n                      <li key=\"reservation-name\" className={classes.list}>\r\n                        <div className={classes.title}>{t('visittable.header.reservation-name')}</div>\r\n                        <div className={classes.field}>{data.reservationName}</div>\r\n                      </li>\r\n                    </List>\r\n                  );\r\n                }\r\n              })()}\r\n            </Box>\r\n          )}\r\n\r\n          <form>\r\n            <Box p={2}>\r\n              <ControllerTextField name=\"subject\" control={control} label={t('visittable.header.event-subject')} required errors={errors} />\r\n\r\n              <AddrBookAutoComplete\r\n                name={'mailto.authors'}\r\n                control={control}\r\n                label={t('visittable.header.event-mailto-authors')}\r\n                errors={errors}\r\n                disabled={true}\r\n                style={{ display: 'none' }}\r\n              />\r\n              <AddrBookAutoComplete\r\n                name={'mailto.required'}\r\n                control={control}\r\n                label={t('visittable.header.event-mailto-required')}\r\n                errors={errors}\r\n                disabled={data?.isMSMultipleLocations}\r\n              />\r\n              <AddrBookAutoComplete\r\n                name={'mailto.optional'}\r\n                control={control}\r\n                label={t('visittable.header.event-mailto-optional')}\r\n                errors={errors}\r\n                disabled={data?.isMSMultipleLocations}\r\n              />\r\n\r\n              <Box py={1} style={!!data ? { display: 'none' } : undefined}>\r\n                <ControllerTextField\r\n                  name={'usageRange'}\r\n                  control={control}\r\n                  label={t('visittable.header.usage-range')}\r\n                  required\r\n                  selectList={nameOfUsageRangeForVisitor.map((value) => {\r\n                    return { label: t(`visitdialog.view.usage-range.${value}`), value: value };\r\n                  })}\r\n                  disabled={!!data}\r\n                  errors={errors}\r\n                />\r\n              </Box>\r\n\r\n              <Grid container spacing={1}>\r\n                <Grid item xs={5}>\r\n                  <ControllerDateTimePicker\r\n                    name=\"startTime\"\r\n                    control={control}\r\n                    getValues={getValues}\r\n                    label={t('visittable.header.event-start-time')}\r\n                    handleDateTimeChange={handleStartTimeChange}\r\n                    errors={errors}\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={5}>\r\n                  <ControllerDateTimePicker\r\n                    name=\"endTime\"\r\n                    control={control}\r\n                    getValues={getValues}\r\n                    label={t('visittable.header.event-end-time')}\r\n                    handleDateTimeChange={handleEndTimeChange}\r\n                    errors={errors}\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={2} style={{ margin: 'auto' }}>\r\n                  <Button onClick={handleSearch} variant=\"contained\" color=\"primary\" fullWidth disabled={data?.isMSMultipleLocations || !hiddenRooms}>\r\n                    {t('common.button.search')}\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Box>\r\n\r\n            {!data ? (\r\n              /* 新規作成 */\r\n              !hiddenRooms && (\r\n                <RoomInputFields\r\n                  control={control}\r\n                  setValue={setValue}\r\n                  rooms={rooms}\r\n                  roomId={ADD_ROOM_KEY}\r\n                  disabledVisitor={disabledVisitor}\r\n                  errors={errors}\r\n                />\r\n              )\r\n            ) : (\r\n              <>\r\n                {!data.isMSMultipleLocations ? (\r\n                  /* mode=upd & 単一会議室 */\r\n                  !hiddenRooms && (\r\n                    <RoomInputFields\r\n                      control={control}\r\n                      setValue={setValue}\r\n                      rooms={rooms}\r\n                      roomId={Object.keys(data.resourcies)[0]}\r\n                      disabledRoom={true}\r\n                      disabledVisitor={data.usageRange === 'inside'}\r\n                      errors={errors}\r\n                    />\r\n                  )\r\n                ) : (\r\n                  /* mode=upd & 複数会議室 */\r\n                  <ThemeProvider theme={tableTheme}>\r\n                    {Object.keys(data.resourcies).map((roomId) => {\r\n                      return <RoomReadFields key={roomId} data={data.resourcies[roomId]} /*hiddenTeaSupply={true}*/ />;\r\n                    })}\r\n                  </ThemeProvider>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n            <Box p={2} style={disabledVisitor ? { display: 'none' } : undefined}>\r\n              <ControllerTextField\r\n                name=\"visitCompany\"\r\n                control={control}\r\n                label={t('visittable.header.visit-company')}\r\n                required={!disabledVisitor}\r\n                disabled={disabledVisitor}\r\n                errors={errors}\r\n              />\r\n              <ControllerTextField\r\n                name=\"visitorName\"\r\n                control={control}\r\n                label={t('visittable.header.visitor-name')}\r\n                disabled={disabledVisitor}\r\n                errors={errors}\r\n              />\r\n            </Box>\r\n\r\n            <Box p={2}>\r\n              <ControllerTextField name=\"comment\" control={control} label={t('visittable.header.comment')} multiline errors={errors} />\r\n              <ControllerTextField name=\"contactAddr\" control={control} label={t('visittable.header.contact-addr')} errors={errors} />\r\n            </Box>\r\n\r\n            <Box px={2}>\r\n              <Grid container justifyContent=\"space-between\" spacing={2} className={classes.formAction}>\r\n                <Grid item xs={!data ? 12 : 6}>\r\n                  <Button\r\n                    onClick={handleSave}\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disabled={!isDirty || hiddenRooms}\r\n                    startIcon={<SaveIcon />}\r\n                    fullWidth\r\n                  >\r\n                    {t('common.button.save')}\r\n                  </Button>\r\n                </Grid>\r\n                <Grid item xs={6} style={!data ? { display: 'none' } : undefined}>\r\n                  <Button onClick={handleDelete} variant=\"contained\" color=\"primary\" /*disabled={!data}*/ startIcon={<DeleteIcon />} fullWidth>\r\n                    {t('common.button.delete')}\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n            </Box>\r\n          </form>\r\n        </ThemeProvider>\r\n      </MyDialog>\r\n      <DeleteConfirmDialog open={delConfOpen} onClose={handleDelConfClose}></DeleteConfirmDialog>\r\n    </>\r\n  );\r\n}\r\n","import { Chip, makeStyles, createStyles } from '@material-ui/core';\r\nimport { EmailAddress } from '_models/User';\r\n\r\nconst useStyles = makeStyles((theme) =>\r\n  createStyles({\r\n    root: {\r\n      display: 'flex',\r\n      // justifyContent: 'center',\r\n      flexWrap: 'wrap',\r\n      '& > *': {\r\n        margin: theme.spacing(0.5),\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\ntype AddrBookUserDisplayProps = {\r\n  key: string;\r\n  data: EmailAddress[];\r\n};\r\n\r\nexport function AddrBookUserDisplay({ key, data }: AddrBookUserDisplayProps) {\r\n  const classes = useStyles();\r\n  return (\r\n    <div className={classes.root}>\r\n      {data.map((user, i) => (\r\n        <Chip key={`${key}-${i}`} label={user.name} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, List } from '@material-ui/core';\r\n\r\nimport { makeTableDialogStyle } from '_styles/TableTheme';\r\n\r\nimport { MyDialog } from '_components/MyDialog';\r\n\r\nimport { RowDataType } from './DataTableBase';\r\nimport { RoomReadFields } from './RoomReadFields';\r\nimport { AddrBookUserDisplay } from '_components/AddrBookUserDisplay';\r\n\r\nconst useRowDataDialogStyles = makeTableDialogStyle();\r\n\r\ntype RowDataReadDialogProps = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  data: RowDataType;\r\n};\r\n\r\nexport function RowDataReadDialog(props: RowDataReadDialogProps) {\r\n  const { open, onClose, data } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useRowDataDialogStyles();\r\n\r\n  // 会議メンバーではない場合、詳細表示NG\r\n  if (!data.isAttendees) {\r\n    return (\r\n      <MyDialog open={open} onClose={onClose} title={t('visitdialog.title')}>\r\n        {t('common.msg.authority-error')}\r\n      </MyDialog>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <MyDialog open={open} onClose={onClose} title={t('visitdialog.title')}>\r\n      <Box px={2} pt={2}>\r\n        <List disablePadding={true}>\r\n          <li key=\"event-subject\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.event-subject')}</div>\r\n            <div className={classes.field}>{data.subject}</div>\r\n          </li>\r\n          <li key=\"app-time\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.appt-time')}</div>\r\n            <div className={classes.field}>{data.apptTime}</div>\r\n          </li>\r\n          <li key=\"reservation-name\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.reservation-name')}</div>\r\n            <div className={classes.field}>{data.reservationName}</div>\r\n          </li>\r\n        </List>\r\n      </Box>\r\n\r\n      <Box px={2} pt={2}>\r\n        <List disablePadding={true}>\r\n          <li key=\"mailto-required\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.event-mailto-required')}</div>\r\n            <div className={classes.fieldSlim}>\r\n              <AddrBookUserDisplay key=\"mailto-required\" data={data.mailto.required} />\r\n            </div>\r\n          </li>\r\n          <li key=\"mailto-optional\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.event-mailto-optional')}</div>\r\n            <div className={classes.fieldSlim}>\r\n              <AddrBookUserDisplay key=\"mailto-optional\" data={data.mailto.optional} />\r\n            </div>\r\n          </li>\r\n        </List>\r\n      </Box>\r\n\r\n      {Object.keys(data.resourcies).map((roomId) => {\r\n        return <RoomReadFields key={roomId} data={data.resourcies[roomId]} /*hiddenTeaSupply={data.isMSMultipleLocations}*/ />;\r\n      })}\r\n\r\n      <Box px={2} pt={2} style={data.usageRange === 'inside' ? { display: 'none' } : undefined}>\r\n        <List disablePadding={true}>\r\n          <li key=\"visit-company\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.visit-company')}</div>\r\n            <div className={classes.field}>{data.visitCompany}</div>\r\n          </li>\r\n          <li key=\"visitor-name\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.visitor-name')}</div>\r\n            <div className={classes.field}>{data.visitorName}</div>\r\n          </li>\r\n        </List>\r\n      </Box>\r\n\r\n      <Box p={2} pt={2}>\r\n        <List disablePadding={true}>\r\n          <li key=\"comment\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.comment')}</div>\r\n            <div className={classes.field}>{data.comment}</div>\r\n          </li>\r\n          <li key=\"contact-addr\" className={classes.list}>\r\n            <div className={classes.title}>{t('visittable.header.contact-addr')}</div>\r\n            <div className={classes.field}>{data.contactAddr}</div>\r\n          </li>\r\n        </List>\r\n      </Box>\r\n    </MyDialog>\r\n  );\r\n}\r\n","import { ThemeProvider } from '@material-ui/core/styles';\r\n\r\nimport { VisitorInfo, VisitorInfoReadOnly } from '_models/VisitorInfo';\r\nimport { tableTheme } from '_styles/TableTheme';\r\nimport { Spinner } from '_components/Spinner';\r\n\r\nimport { AddDefaultType, RowDataInputDialog } from './RowDataInputDialog';\r\nimport { RowDataReadDialog } from './RowDataReadDialog';\r\n\r\nexport type RowDataType = VisitorInfo & VisitorInfoReadOnly;\r\n\r\nexport type DataDialogState = {\r\n  mode: 'rowData' | 'addData';\r\n  inputOpen: boolean;\r\n  readOpen: boolean;\r\n  addDefault?: AddDefaultType;\r\n};\r\n\r\nexport type DataDialogAction =\r\n  | {\r\n      type: 'inputOpen' | 'readOpen' | 'inputClose' | 'readClose';\r\n    }\r\n  | { type: 'addDataOpen'; addDefault?: AddDefaultType };\r\n\r\nexport const dataDialogReducer = (state: DataDialogState, action: DataDialogAction): DataDialogState => {\r\n  switch (action.type) {\r\n    case 'inputOpen':\r\n      return { mode: 'rowData', inputOpen: true, readOpen: false };\r\n    case 'addDataOpen':\r\n      return { mode: 'addData', inputOpen: true, readOpen: false, addDefault: action.addDefault };\r\n    case 'inputClose':\r\n      return { ...state, inputOpen: false };\r\n    case 'readOpen':\r\n      return { mode: 'rowData', inputOpen: false, readOpen: true };\r\n    case 'readClose':\r\n      return { ...state, readOpen: false };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\ntype DataTableBaseProps = {\r\n  currentRow: RowDataType | null;\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n  isLoading: boolean;\r\n  reload: () => void;\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport function DataTableBase(props: DataTableBaseProps) {\r\n  const { dataDialogHook, isLoading, reload, currentRow, children } = props;\r\n\r\n  // ダイアログを閉じる(input)\r\n  const handleInputDialogClose = async () => {\r\n    dataDialogHook.dispatch({ type: 'inputClose' });\r\n  };\r\n  // ダイアログを閉じる(read)\r\n  const handleReadDialogClose = async () => {\r\n    dataDialogHook.dispatch({ type: 'readClose' });\r\n  };\r\n\r\n  return (\r\n    <ThemeProvider theme={tableTheme}>\r\n      <Spinner open={isLoading} />\r\n      {children}\r\n      <RowDataInputDialog\r\n        open={dataDialogHook.state.inputOpen}\r\n        onClose={handleInputDialogClose}\r\n        data={dataDialogHook.state.mode === 'addData' ? null : currentRow}\r\n        reload={reload}\r\n        addDefault={dataDialogHook.state.addDefault}\r\n      />\r\n      {!!currentRow && <RowDataReadDialog open={dataDialogHook.state.readOpen} onClose={handleReadDialogClose} data={currentRow} />}\r\n    </ThemeProvider>\r\n  );\r\n}\r\n","import { useCallback, useState } from 'react';\r\nimport { useRouteMatch } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport MaterialTable, { MTableCell } from '@material-table/core';\r\n\r\nimport { tableIcons, pageingOntions } from '_utils/MaterialTableIcons';\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\nimport { LocationParams } from '_models/Location';\r\nimport { cellStyle, makeVisitorTableStyles } from '_styles/VisitorTableStyle';\r\nimport { tableTheme } from '_styles/TableTheme';\r\n\r\nimport { DataDialogAction, DataDialogState, DataTableBase, RowDataType } from '../DataTableBase';\r\n\r\nconst useStyles = makeVisitorTableStyles();\r\n\r\nexport type Columns = {\r\n  title: string;\r\n  field: string;\r\n};\r\n\r\ntype DataTableProps = {\r\n  currentDate: Date;\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n};\r\n\r\nexport function DataTable(props: DataTableProps) {\r\n  const { currentDate, dataDialogHook } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // データ取得\r\n  const [{ data, isLoading, isError }, reload] = useLoadData<RowDataType[]>(\r\n    `/event/visitlist?timestamp=${currentDate!.getTime()}&location=${match.params.location}`,\r\n    []\r\n  );\r\n\r\n  // 選択行の状態\r\n  const [currentRow, setCurrentRow] = useState<RowDataType | null>(null);\r\n\r\n  // ダイアログを開く\r\n  const handleDialogOpen = useCallback(\r\n    (selectedRow: RowDataType) => {\r\n      if (selectedRow.isAuthor) {\r\n        dataDialogHook.dispatch({ type: 'inputOpen' });\r\n      } else {\r\n        dataDialogHook.dispatch({ type: 'readOpen' });\r\n      }\r\n      setCurrentRow(selectedRow);\r\n    },\r\n    [dataDialogHook]\r\n  );\r\n\r\n  const columns: Columns[] = [\r\n    { title: t('visittable.header.appt-time'), field: 'apptTime' },\r\n    { title: t('visittable.header.room-name'), field: 'roomName' },\r\n    { title: t('visittable.header.event-subject'), field: 'subject' },\r\n    { title: t('visittable.header.visit-company'), field: 'visitCompany' },\r\n    { title: t('visittable.header.reservation-name'), field: 'reservationName' },\r\n  ];\r\n\r\n  // データ取得失敗した場合\r\n  if (isError) {\r\n    return <div>{t('common.msg.fetch-failed')}</div>;\r\n  }\r\n\r\n  return (\r\n    <DataTableBase currentRow={currentRow} dataDialogHook={dataDialogHook} isLoading={isLoading} reload={reload}>\r\n      <MaterialTable\r\n        columns={columns}\r\n        components={{\r\n          // Row: (props) => <MTableBodyRow {...props} className={rowStyle(props.data)} />,\r\n          Cell: (props) => <MTableCell {...props} className={cellStyle(props.columnDef.field, props.rowData, classes)} />,\r\n        }}\r\n        data={data!}\r\n        onRowClick={(_event, selectedRow?) => !!selectedRow && handleDialogOpen(selectedRow)}\r\n        options={{\r\n          showTitle: false,\r\n          toolbar: false,\r\n          search: false,\r\n          headerStyle: { backgroundColor: tableTheme.palette.primary.light },\r\n          tableLayout: 'fixed',\r\n          ...pageingOntions,\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n    </DataTableBase>\r\n  );\r\n}\r\n","import { makeStyles } from '@material-ui/core';\r\nimport { KeyboardDatePicker } from '@material-ui/pickers';\r\n\r\nconst useStyles = makeStyles({\r\n  keyboardDatePicker: {\r\n    '& .MuiOutlinedInput-adornedEnd': { paddingRight: 0 },\r\n  },\r\n});\r\n\r\ntype MyCalendarProps = {\r\n  label: string;\r\n  date: Date | null;\r\n  onChange: (date: Date | null) => void;\r\n};\r\n\r\nfunction MyCalendar({ label, date, onChange }: MyCalendarProps) {\r\n  const classes = useStyles();\r\n  return (\r\n    <KeyboardDatePicker\r\n      margin=\"normal\"\r\n      id=\"date-picker-dialog\"\r\n      label={label}\r\n      format=\"yyyy/MM/dd\"\r\n      showTodayButton\r\n      value={date}\r\n      onChange={onChange}\r\n      KeyboardButtonProps={{\r\n        'aria-label': 'change date',\r\n      }}\r\n      size=\"small\"\r\n      className={classes.keyboardDatePicker}\r\n      inputProps={{\r\n        style: {\r\n          width: 85,\r\n        },\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nexport default MyCalendar;\r\n","import { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Button, Grid, makeStyles, Typography } from '@material-ui/core';\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\n\r\nimport MyCalendar from '_components/MyCalendar';\r\nimport { DataDialogAction } from './DataTableBase';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  datePicker: {\r\n    margin: 'auto 0',\r\n  },\r\n  title: {\r\n    margin: 'auto 0.25em',\r\n  },\r\n}));\r\n\r\ntype HeaderActionsProps = {\r\n  title: string;\r\n  subtitle?: string;\r\n  date: Date | null;\r\n  onDateChange: (date: Date | null) => void;\r\n  dispatch: React.Dispatch<DataDialogAction>;\r\n  actionButtons?: React.ReactNode[];\r\n};\r\n\r\nexport function HeaderActions(props: HeaderActionsProps) {\r\n  const { title, subtitle, date, onDateChange, dispatch, actionButtons } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n\r\n  // 新規作成ボタン\r\n  const handleCreateClick = (_event: React.ChangeEvent<{}>) => {\r\n    dispatch({ type: 'addDataOpen' });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Grid container alignItems=\"stretch\" justifyContent=\"space-between\">\r\n        <Grid container item xs={12} sm={!!actionButtons ? 6 : 9}>\r\n          <Grid item className={classes.datePicker}>\r\n            <MyCalendar label={t('main.header.picker-label')} date={date} onChange={onDateChange} />\r\n          </Grid>\r\n          <Grid item className={classes.title}>\r\n            <Typography component=\"h5\">{title}</Typography>\r\n          </Grid>\r\n        </Grid>\r\n\r\n        <Grid container item justifyContent=\"flex-end\" alignItems=\"center\" spacing={2} xs={12} sm={!!actionButtons ? 6 : 3}>\r\n          {!!actionButtons &&\r\n            actionButtons.map((item, index) => {\r\n              return (\r\n                <Grid item key={`actionButtons-${index}`}>\r\n                  {item}\r\n                </Grid>\r\n              );\r\n            })}\r\n          <Grid item>\r\n            <Button variant=\"contained\" color=\"secondary\" startIcon={<AddCircleIcon />} onClick={handleCreateClick}>\r\n              {t('main.header.add-event')}\r\n            </Button>\r\n          </Grid>\r\n        </Grid>\r\n\r\n        <Box pt={1}>{subtitle}</Box>\r\n      </Grid>\r\n    </>\r\n  );\r\n}\r\n","import { useEffect, useReducer, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Paper } from '@material-ui/core';\r\n\r\nimport BaseTemplate from '../../_components/BaseTemplate';\r\nimport { useSelectedDate } from '_utils/useSelectedDate';\r\nimport { getReloadState, getReloadStateFlg, removeReloadStateFlg } from '_utils/SessionStrage';\r\n\r\nimport { DataTable } from './DataTable';\r\nimport { dataDialogReducer, DataDialogState } from '../DataTableBase';\r\nimport { HeaderActions } from '../HeaderActions';\r\n\r\nexport function VisitList() {\r\n  const { t } = useTranslation();\r\n\r\n  // isCreatedOnlyの状態\r\n  const [createdOnly, setCreatedOnly] = useState(false);\r\n  useEffect(() => {\r\n    setCreatedOnly(false); // TODO: production.jsの値を反映\r\n  }, []);\r\n\r\n  // カレンダー選択日の状態\r\n  const [selectedDate, setSelectedDate] = useSelectedDate();\r\n  const handleDateChange = (date: Date | null) => {\r\n    setSelectedDate(date);\r\n  };\r\n\r\n  // ダイアログの初期値\r\n  const initialState: DataDialogState = {\r\n    mode: 'addData',\r\n    inputOpen: false,\r\n    readOpen: false,\r\n  };\r\n  // ダイアログの状態\r\n  const [dataDialogState, dataDialogDispatch] = useReducer(dataDialogReducer, initialState);\r\n\r\n  // ================================\r\n  // refreshボタンによるreload\r\n  useEffect(() => {\r\n    if (!!getReloadStateFlg()) {\r\n      setSelectedDate(new Date(Number(getReloadState('selectedDate'))));\r\n      removeReloadStateFlg();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n  // ================================\r\n\r\n  return (\r\n    <BaseTemplate>\r\n      <Paper square>\r\n        <Box p={2}>\r\n          <HeaderActions\r\n            title={t('main.visitlist.title')}\r\n            subtitle={t(`main.visitlist.subtitle${createdOnly ? '.created-only' : ''}`)}\r\n            date={selectedDate}\r\n            onDateChange={handleDateChange}\r\n            dispatch={dataDialogDispatch}\r\n          />\r\n        </Box>\r\n        <Box px={2} pb={2}>\r\n          <DataTable currentDate={selectedDate!} dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }} />\r\n        </Box>\r\n      </Paper>\r\n    </BaseTemplate>\r\n  );\r\n}\r\n","import { Fragment, useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { Tooltip, Typography, Button } from '@material-ui/core';\r\nimport { makeStyles, createStyles, withStyles } from '@material-ui/core/styles';\r\n\r\nimport { differenceInMinutes, endOfDay, isAfter, isBefore, isSameDay, startOfDay } from 'date-fns';\r\nimport _ from 'lodash';\r\nimport clsx from 'clsx';\r\n\r\nimport { Schedule, ScheduleItem } from '_models/Schedule';\r\nimport { UsageRangeForVisitor } from '_models/Room';\r\n\r\nimport { DataDialogAction, DataDialogState, RowDataType } from 'main/DataTableBase';\r\n\r\ntype Point = {\r\n  x: number;\r\n  y: number;\r\n};\r\n\r\ntype BoxStyle = {\r\n  width: number;\r\n  halfWidth: number;\r\n  scale: number;\r\n  transform: Point;\r\n};\r\n\r\ntype BoxData = {\r\n  x: number;\r\n  width: number;\r\n  className: string;\r\n};\r\n\r\n// 8-20\r\nconst shortStyle: BoxStyle = {\r\n  width: 120,\r\n  halfWidth: 60,\r\n  scale: 2,\r\n  transform: { x: -960, y: 0 },\r\n};\r\n// 0-24\r\nconst longStyle: BoxStyle = {\r\n  width: 60,\r\n  halfWidth: 30,\r\n  scale: 1,\r\n  transform: { x: 0, y: 0 },\r\n};\r\n\r\nconst viewWidth = 60 * 24;\r\nconst viewHeight = 70;\r\nconst viewWidthMargin = 1; // lineの一番両端が身切れして他のlineより細くなる現象を避けるため\r\nconst viewWidthWrap = viewWidth + viewWidthMargin * 2;\r\nconst fontHeight = 30;\r\nconst fontMargin = 5;\r\n\r\nconst timeToPoint = (time: Date, boxStyle: BoxStyle) => {\r\n  const zero = startOfDay(time);\r\n  return differenceInMinutes(time, zero) * boxStyle.scale;\r\n};\r\n\r\nconst pointToTime = (point: number, boxStyle: BoxStyle) => {\r\n  const offset = 0;\r\n  return ((point + offset) / boxStyle.scale) * 60 * 1000;\r\n};\r\n\r\nconst getBoxData = (item: ScheduleItem, boxStyle: BoxStyle, currentDate: Date): BoxData => {\r\n  const start = new Date(item.start);\r\n  const end = new Date(item.end);\r\n  let x = timeToPoint(start, boxStyle);\r\n  let x2 = timeToPoint(end, boxStyle);\r\n  // 日を跨ぐ場合\r\n  if (!isSameDay(start, end)) {\r\n    const startOfCurrent = startOfDay(currentDate);\r\n    const endOfCurrent = endOfDay(currentDate);\r\n    // 翌日に続く\r\n    if (isBefore(endOfCurrent, end)) {\r\n      x2 = timeToPoint(endOfCurrent, boxStyle);\r\n    }\r\n    // 前日から続いている\r\n    if (isAfter(startOfCurrent, start)) {\r\n      x = timeToPoint(startOfCurrent, boxStyle);\r\n    }\r\n  }\r\n  return {\r\n    x: x,\r\n    width: x2 - x,\r\n    className: item.status,\r\n  };\r\n};\r\n\r\nconst calcX = (hour: number, width: number) => (hour + 1) * width + viewWidthMargin;\r\n\r\nconst createTransform = (boxStyle: BoxStyle) => {\r\n  return `translate(${boxStyle.transform.x},${boxStyle.transform.y})`;\r\n};\r\n\r\nconst HtmlTooltip = withStyles((theme) => ({\r\n  tooltip: {\r\n    backgroundColor: theme.palette.grey[100],\r\n    color: theme.palette.text.primary,\r\n    maxWidth: 220,\r\n    fontSize: theme.typography.pxToRem(12),\r\n    border: `1px solid ${theme.palette.grey[300]}`,\r\n  },\r\n}))(Tooltip);\r\n\r\nconst useStyles = makeStyles((theme) =>\r\n  createStyles({\r\n    container: {\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      marginBottom: '0.5rem',\r\n      // height: '5vmin',\r\n      '& svg': {\r\n        fontSize: '1.5rem',\r\n        '& line': {\r\n          strokeWidth: 2,\r\n        },\r\n        '& line.hour-line': {\r\n          stroke: theme.palette.grey[400],\r\n        },\r\n        '& line.hour-half-line': {\r\n          stroke: theme.palette.grey[300],\r\n        },\r\n        '& text': {\r\n          fill: theme.palette.grey[400],\r\n        },\r\n        '& text.subject': {\r\n          fill: '#fff',\r\n          fontSize: '1.2rem',\r\n          dominantBaseline: 'central',\r\n          cursor: 'pointer',\r\n        },\r\n        '& rect': {\r\n          strokeWidth: 1,\r\n          fillOpacity: 0.5,\r\n        },\r\n        '& rect.new-event-bar': {\r\n          fillOpacity: 0,\r\n        },\r\n        '& rect.event': {\r\n          stroke: theme.palette.success.main,\r\n          fill: theme.palette.success.light,\r\n          fillOpacity: 0.9,\r\n          cursor: 'pointer',\r\n        },\r\n        '& rect.myOwn': {\r\n          stroke: theme.palette.info.main,\r\n          fill: theme.palette.info.light,\r\n        },\r\n        '& rect.wait': {\r\n          stroke: theme.palette.warning.light,\r\n          fill: theme.palette.warning.main,\r\n        },\r\n        '& rect.busy': {\r\n          stroke: theme.palette.error.light,\r\n          fill: theme.palette.error.main,\r\n        },\r\n      },\r\n    },\r\n    title: {\r\n      // color: theme.palette.grey[500],\r\n      fontSize: '1rem',\r\n      paddingBottom: 0,\r\n    },\r\n  })\r\n);\r\n\r\ntype TimeBarProps = {\r\n  // rangesw: BoxStyle;\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n  schedule: Schedule;\r\n  events: RowDataType[][];\r\n  onClickCallback: (rowData: RowDataType) => void;\r\n  keyLabel: string; //schedule.roomName\r\n  keyValue: string; //schedule.roomEmail\r\n  onTitleClick: (timestamp: number, categoryId: string, roomId: string) => void;\r\n};\r\n\r\nexport function TimeBar(props: TimeBarProps) {\r\n  const { dataDialogHook, schedule, events, onClickCallback, keyLabel, keyValue, onTitleClick } = props;\r\n  const classes = useStyles();\r\n\r\n  const [boxStyle, setBoxStyle] = useState(shortStyle);\r\n  const [transform, setTransform] = useState(createTransform(boxStyle));\r\n\r\n  // useEffect(() => {\r\n  //   setBoxStyle(rangesw ? longStyle : shortStyle);\r\n  // }, [rangesw]);\r\n\r\n  useEffect(() => {\r\n    setTransform(createTransform(boxStyle));\r\n  }, [boxStyle, events]);\r\n\r\n  const hRatio = 1;\r\n  const rectY = fontHeight + (viewHeight - fontHeight) * (1 - hRatio) + 1;\r\n  const rectHeight = (viewHeight - fontHeight) * hRatio - 1;\r\n  const viewHeightDup = schedule.type === 'free' ? viewHeight + rectHeight * (schedule.scheduleItems.length - 1) + rectHeight : viewHeight;\r\n\r\n  // スケジュール枠の作成\r\n  const createScheduleBox = useCallback(\r\n    (item: ScheduleItem, index: number, timestamp: number, rowIndex: number) => {\r\n      const boxData = getBoxData(item, boxStyle, new Date(timestamp));\r\n      return (\r\n        <rect\r\n          key={`${keyValue}-sc-${index}`}\r\n          className={boxData.className}\r\n          x={boxData.x}\r\n          y={rectY + rectHeight * rowIndex}\r\n          width={boxData.width}\r\n          height={rectHeight}\r\n          rx={3}\r\n          ry={5}\r\n        ></rect>\r\n      );\r\n    },\r\n    [boxStyle, keyValue, rectY, rectHeight]\r\n  );\r\n\r\n  // イベント枠の作成 (textのoverflow:hiddenっぽくするためにsvgの入れ子で作成)\r\n  const createEventBox = useCallback(\r\n    (event: RowDataType, index: number, timestamp: number, rowIndex: number) => {\r\n      const item: ScheduleItem = { status: 'event', start: event.startDateTime, end: event.endDateTime };\r\n      const boxData = getBoxData(item, boxStyle, new Date(timestamp));\r\n      const x = boxData.x;\r\n      const y = rectY + rectHeight * rowIndex;\r\n      const width = boxData.width;\r\n      const height = rectHeight;\r\n      const myEvent = event.isAttendees ? 'myOwn' : '';\r\n      return (\r\n        <HtmlTooltip\r\n          key={`${keyValue}-ev-${index}`}\r\n          title={\r\n            <>\r\n              <Typography variant=\"body2\">{event.subject}</Typography>\r\n              <em>{event.apptTime}</em> <b>{event.reservationName}</b>\r\n            </>\r\n          }\r\n          onClick={() => {\r\n            onClickCallback(event);\r\n          }}\r\n        >\r\n          <svg x={x} y={y} width={width} height={height} viewBox={`0 0 ${width} ${height}`}>\r\n            <g>\r\n              <rect className={clsx(boxData.className, myEvent)} x={0} y={0} width={width} height={height} rx={3} ry={5}></rect>\r\n              <text className=\"subject\" x={3} y={'50%'}>\r\n                {event.subject}\r\n              </text>\r\n            </g>\r\n          </svg>\r\n        </HtmlTooltip>\r\n      );\r\n    },\r\n    [boxStyle, rectY, rectHeight, keyValue, onClickCallback]\r\n  );\r\n\r\n  // 新規作成ボタン(開始時間の指定あり)\r\n  const handleCreateClick = (\r\n    event: React.MouseEvent<SVGRectElement, MouseEvent>,\r\n    timestamp: number,\r\n    roomId: string,\r\n    usageRange: UsageRangeForVisitor\r\n  ) => {\r\n    const svg: SVGSVGElement | null = event.currentTarget.closest('svg');\r\n    if (!svg) return;\r\n\r\n    const pt = svg.createSVGPoint();\r\n    pt.x = event.clientX;\r\n    pt.y = event.clientY;\r\n    const ctm = svg.getScreenCTM();\r\n    if (!ctm) return;\r\n\r\n    const svgP = pt.matrixTransform(ctm.inverse());\r\n    const rectX = svgP.x - boxStyle.transform.x + viewWidthMargin;\r\n    const $time = pointToTime(rectX, boxStyle);\r\n    const time = Math.floor($time / 1000 / 60 / 30) * 1000 * 60 * 30; //TODO: Interval config化？\r\n    const start = new Date(startOfDay(timestamp).getTime() + time);\r\n\r\n    dataDialogHook.dispatch({ type: 'addDataOpen', addDefault: { start: start, roomId: roomId, usageRange: usageRange } });\r\n  };\r\n\r\n  // スケジュール枠の表示（不要レンダリングが起きるためメモ化）\r\n  const rectSchedules = useMemo(() => {\r\n    return <>{schedule.scheduleItems.map((row, rowIndex) => row.map((item, index) => createScheduleBox(item, index, schedule.date, rowIndex)))}</>;\r\n  }, [createScheduleBox, schedule]);\r\n\r\n  // イベント枠の表示（不要レンダリングが起きるためメモ化）\r\n  const rectEvents = useMemo(() => {\r\n    return <>{events.map((row, rowIndex) => row.map((event, index) => createEventBox(event, index, schedule.date, rowIndex)))}</>;\r\n  }, [createEventBox, events, schedule]);\r\n\r\n  return (\r\n    <>\r\n      {/* <Typography className={classes.title}>{keyLabel}</Typography> */}\r\n      <Button\r\n        color=\"secondary\"\r\n        className={classes.title}\r\n        size=\"small\"\r\n        onClick={() => onTitleClick(schedule.date, schedule.categoryId, schedule.roomId)}\r\n      >\r\n        {keyLabel}\r\n      </Button>\r\n      <div className={classes.container}>\r\n        <svg viewBox={`0 0 ${viewWidthWrap} ${viewHeightDup}`} preserveAspectRatio=\"none\">\r\n          <g transform={transform}>\r\n            <line className=\"hour-line\" x1={0} y1={0} x2={0} y2={viewHeightDup}></line>\r\n            <line className=\"hour-half-line\" x1={boxStyle.halfWidth} y1={fontHeight} x2={boxStyle.halfWidth} y2={viewHeightDup}></line>\r\n            {_.range(0, 24).map(($) => {\r\n              const x = calcX($, boxStyle.width);\r\n              const minX = x + boxStyle.halfWidth;\r\n              const fontX = $ * boxStyle.width + fontMargin;\r\n              return (\r\n                <Fragment key={`fragment-${$}`}>\r\n                  <line key={`hour-line-${$}`} className=\"hour-line\" x1={x} y1={0} x2={x} y2={viewHeightDup}></line>\r\n                  <line key={`hour-half-line-${$}`} className=\"hour-half-line\" x1={minX} y1={fontHeight} x2={minX} y2={viewHeightDup}></line>\r\n                  <text key={`hour-text-${$}`} x={fontX} y={fontHeight - 5}>\r\n                    {$}\r\n                  </text>\r\n                </Fragment>\r\n              );\r\n            })}\r\n            <rect\r\n              className=\"new-event-bar\"\r\n              x={0}\r\n              y={rectY}\r\n              width={calcX(24, boxStyle.width)}\r\n              height={viewHeightDup - rectY}\r\n              onClick={(e) => handleCreateClick(e, schedule.date, schedule.roomId, schedule.usageRange)}\r\n            ></rect>\r\n            {rectSchedules}\r\n            {rectEvents}\r\n          </g>\r\n        </svg>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n","import { useCallback, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useRouteMatch } from 'react-router-dom';\r\n\r\nimport { LocationParams } from '_models/Location';\r\nimport { Schedule } from '_models/Schedule';\r\n\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\nimport { DataDialogAction, DataDialogState, DataTableBase, RowDataType } from '../DataTableBase';\r\nimport { TimeBar } from '../TimeBar';\r\n\r\ntype TimeBarDataType = {\r\n  events: RowDataType[];\r\n  schedules: Schedule[];\r\n};\r\n\r\ntype DataTableProps = {\r\n  currentDate: Date;\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n  tabKey: string;\r\n  onTitleClick: (timestamp: number, categoryId: string, roomId: string) => void;\r\n};\r\n\r\nexport function DataTable(props: DataTableProps) {\r\n  const { currentDate, dataDialogHook, tabKey, onTitleClick } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // データ取得\r\n  const [{ data, isLoading, isError }, reload] = useLoadData<TimeBarDataType>(\r\n    `/event/byroom?timestamp=${currentDate!.getTime()}&location=${match.params.location}&category=${tabKey}`,\r\n    undefined\r\n  );\r\n\r\n  // 選択行の状態\r\n  const [currentRow, setCurrentRow] = useState<RowDataType | null>(null);\r\n\r\n  // ダイアログを開く\r\n  const handleDialogOpen = useCallback(\r\n    (selectedRow: RowDataType) => {\r\n      if (selectedRow.isAuthor) {\r\n        dataDialogHook.dispatch({ type: 'inputOpen' });\r\n      } else {\r\n        dataDialogHook.dispatch({ type: 'readOpen' });\r\n      }\r\n      setCurrentRow(selectedRow);\r\n    },\r\n    [dataDialogHook]\r\n  );\r\n\r\n  // タイムバーの表示（不要レンダリングが起きるためメモ化）\r\n  const timeBars = useMemo(() => {\r\n    if (!data) return <></>;\r\n    return (\r\n      <>\r\n        {data.schedules.map((schedule, sIdx) => (\r\n          <TimeBar\r\n            key={sIdx}\r\n            dataDialogHook={dataDialogHook}\r\n            schedule={schedule}\r\n            events={schedule.eventsIndex.map((row) => row.map((eventIndex) => data!.events[eventIndex]))}\r\n            onClickCallback={handleDialogOpen}\r\n            keyLabel={schedule.roomName}\r\n            keyValue={schedule.roomEmail}\r\n            onTitleClick={onTitleClick}\r\n          ></TimeBar>\r\n        ))}\r\n      </>\r\n    );\r\n  }, [data, dataDialogHook, handleDialogOpen, onTitleClick]);\r\n\r\n  // データ取得失敗した場合\r\n  if (isError) {\r\n    return <div>{t('common.msg.fetch-failed')}</div>;\r\n  }\r\n\r\n  return (\r\n    <DataTableBase currentRow={currentRow} dataDialogHook={dataDialogHook} isLoading={isLoading} reload={reload}>\r\n      {timeBars}\r\n    </DataTableBase>\r\n  );\r\n}\r\n","import { MuiPickersContext } from '@material-ui/pickers';\r\nimport { format } from 'date-fns';\r\nimport { useCallback, useContext, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useRouteMatch } from 'react-router-dom';\r\n\r\nimport { LocationParams } from '_models/Location';\r\nimport { Schedule } from '_models/Schedule';\r\n\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\nimport { DataDialogAction, DataDialogState, DataTableBase, RowDataType } from '../DataTableBase';\r\nimport { TimeBar } from '../TimeBar';\r\n\r\ntype TimeBarDataType = {\r\n  events: RowDataType[];\r\n  schedules: Schedule[];\r\n};\r\n\r\ntype DataTableProps = {\r\n  currentDate: Date;\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n  tabKey: string;\r\n  onTitleClick: (timestamp: number, categoryId: string, roomId: string) => void;\r\n};\r\n\r\nexport function DataTableWeekly(props: DataTableProps) {\r\n  const { currentDate, dataDialogHook, tabKey, onTitleClick } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const match = useRouteMatch<LocationParams>();\r\n  const muiPickContext = useContext(MuiPickersContext); // locale取得用\r\n\r\n  // データ取得\r\n  const [{ data, isLoading, isError }, reload] = useLoadData<TimeBarDataType>(\r\n    `/event/byroom/weekly?timestamp=${currentDate!.getTime()}&location=${match.params.location}&room=${tabKey}`,\r\n    undefined\r\n  );\r\n\r\n  // 選択行の状態\r\n  const [currentRow, setCurrentRow] = useState<RowDataType | null>(null);\r\n\r\n  // ダイアログを開く\r\n  const handleDialogOpen = useCallback(\r\n    (selectedRow: RowDataType) => {\r\n      if (selectedRow.isAuthor) {\r\n        dataDialogHook.dispatch({ type: 'inputOpen' });\r\n      } else {\r\n        dataDialogHook.dispatch({ type: 'readOpen' });\r\n      }\r\n      setCurrentRow(selectedRow);\r\n    },\r\n    [dataDialogHook]\r\n  );\r\n\r\n  // タイムバーの表示（不要レンダリングが起きるためメモ化）\r\n  const timeBars = useMemo(() => {\r\n    if (!data) return <></>;\r\n    return (\r\n      <>\r\n        {data.schedules.map((schedule, sIdx) => (\r\n          <TimeBar\r\n            key={sIdx}\r\n            dataDialogHook={dataDialogHook}\r\n            schedule={schedule}\r\n            events={schedule.eventsIndex.map((row) => row.map((eventIndex) => data!.events[eventIndex]))}\r\n            onClickCallback={handleDialogOpen}\r\n            keyLabel={format(schedule.date, 'yyyy/MM/dd (E)', { locale: muiPickContext?.locale })}\r\n            keyValue={schedule.date.toString()}\r\n            onTitleClick={onTitleClick}\r\n          ></TimeBar>\r\n        ))}\r\n      </>\r\n    );\r\n  }, [data, dataDialogHook, handleDialogOpen, muiPickContext?.locale, onTitleClick]);\r\n\r\n  // データ取得失敗した場合\r\n  if (isError) {\r\n    return <div>{t('common.msg.fetch-failed')}</div>;\r\n  }\r\n\r\n  return (\r\n    <DataTableBase currentRow={currentRow} dataDialogHook={dataDialogHook} isLoading={isLoading} reload={reload}>\r\n      {timeBars}\r\n    </DataTableBase>\r\n  );\r\n}\r\n","import { cloneElement, useEffect, useMemo, useState } from 'react';\r\n\r\nimport { AppBar, Tab } from '@material-ui/core';\r\nimport { TabContext, TabList, TabPanel } from '@material-ui/lab';\r\n\r\nimport { getReloadStateFlg, saveReloadState } from '_utils/SessionStrage';\r\n\r\ninterface TabModel {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\ntype MyTabContextProps<T extends TabModel> = {\r\n  data: Array<T>;\r\n  tabPanelContent: React.ReactElement;\r\n  selected?: string;\r\n};\r\n\r\nexport function MyTabContext<T extends TabModel>(props: MyTabContextProps<T>) {\r\n  const { data, tabPanelContent, selected } = props;\r\n\r\n  // タブパネルとタブリストの描画が揃ってから表示するための制御\r\n  const [activateTab, setActivateTab] = useState(false);\r\n  useEffect(() => setActivateTab(true), []);\r\n\r\n  // タブの状態\r\n  const [tabValue, setTabValue] = useState('');\r\n\r\n  // タブの自動選択\r\n  useEffect(() => {\r\n    if (!!selected) {\r\n      setTabValue(selected);\r\n    } else {\r\n      setTabValue(data[0].id);\r\n    }\r\n  }, [data, selected]);\r\n\r\n  // ================================\r\n  // ReloadStateStrageの設定\r\n  useEffect(() => {\r\n    if (!getReloadStateFlg()) {\r\n      saveReloadState('tabValue', tabValue);\r\n    }\r\n  }, [tabValue]);\r\n  // ================================\r\n\r\n  // タブ切り替えアクション\r\n  const handleTabChange = (_event: React.ChangeEvent<{}>, newValue: string) => {\r\n    setTabValue(newValue);\r\n  };\r\n\r\n  // タブリストの表示（不要レンダリングが起きるためメモ化）\r\n  const tabList = useMemo(() => {\r\n    return (\r\n      <TabList indicatorColor=\"primary\" textColor=\"primary\" variant=\"scrollable\" onChange={handleTabChange} aria-label=\"view tabs\">\r\n        {data?.map((item, index) => (\r\n          <Tab key={`tab-${index}`} label={item.name} value={`${item.id}`} />\r\n        ))}\r\n      </TabList>\r\n    );\r\n  }, [data]);\r\n\r\n  // タブパネルの表示（不要レンダリングが起きるためメモ化）\r\n  const tabPanels = useMemo(() => {\r\n    return (\r\n      <>\r\n        {data?.map((item, index) => {\r\n          return (\r\n            <TabPanel key={`tab-panel-${index}`} value={`${item.id}`}>\r\n              {cloneElement(tabPanelContent, { tabKey: item.id })}\r\n            </TabPanel>\r\n          );\r\n        })}\r\n      </>\r\n    );\r\n  }, [data, tabPanelContent]);\r\n\r\n  if (!activateTab) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <TabContext value={tabValue}>\r\n      <AppBar position=\"static\" color=\"default\">\r\n        {tabList}\r\n      </AppBar>\r\n      {tabPanels}\r\n    </TabContext>\r\n  );\r\n}\r\n","import { useRouteMatch } from 'react-router-dom';\r\nimport { LocationParams } from '_models/Location';\r\nimport { Category } from '_models/Category';\r\nimport { useLoadData } from '_utils/useLoadData';\r\nimport { MyTabContext } from '_components/MyTabContext';\r\n\r\ntype CategoryTabContextProps = {\r\n  tabPanelContent: React.ReactElement;\r\n  selected?: string;\r\n};\r\n\r\nexport function CategoryTabContext(props: CategoryTabContextProps) {\r\n  const { tabPanelContent, selected } = props;\r\n\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // カテゴリ取得\r\n  const [{ data }] = useLoadData<Category[]>(`/category/choices?location=${match.params.location}`, []);\r\n\r\n  return <>{!!data?.length && <MyTabContext data={data} tabPanelContent={tabPanelContent} selected={selected} />}</>;\r\n}\r\n","import { useRouteMatch } from 'react-router-dom';\r\n\r\nimport { LocationParams } from '_models/Location';\r\nimport { Room, RoomType } from '_models/Room';\r\n\r\nimport { useLoadData } from '_utils/useLoadData';\r\nimport { MyTabContext } from '_components/MyTabContext';\r\n\r\ntype RoomTabContextProps = {\r\n  tabPanelContent: React.ReactElement;\r\n  selected?: string;\r\n  type?: RoomType;\r\n};\r\n\r\nexport function RoomTabContext(props: RoomTabContextProps) {\r\n  const { tabPanelContent, type, selected } = props;\r\n\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  const typeQuery = !!type ? `&type=${type}` : '';\r\n\r\n  // カテゴリ取得\r\n  const [{ data }] = useLoadData<Room[]>(`/room/choices?location=${match.params.location}${typeQuery}`, []);\r\n\r\n  return <>{!!data?.length && <MyTabContext data={data} tabPanelContent={tabPanelContent} selected={selected} />}</>;\r\n}\r\n","import { useEffect, useReducer } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Paper } from '@material-ui/core';\r\n\r\nimport BaseTemplate from '../../_components/BaseTemplate';\r\nimport { useSelectedDate } from '_utils/useSelectedDate';\r\nimport { getReloadState, getReloadStateFlg, removeReloadStateFlg, saveReloadState } from '_utils/SessionStrage';\r\n\r\nimport { DataTable } from './DataTable';\r\nimport { DataTableWeekly } from './DataTableWeekly';\r\nimport { dataDialogReducer, DataDialogState } from '../DataTableBase';\r\nimport { HeaderActions } from '../HeaderActions';\r\nimport { CategoryTabContext } from '../CategoryTabContext';\r\nimport { RoomTabContext } from 'main/RoomTabContext';\r\n\r\nexport type ByRoomState = {\r\n  weekly: boolean;\r\n  changeTab: string | undefined;\r\n  titleLabel: string;\r\n  subtitleLabel: string;\r\n};\r\n\r\nexport type ByRoomAction = {\r\n  type: 'default' | 'weekly';\r\n  changeTab: string;\r\n};\r\n\r\nexport const byRoomReducer = (state: ByRoomState, action: ByRoomAction) => {\r\n  switch (action.type) {\r\n    case 'default':\r\n      return { weekly: false, changeTab: action.changeTab, titleLabel: 'main.byroom.title', subtitleLabel: 'main.byroom.subtitle' };\r\n    case 'weekly':\r\n      return {\r\n        weekly: true,\r\n        changeTab: action.changeTab,\r\n        titleLabel: 'main.byroom-weekly.title',\r\n        subtitleLabel: 'main.byroom-weekly.subtitle',\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport function ByRoom() {\r\n  const { t } = useTranslation();\r\n\r\n  // カレンダー選択日の状態\r\n  const [selectedDate, setSelectedDate] = useSelectedDate();\r\n  const handleDateChange = (date: Date | null) => {\r\n    setSelectedDate(date);\r\n  };\r\n\r\n  // ダイアログの初期値\r\n  const initialState: DataDialogState = {\r\n    mode: 'addData',\r\n    inputOpen: false,\r\n    readOpen: false,\r\n  };\r\n  // ダイアログの状態\r\n  const [dataDialogState, dataDialogDispatch] = useReducer(dataDialogReducer, initialState);\r\n\r\n  // １週間表示切替えの状態管理\r\n  const [byRoomState, byRoomDispatch] = useReducer(byRoomReducer, {\r\n    weekly: false,\r\n    changeTab: undefined,\r\n    titleLabel: 'main.byroom.title',\r\n    subtitleLabel: 'main.byroom.subtitle',\r\n  });\r\n\r\n  // ================================\r\n  // refreshボタンによるreload\r\n  useEffect(() => {\r\n    if (!!getReloadStateFlg()) {\r\n      setSelectedDate(new Date(Number(getReloadState('selectedDate'))));\r\n      byRoomDispatch({ type: !!getReloadState('weekly') ? 'weekly' : 'default', changeTab: getReloadState('tabValue') });\r\n      removeReloadStateFlg();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n  // ReloadStateStrageの設定\r\n  useEffect(() => {\r\n    if (!getReloadStateFlg()) {\r\n      saveReloadState('weekly', byRoomState.weekly ? '1' : '');\r\n    }\r\n  }, [byRoomState.weekly]);\r\n  // ================================\r\n\r\n  // デフォルト → １週間表示へ切替えアクション\r\n  const handleDefaultClick = (timestamp: number, _categoryId: string, roomId: string) => {\r\n    setSelectedDate(new Date(timestamp));\r\n    byRoomDispatch({ type: 'weekly', changeTab: roomId });\r\n  };\r\n\r\n  // １週間 → デフォルト表示へ切替えアクション\r\n  const handleWeeklyClick = (timestamp: number, categoryId: string, _roomId: string) => {\r\n    setSelectedDate(new Date(timestamp));\r\n    byRoomDispatch({ type: 'default', changeTab: categoryId });\r\n  };\r\n\r\n  return (\r\n    <BaseTemplate>\r\n      <Paper square>\r\n        <Box p={2}>\r\n          <HeaderActions\r\n            title={t(byRoomState.titleLabel)}\r\n            subtitle={t(byRoomState.subtitleLabel)}\r\n            date={selectedDate}\r\n            onDateChange={handleDateChange}\r\n            dispatch={dataDialogDispatch}\r\n          />\r\n        </Box>\r\n        {\r\n          /* デフォルト表示 */\r\n          !byRoomState.weekly && (\r\n            <CategoryTabContext\r\n              tabPanelContent={\r\n                <DataTable\r\n                  currentDate={selectedDate!}\r\n                  dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }}\r\n                  tabKey=\"dummyId\"\r\n                  onTitleClick={handleDefaultClick}\r\n                />\r\n              }\r\n              selected={byRoomState.changeTab}\r\n            />\r\n          )\r\n        }\r\n        {\r\n          /* １週間表示 */\r\n          byRoomState.weekly && (\r\n            <RoomTabContext\r\n              tabPanelContent={\r\n                <DataTableWeekly\r\n                  currentDate={selectedDate!}\r\n                  dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }}\r\n                  tabKey=\"dummyId\"\r\n                  onTitleClick={handleWeeklyClick}\r\n                />\r\n              }\r\n              selected={byRoomState.changeTab}\r\n              // type=\"rooms\"\r\n            />\r\n          )\r\n        }\r\n      </Paper>\r\n    </BaseTemplate>\r\n  );\r\n}\r\n","import { useContext, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useForm } from 'react-hook-form';\r\nimport { format } from 'date-fns';\r\n\r\nimport { Box, Button, List, makeStyles, TextField } from '@material-ui/core';\r\nimport { MuiPickersContext } from '@material-ui/pickers';\r\n\r\nimport { FrontRowData } from './DataTable';\r\n\r\nimport { RoomReadFields } from 'main/RoomReadFields';\r\n\r\nimport { fetchPostData } from '_utils/FetchPostData';\r\nimport { MySnackberContext } from '_components/MySnackbarContext';\r\nimport { Spinner } from '_components/Spinner';\r\nimport { MyDialog } from '_components/MyDialog';\r\n\r\nimport { FrontInputType, VisitorInfoFront } from '_models/VisitorInfo';\r\nimport { makeTableDialogStyle } from '_styles/TableTheme';\r\n\r\nconst useRowDataDialogStyles = makeTableDialogStyle();\r\n\r\nconst useStyles = makeStyles({\r\n  checkAction: {\r\n    textAlign: 'center',\r\n    marginBottom: '10px',\r\n    '& Button': {\r\n      margin: '0 5%',\r\n      width: '40%',\r\n    },\r\n  },\r\n});\r\n\r\ntype Inputs = {\r\n  mode: 'checkin' | 'checkout';\r\n} & VisitorInfoFront &\r\n  FrontInputType;\r\n\r\ntype RowDataReadDialogProps = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  data: FrontRowData;\r\n  reload: () => void;\r\n};\r\n\r\nexport function RowDataFrontDialog(props: RowDataReadDialogProps) {\r\n  const { open, onClose, data, reload } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useRowDataDialogStyles();\r\n  const frontClasses = useStyles();\r\n  const muiPickContext = useContext(MuiPickersContext); // locale取得用\r\n  const snackberContext = useContext(MySnackberContext); // スナックバー取得用\r\n\r\n  // 入力フォームの登録\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    setValue,\r\n    reset,\r\n    formState: { errors, isSubmitting, dirtyFields },\r\n  } = useForm<Inputs>({ reValidateMode: 'onSubmit' });\r\n\r\n  // 入力フォームの初期化\r\n  useEffect(() => {\r\n    if (open) {\r\n      reset({\r\n        id: data.visitorId,\r\n        checkIn: data.checkIn,\r\n        checkOut: data.checkOut,\r\n        visitorCardNumber: data.visitorCardNumber,\r\n      });\r\n    } else {\r\n      reset();\r\n    }\r\n  }, [data, open, reset]);\r\n\r\n  const timestamp = () => format(new Date(), 'yyyy/MM/dd HH:mm:ss', { locale: muiPickContext?.locale });\r\n\r\n  // チェックインaction\r\n  const handleCheckIn = () => {\r\n    setValue('mode', 'checkin');\r\n    setValue('checkIn', timestamp(), { shouldDirty: true });\r\n    handleSubmit(onSubmit)();\r\n  };\r\n  // チェックアウトaction\r\n  const handleCheckOut = () => {\r\n    setValue('mode', 'checkout');\r\n    setValue('checkOut', timestamp(), { shouldDirty: true });\r\n    handleSubmit(onSubmit)();\r\n  };\r\n\r\n  // データ送信submit\r\n  const onSubmit = async (formData: Inputs) => {\r\n    try {\r\n      const result = await fetchPostData(`/front/${formData.mode}`, { inputs: formData, dirtyFields: dirtyFields });\r\n      if (result!.success) {\r\n        await reload();\r\n        onClose();\r\n        snackberContext.dispatch({ type: 'success', message: t('common.msg.update-success') });\r\n      } else {\r\n        snackberContext.dispatch({ type: 'error', message: t('common.msg.update-failed') });\r\n      }\r\n    } catch (error) {\r\n      snackberContext.dispatch({ type: 'error', message: (error as Error).message });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Spinner open={isSubmitting} />\r\n      <MyDialog open={open} onClose={onClose} title={t('visitdialog.title')}>\r\n        <Box p={2}>\r\n          <form>\r\n            <div className={frontClasses.checkAction}>\r\n              <Button onClick={handleCheckIn} variant=\"contained\" color=\"secondary\" disabled={!!data.checkOut}>\r\n                {t('visitdialog.button.check-in')}\r\n              </Button>\r\n              <Button onClick={handleCheckOut} variant=\"contained\" color=\"secondary\" disabled={!data.checkIn}>\r\n                {t('visitdialog.button.check-out')}\r\n              </Button>\r\n            </div>\r\n            <div>\r\n              <TextField\r\n                margin=\"normal\"\r\n                fullWidth\r\n                autoComplete=\"off\"\r\n                color=\"secondary\"\r\n                id=\"visitorCardNumber\"\r\n                label={t('visitdialog.form.visitor-card-number')}\r\n                // placeholder={t('visitdialog.form.visitor-card-number-placeholder')}\r\n                autoFocus\r\n                {...register('visitorCardNumber', {\r\n                  // required: t('common.form.required') as string,\r\n                })}\r\n                error={!!errors.visitorCardNumber}\r\n                helperText={errors.visitorCardNumber && errors.visitorCardNumber.message}\r\n              />\r\n            </div>\r\n          </form>\r\n        </Box>\r\n\r\n        <Box px={2} pt={2}>\r\n          <List disablePadding={true}>\r\n            <li key=\"app-time\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.appt-time')}</div>\r\n              <div className={classes.field}>{data.apptTime}</div>\r\n            </li>\r\n            <li key=\"check-in\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.check-in')}</div>\r\n              <div className={classes.field}>{data.checkIn}</div>\r\n            </li>\r\n            <li key=\"check-out\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.check-out')}</div>\r\n              <div className={classes.field}>{data.checkOut}</div>\r\n            </li>\r\n            {/* <li key=\"event-subject\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.event-subject')}</div>\r\n              <div className={classes.field}>{data.subject}</div>\r\n            </li> */}\r\n            <li key=\"visit-company\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.visit-company')}</div>\r\n              <div className={classes.field}>{data.visitCompany}</div>\r\n            </li>\r\n            <li key=\"visitor-name\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.visitor-name')}</div>\r\n              <div className={classes.field}>{data.visitorName}</div>\r\n            </li>\r\n            <li key=\"comment\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.comment')}</div>\r\n              <div className={classes.field}>{data.comment}</div>\r\n            </li>\r\n          </List>\r\n        </Box>\r\n\r\n        {Object.keys(data.resourcies).map((roomId) => {\r\n          return <RoomReadFields key={roomId} data={data.resourcies[roomId]} /*hiddenTeaSupply={data.isMSMultipleLocations}*/ />;\r\n        })}\r\n\r\n        <Box p={2}>\r\n          <List disablePadding={true}>\r\n            <li key=\"reservation-name\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.reservation-name')}</div>\r\n              <div className={classes.field}>{data.reservationName}</div>\r\n            </li>\r\n            <li key=\"contact-addr\" className={classes.list}>\r\n              <div className={classes.title}>{t('visittable.header.contact-addr')}</div>\r\n              <div className={classes.field}>{data.contactAddr}</div>\r\n            </li>\r\n          </List>\r\n        </Box>\r\n      </MyDialog>\r\n    </>\r\n  );\r\n}\r\n","import { useCallback, useState } from 'react';\r\nimport { useRouteMatch } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport MaterialTable, { Column, MTableCell } from '@material-table/core';\r\n\r\nimport BorderColorIcon from '@material-ui/icons/BorderColor';\r\n\r\nimport { pageingOntions, tableIcons } from '_utils/MaterialTableIcons';\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\nimport { DataDialogAction, DataDialogState, DataTableBase, RowDataType } from '../DataTableBase';\r\nimport { RowDataFrontDialog } from './RowDataFrontDialog';\r\n\r\nimport { LocationParams } from '_models/Location';\r\nimport { VisitorInfoFront } from '_models/VisitorInfo';\r\nimport { cellStyle, makeVisitorTableStyles } from '_styles/VisitorTableStyle';\r\nimport { tableTheme } from '_styles/TableTheme';\r\n\r\nconst useStyles = makeVisitorTableStyles();\r\n\r\nexport type Columns = {\r\n  title: string;\r\n  field: string;\r\n  type?: string;\r\n  cellStyle?: object | void;\r\n  render?: (rowData: FrontRowData) => any;\r\n};\r\n\r\nexport type FrontRowData = RowDataType & VisitorInfoFront;\r\n\r\ntype DataTableProps = {\r\n  currentDate: Date;\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n  tabKey: string;\r\n};\r\n\r\nexport function DataTable(props: DataTableProps) {\r\n  const { currentDate, dataDialogHook, tabKey } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const match = useRouteMatch<LocationParams>();\r\n\r\n  // データ取得\r\n  const [{ data, isLoading, isError }, reload] = useLoadData<FrontRowData[]>(\r\n    `/front/visitlist?timestamp=${currentDate!.getTime()}&location=${match.params.location}&category=${tabKey}`,\r\n    []\r\n  );\r\n\r\n  // フロント用ダイアログの状態\r\n  const [frontDialogOpen, setFrontDialogOpen] = useState(false);\r\n\r\n  // 選択行の状態\r\n  const [currentRow, setCurrentRow] = useState<FrontRowData | null>(null);\r\n\r\n  // ダイアログを開く\r\n  const handleDialogOpen = useCallback(\r\n    (selectedRow: FrontRowData) => {\r\n      if (selectedRow.isAuthor) {\r\n        dataDialogHook.dispatch({ type: 'inputOpen' });\r\n      } else {\r\n        dataDialogHook.dispatch({ type: 'readOpen' });\r\n      }\r\n      setCurrentRow(selectedRow);\r\n    },\r\n    [dataDialogHook]\r\n  );\r\n\r\n  // フロント用ダイアログを開く\r\n  const handleFrontDialogOpen = useCallback((selectedRow: FrontRowData) => {\r\n    setFrontDialogOpen(true);\r\n    setCurrentRow(selectedRow);\r\n  }, []);\r\n  // フロント用ダイアログを閉じる\r\n  const handleFrontDialogClose = async () => {\r\n    setFrontDialogOpen(false);\r\n  };\r\n\r\n  const columns: Columns[] = [\r\n    { title: t('visittable.header.appt-time'), field: 'apptTime' },\r\n    { title: t('visittable.header.room-name'), field: 'roomName' },\r\n    {\r\n      title: t('visittable.header.tea-supply'),\r\n      field: 'teaSupply',\r\n      render: (rowData) => {\r\n        const roomId = Object.keys(rowData.resourcies)[0]; // TODO:複数会議室未対応\r\n        const strNumOfVisitor = `${t('visitdialog.view.tea-supply.number-of-visitor')}:${rowData.resourcies[roomId].numberOfVisitor}`;\r\n        const strNumOfEmployee = `${t('visitdialog.view.tea-supply.number-of-employee')}:${rowData.resourcies[roomId].numberOfEmployee}`;\r\n        return `${strNumOfVisitor}, ${strNumOfEmployee}`;\r\n      },\r\n    },\r\n    { title: t('visittable.header.visit-company'), field: 'visitCompany' },\r\n    { title: t('visittable.header.visitor-name'), field: 'visitorName' },\r\n    { title: t('visittable.header.check-in'), field: 'checkIn', type: 'boolean' },\r\n    { title: t('visittable.header.check-out'), field: 'checkOut', type: 'boolean' },\r\n    { title: t('visittable.header.reservation-name'), field: 'reservationName' },\r\n    { title: t('visittable.header.comment'), field: 'comment' },\r\n  ];\r\n\r\n  // データ取得失敗した場合\r\n  if (isError) {\r\n    return <div>{t('common.msg.fetch-failed')}</div>;\r\n  }\r\n\r\n  return (\r\n    <DataTableBase currentRow={currentRow} dataDialogHook={dataDialogHook} isLoading={isLoading} reload={reload}>\r\n      <MaterialTable\r\n        columns={columns as Column<FrontRowData>[]}\r\n        components={{\r\n          Cell: (props) => <MTableCell {...props} className={cellStyle(props.columnDef.field, props.rowData, classes)} />,\r\n        }}\r\n        data={data!}\r\n        onRowClick={(_event, selectedRow?) => !!selectedRow && handleFrontDialogOpen(selectedRow)}\r\n        actions={[\r\n          {\r\n            icon: () => <BorderColorIcon />,\r\n            tooltip: t('visittable.header.edit-action'),\r\n            onClick: (_, rowData) => !!rowData && handleDialogOpen(rowData as FrontRowData),\r\n          },\r\n        ]}\r\n        localization={{\r\n          header: { actions: '' },\r\n        }}\r\n        options={{\r\n          showTitle: false,\r\n          toolbar: false,\r\n          search: false,\r\n          headerStyle: { backgroundColor: tableTheme.palette.primary.light },\r\n          tableLayout: 'fixed',\r\n          // actionsColumnIndex: -1,\r\n          ...pageingOntions,\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n      {currentRow && <RowDataFrontDialog open={frontDialogOpen} onClose={handleFrontDialogClose} data={currentRow} reload={reload} />}\r\n    </DataTableBase>\r\n  );\r\n}\r\n","import { useContext, useState, useEffect, useMemo, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useRouteMatch } from 'react-router-dom';\r\nimport { addWeeks, format, startOfDay } from 'date-fns';\r\nimport { Controller, SubmitHandler, useForm } from 'react-hook-form';\r\nimport { CSVLink } from 'react-csv';\r\nimport _ from 'lodash';\r\n\r\nimport { Box, Button, Grid, makeStyles } from '@material-ui/core';\r\nimport { KeyboardDatePicker } from '@material-ui/pickers';\r\nimport ArrowRightAltIcon from '@material-ui/icons/ArrowRightAlt';\r\n\r\nimport { MyDialog } from '_components/MyDialog';\r\nimport { MySnackberContext } from '_components/MySnackbarContext';\r\nimport { Spinner } from '_components/Spinner';\r\n\r\nimport { fetchPostData } from '_utils/FetchPostData';\r\nimport { LocationParams } from '_models/Location';\r\nimport { VisitorInfo, VisitorInfoFront, VisitorInfoReadOnly } from '_models/VisitorInfo';\r\n\r\nconst useStyles = makeStyles({\r\n  keyboardDatePicker: {\r\n    '& .MuiOutlinedInput-adornedEnd': { paddingRight: 0 },\r\n  },\r\n  between: { textAlign: 'center' },\r\n});\r\n\r\ntype ExportCsvParams = {\r\n  location: string;\r\n  startDate: Date;\r\n  endDate: Date;\r\n};\r\n\r\ntype DataType = { category: string; data: (VisitorInfo & VisitorInfoReadOnly & VisitorInfoFront)[] };\r\n\r\nconst nameOfCsvHeaders = [\r\n  'category',\r\n  'apptTime',\r\n  'roomName',\r\n  'teaSupply',\r\n  'numberOfVisitor',\r\n  'numberOfEmployee',\r\n  'visitCompany',\r\n  'visitorName',\r\n  'checkIn',\r\n  'visitorCardNumber',\r\n  'checkOut',\r\n  'reservationName',\r\n  'contactAddr',\r\n  'subject',\r\n  'comment',\r\n] as const;\r\ntype TypeOfCsvHeaders = typeof nameOfCsvHeaders[number];\r\ntype CsvDataType = {\r\n  [P in TypeOfCsvHeaders]: string;\r\n};\r\ntype CsvHeaderType = { label: string; key: keyof CsvDataType };\r\n\r\ntype ExportCsvDialogProps = {\r\n  open: boolean;\r\n  onClose: () => void;\r\n};\r\n\r\nexport function ExportCsvDialog(props: ExportCsvDialogProps) {\r\n  const { open, onClose } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const match = useRouteMatch<LocationParams>();\r\n  const snackberContext = useContext(MySnackberContext); // スナックバー取得用\r\n\r\n  const csvLinkRef = useRef<CSVLink & HTMLAnchorElement & { link: HTMLAnchorElement }>(null);\r\n\r\n  // CSVデータの状態\r\n  const [csvData, setCsvData] = useState<CsvDataType[]>([]);\r\n\r\n  // 入力フォームの登録\r\n  const defaultValues = useMemo(() => {\r\n    return { location: match.params.location, startDate: new Date(), endDate: addWeeks(new Date(), 1) };\r\n  }, [match.params.location]);\r\n\r\n  const {\r\n    control,\r\n    getValues,\r\n    handleSubmit,\r\n    reset,\r\n    setValue,\r\n    formState: { errors, isSubmitting, dirtyFields },\r\n  } = useForm<ExportCsvParams>({ defaultValues, reValidateMode: 'onSubmit' });\r\n\r\n  // 入力フォームの初期化\r\n  useEffect(() => {\r\n    if (open) {\r\n      reset(defaultValues);\r\n    }\r\n  }, [defaultValues, open, reset]);\r\n\r\n  // 開始日の変更アクション\r\n  const handleStartDateChange = () => {\r\n    const endDate = addWeeks(getValues('startDate'), 1);\r\n    setValue('endDate', endDate, { shouldDirty: true });\r\n  };\r\n\r\n  // CSV出力アクション\r\n  const handleExportCsv = async () => {\r\n    handleSubmit(onSubmit)();\r\n  };\r\n\r\n  // CSVヘッダー\r\n  const headers: CsvHeaderType[] = nameOfCsvHeaders.map((value) => {\r\n    return { label: t(`export-csv.file.header.${_.kebabCase(value)}`), key: value };\r\n  });\r\n\r\n  // CSVファイル名\r\n  const filename = `visitor-${format(getValues('startDate'), 'yyyyMMdd')}-${format(getValues('endDate'), 'yyyyMMdd')}.csv`;\r\n\r\n  // データ送信submit\r\n  const onSubmit: SubmitHandler<ExportCsvParams> = async (formData) => {\r\n    try {\r\n      const result = await fetchPostData<ExportCsvParams, ExportCsvParams, DataType[]>('/front/export', {\r\n        inputs: formData,\r\n        dirtyFields: dirtyFields,\r\n      });\r\n      if (result!.success) {\r\n        if (!!result.value) {\r\n          const dataByCategory = result.value.map((rowData) => {\r\n            const category = rowData.category;\r\n            return rowData.data.map((item) => {\r\n              const roomId = Object.keys(item.resourcies)[0]; // TODO:複数会議室未対応\r\n              return {\r\n                category: category,\r\n                apptTime: item.apptTime,\r\n                roomName: item.roomName,\r\n                teaSupply: item.resourcies[roomId].teaSupply ? t('export-csv.file.tea-supply-yes') : t('export-csv.file.tea-supply-no'),\r\n                numberOfVisitor: item.resourcies[roomId].numberOfVisitor.toString(),\r\n                numberOfEmployee: item.resourcies[roomId].numberOfEmployee.toString(),\r\n                visitCompany: item.visitCompany,\r\n                visitorName: item.visitorName,\r\n                checkIn: item.checkIn,\r\n                visitorCardNumber: item.visitorCardNumber,\r\n                checkOut: item.checkOut,\r\n                reservationName: item.reservationName,\r\n                contactAddr: item.contactAddr,\r\n                subject: item.subject,\r\n                comment: item.comment,\r\n              };\r\n            }) as CsvDataType[];\r\n          });\r\n          setCsvData(dataByCategory.flat());\r\n          csvLinkRef?.current?.link.click();\r\n          snackberContext.dispatch({ type: 'success', message: t('export-csv.msg.export-success') });\r\n        }\r\n      } else {\r\n        // エラーのセット\r\n        snackberContext.dispatch({ type: 'error', message: t('export-csv.msg.export-failed') });\r\n      }\r\n    } catch (error) {\r\n      snackberContext.dispatch({ type: 'error', message: (error as Error).message });\r\n    }\r\n  };\r\n\r\n  // 日付ピッカー\r\n  const datePicker = (type: 'start' | 'end') => (\r\n    <Controller\r\n      name={`${type}Date`}\r\n      control={control}\r\n      rules={{\r\n        required: t('common.form.required') as string,\r\n        validate: () =>\r\n          startOfDay(getValues('startDate')).getTime() <= startOfDay(getValues('endDate')).getTime() ||\r\n          (t('export-csv.form.error.event-time') as string),\r\n      }}\r\n      render={({ field }) => (\r\n        <KeyboardDatePicker\r\n          {...field}\r\n          onChange={(e) => {\r\n            field.onChange(e);\r\n            if (type === 'start') handleStartDateChange();\r\n          }}\r\n          format=\"yyyy/MM/dd\"\r\n          label={t(`export-csv.${type}-date`)}\r\n          showTodayButton\r\n          KeyboardButtonProps={{\r\n            'aria-label': 'change date',\r\n          }}\r\n          size=\"small\"\r\n          className={classes.keyboardDatePicker}\r\n          error={!!errors[`${type}Date`]}\r\n          helperText={errors[`${type}Date`] && errors[`${type}Date`]!.message}\r\n        />\r\n      )}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Spinner open={isSubmitting} />\r\n      <MyDialog open={open} onClose={onClose} title={t('export-csv.title')}>\r\n        <form>\r\n          <Box px={2} pt={2}>\r\n            <Grid container justifyContent=\"center\" alignItems=\"center\">\r\n              <Grid container item xs={12} sm={4}>\r\n                {datePicker('start')}\r\n              </Grid>\r\n              <Grid item xs={12} sm={4} className={classes.between}>\r\n                <ArrowRightAltIcon />\r\n              </Grid>\r\n              <Grid container item xs={12} sm={4}>\r\n                {datePicker('end')}\r\n              </Grid>\r\n            </Grid>\r\n          </Box>\r\n          <Box p={2}>\r\n            <Button onClick={handleExportCsv} variant=\"contained\" color=\"primary\" fullWidth>\r\n              {t('export-csv.button.export-csv')}\r\n            </Button>\r\n          </Box>\r\n        </form>\r\n\r\n        <CSVLink style={{ display: 'none' }} data={csvData} headers={headers} filename={filename} ref={csvLinkRef}>\r\n          {'Export Trigger'}\r\n        </CSVLink>\r\n      </MyDialog>\r\n    </>\r\n  );\r\n}\r\n","import { useEffect, useReducer, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Button, Paper } from '@material-ui/core';\r\nimport ArchiveOutlinedIcon from '@material-ui/icons/ArchiveOutlined';\r\n\r\nimport BaseTemplate from '../../_components/BaseTemplate';\r\nimport { useSelectedDate } from '_utils/useSelectedDate';\r\nimport { getReloadState, getReloadStateFlg, removeReloadStateFlg } from '_utils/SessionStrage';\r\n\r\nimport { DataTable } from './DataTable';\r\nimport { ExportCsvDialog } from './ExportCsvDialog';\r\nimport { dataDialogReducer, DataDialogState } from '../DataTableBase';\r\nimport { HeaderActions } from '../HeaderActions';\r\nimport { CategoryTabContext } from '../CategoryTabContext';\r\n\r\nexport function Front() {\r\n  const { t } = useTranslation();\r\n\r\n  // カレンダー選択日の状態\r\n  const [selectedDate, setSelectedDate] = useSelectedDate();\r\n  const handleDateChange = (date: Date | null) => {\r\n    setSelectedDate(date);\r\n  };\r\n\r\n  // ダイアログの初期値\r\n  const initialState: DataDialogState = {\r\n    mode: 'addData',\r\n    inputOpen: false,\r\n    readOpen: false,\r\n  };\r\n  // ダイアログの状態\r\n  const [dataDialogState, dataDialogDispatch] = useReducer(dataDialogReducer, initialState);\r\n\r\n  //  CSV出力ダイアログの状態\r\n  const [exportCsvOpen, setExportCsvOpen] = useState(false);\r\n\r\n  // reload用にtabの状態を一時的に保持\r\n  const [changeTab, setChangeTab] = useState('');\r\n\r\n  // ================================\r\n  // refreshボタンによるreload\r\n  useEffect(() => {\r\n    if (!!getReloadStateFlg()) {\r\n      setSelectedDate(new Date(Number(getReloadState('selectedDate'))));\r\n      setChangeTab(getReloadState('tabValue'));\r\n      removeReloadStateFlg();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n  // ================================\r\n\r\n  //  CSV出力クリックアクション\r\n  const handleExporCsvClick = () => {\r\n    setExportCsvOpen(true);\r\n  };\r\n  // CSV出力ダイアログ閉じるアクション\r\n  const handleExporCsvClose = () => {\r\n    setExportCsvOpen(false);\r\n  };\r\n\r\n  // CSV出力ボタン\r\n  const csvButton = (\r\n    <Button variant=\"contained\" startIcon={<ArchiveOutlinedIcon />} onClick={handleExporCsvClick}>\r\n      {t('main.header.export-csv')}\r\n    </Button>\r\n  );\r\n\r\n  return (\r\n    <BaseTemplate frontMode>\r\n      <Paper square>\r\n        <Box p={2}>\r\n          <HeaderActions\r\n            title={t('main.front.title')}\r\n            date={selectedDate}\r\n            onDateChange={handleDateChange}\r\n            dispatch={dataDialogDispatch}\r\n            actionButtons={[csvButton]}\r\n          />\r\n        </Box>\r\n        <CategoryTabContext\r\n          tabPanelContent={\r\n            <DataTable currentDate={selectedDate!} dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }} tabKey=\"dummyId\" />\r\n          }\r\n          selected={changeTab ? changeTab : undefined}\r\n        />\r\n      </Paper>\r\n      <ExportCsvDialog open={exportCsvOpen} onClose={handleExporCsvClose} />\r\n    </BaseTemplate>\r\n  );\r\n}\r\n","import Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\ntype DeleteConfirmDialogPorps = {\r\n  open: boolean;\r\n  onClose: (deleteOk: boolean) => void;\r\n};\r\n\r\nexport function DeleteConfirmDialog(props: DeleteConfirmDialogPorps) {\r\n  const { open, onClose } = props;\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const handleClose = () => {\r\n    onClose(false);\r\n  };\r\n  const handleOkClose = () => {\r\n    onClose(true);\r\n  };\r\n  const handleCancelClose = () => {\r\n    onClose(false);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Dialog open={open} onClose={handleClose} aria-labelledby=\"alert-dialog-title\" aria-describedby=\"alert-dialog-description\">\r\n        {/* <DialogTitle id=\"alert-dialog-title\">{t('visitorinfoform.delete-confirm-title')}</DialogTitle> */}\r\n        <DialogContent>\r\n          <DialogContentText id=\"alert-dialog-description\">{t('common.msg.delete-confirm')}</DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleOkClose} color=\"secondary\">\r\n            OK\r\n          </Button>\r\n          <Button onClick={handleCancelClose} color=\"secondary\" autoFocus>\r\n            CANCEL\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","import { useContext, useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { DeepPartial, Path, PathValue, SubmitHandler, UnpackNestedValue, useForm, FieldValues, FormProvider } from 'react-hook-form';\r\n\r\nimport { Box, Grid, Button } from '@material-ui/core';\r\nimport { makeStyles, createStyles, createTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport { grey, purple } from '@material-ui/core/colors';\r\n\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\n\r\nimport _ from 'lodash';\r\n\r\nimport { fetchPostData } from '_utils/FetchPostData';\r\n\r\nimport { MySnackberContext } from '_components/MySnackbarContext';\r\nimport { Spinner } from '_components/Spinner';\r\nimport { MyDialog } from '_components/MyDialog';\r\n\r\nimport { DeleteConfirmDialog } from './DeleteConfirmDialog';\r\n\r\nconst useStyles = makeStyles((tableTheme) => {\r\n  return createStyles({\r\n    formAction: {\r\n      marginTop: tableTheme.spacing(1),\r\n      marginBottom: tableTheme.spacing(1),\r\n    },\r\n    note: {\r\n      color: 'red',\r\n      fontSize: '0.9em',\r\n      margin: 0,\r\n    },\r\n  });\r\n});\r\n\r\nconst inputformTheme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      main: purple[500],\r\n    },\r\n    secondary: {\r\n      main: grey[300],\r\n    },\r\n  },\r\n  props: {\r\n    MuiTextField: {\r\n      variant: 'outlined',\r\n      margin: 'dense',\r\n      fullWidth: true,\r\n      minRows: 4,\r\n    },\r\n  },\r\n});\r\n\r\nexport type Mastertype = 'role' | 'location' | 'category' | 'room';\r\n\r\ntype InputMode = { mode: 'ins' | 'upd' | 'del' };\r\nexport type Inputs<RowData> = InputMode & RowData;\r\n\r\ntype DefaultValuesType<RowData> = UnpackNestedValue<DeepPartial<Inputs<RowData>>>;\r\nexport type InputFields<RowData> = {\r\n  type: Mastertype;\r\n  item: React.ReactNode;\r\n  defaultValues: DefaultValuesType<RowData>;\r\n};\r\n\r\n// react-hook-formのsetValue。型定義が長いのでショートカット用\r\ntype RHFSetValueP1<RowData> = Path<Inputs<RowData>>;\r\ntype RHFSetValueP2<RowData> = UnpackNestedValue<PathValue<Inputs<RowData>, Path<Inputs<RowData>>>>;\r\n\r\ntype RowDataInputDialogProps<RowData> = {\r\n  inputFields: InputFields<RowData>;\r\n  open: boolean;\r\n  onClose: () => void;\r\n  data: RowData | null;\r\n  reload: () => void;\r\n};\r\n\r\nexport function RowDataInputDialog<RowData>(props: RowDataInputDialogProps<RowData>) {\r\n  const { inputFields, open, onClose, data, reload } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const snackberContext = useContext(MySnackberContext); // スナックバー取得用\r\n\r\n  // 削除確認メッセージの状\r\n  const [delConfOpen, setDelConfOpen] = useState(false);\r\n\r\n  // 入力フォームの登録\r\n  const methods = useForm({ defaultValues: { ...inputFields.defaultValues }, reValidateMode: 'onSubmit' });\r\n\r\n  const {\r\n    handleSubmit,\r\n    reset,\r\n    setValue,\r\n    setError,\r\n    formState: { isDirty, isSubmitting, dirtyFields },\r\n  } = methods;\r\n\r\n  // 入力フォームの初期化\r\n  useEffect(() => {\r\n    if (open && !!data) {\r\n      const values = Object.keys(inputFields.defaultValues).reduce((newObj: FieldValues, key) => {\r\n        if (key === 'mode') {\r\n          newObj['mode'] = 'upd';\r\n        } else {\r\n          newObj[key] = (data as FieldValues)[key];\r\n        }\r\n        return newObj;\r\n      }, {});\r\n      reset(_.cloneDeep(values as DefaultValuesType<RowData>));\r\n    } else {\r\n      reset(_.cloneDeep(inputFields.defaultValues));\r\n    }\r\n  }, [data, inputFields, open, reset]);\r\n\r\n  // 保存アクション\r\n  const handleSave = () => {\r\n    handleSubmit(onSubmit)();\r\n  };\r\n  // 削除アクション(確認メッセージ)\r\n  const handleDelete = () => {\r\n    setDelConfOpen(true);\r\n  };\r\n  // 削除アクション\r\n  const deleteAction = () => {\r\n    setValue('mode' as RHFSetValueP1<RowData>, 'del' as RHFSetValueP2<RowData>);\r\n    handleSubmit(onSubmit)();\r\n  };\r\n\r\n  // データ送信submit\r\n  const onSubmit: SubmitHandler<Inputs<RowData>> = async (formData) => {\r\n    try {\r\n      let url = '';\r\n      switch (formData.mode) {\r\n        case 'ins':\r\n          url = `/${inputFields.type}/create`;\r\n          break;\r\n        case 'upd':\r\n          url = `/${inputFields.type}/update`;\r\n          break;\r\n        case 'del':\r\n          url = `/${inputFields.type}/delete`;\r\n          break;\r\n      }\r\n      const result = await fetchPostData(url, { inputs: formData, dirtyFields: dirtyFields });\r\n      if (result!.success) {\r\n        if (formData.mode === 'del') await new Promise((r) => setTimeout(r, 1000)); // MSGraphのイベント削除が反映されるまでのタイムラグを考慮\r\n        await reload();\r\n        onClose();\r\n        snackberContext.dispatch({ type: 'success', message: t('common.msg.update-success') });\r\n        // ロール設定とロケーション設定は更新反映のためにログアウトを促す\r\n        if (inputFields.type === 'role' || inputFields.type === 'location') {\r\n          await new Promise(() =>\r\n            setTimeout(() => {\r\n              snackberContext.dispatch({ type: 'warning', message: t('common.msg.prompt-logout') });\r\n            }, 1500)\r\n          );\r\n        }\r\n      } else {\r\n        // エラー判定のセット\r\n        if (result!.errors) {\r\n          const errors = result!.errors;\r\n          for (let key in errors) {\r\n            let name = key as keyof Inputs<RowData> as Path<Inputs<RowData>>;\r\n            setError(name, { message: t(errors[name]![0]) });\r\n          }\r\n        }\r\n        // snackberContext.dispatch({ type: 'error', message: t('common.msg.update-failed') });\r\n      }\r\n    } catch (error) {\r\n      snackberContext.dispatch({ type: 'error', message: (error as Error).message });\r\n    }\r\n  };\r\n\r\n  // 削除確認アクション\r\n  const handleDelConfClose = (deleteOk: boolean) => {\r\n    setDelConfOpen(false);\r\n    if (deleteOk) {\r\n      deleteAction();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Spinner open={isSubmitting} />\r\n      <MyDialog open={open} onClose={onClose} title={t(`settings.title.${inputFields.type}`)}>\r\n        <ThemeProvider theme={inputformTheme}>\r\n          <FormProvider {...methods}>\r\n            <form>\r\n              <Box p={2}>{inputFields.item}</Box>\r\n              <Box px={2}>\r\n                <Grid container justifyContent=\"space-between\" spacing={2} className={classes.formAction}>\r\n                  <Grid item xs={!data ? 12 : 6}>\r\n                    <Button onClick={handleSave} variant=\"contained\" color=\"primary\" disabled={!isDirty} startIcon={<SaveIcon />} fullWidth>\r\n                      {t('common.button.save')}\r\n                    </Button>\r\n                  </Grid>\r\n                  <Grid item xs={6} style={!data ? { display: 'none' } : undefined}>\r\n                    <Button onClick={handleDelete} variant=\"contained\" color=\"primary\" /*disabled={!data}*/ startIcon={<DeleteIcon />} fullWidth>\r\n                      {t('common.button.delete')}\r\n                    </Button>\r\n                  </Grid>\r\n                </Grid>\r\n              </Box>\r\n            </form>\r\n          </FormProvider>\r\n        </ThemeProvider>\r\n      </MyDialog>\r\n      <DeleteConfirmDialog open={delConfOpen} onClose={handleDelConfClose}></DeleteConfirmDialog>\r\n    </>\r\n  );\r\n}\r\n","import { ThemeProvider } from '@material-ui/core/styles';\r\n\r\nimport { tableTheme } from '_styles/TableTheme';\r\nimport { Spinner } from '_components/Spinner';\r\n\r\nimport { InputFields, RowDataInputDialog } from './RowDataInputDialog';\r\n\r\nexport type DataDialogState = {\r\n  mode: 'rowData' | 'addData';\r\n  inputOpen: boolean;\r\n};\r\n\r\nexport type DataDialogAction = {\r\n  type: 'inputOpen' | 'addDataOpen' | 'inputClose';\r\n};\r\n\r\nexport const dataDialogReducer = (state: DataDialogState, action: DataDialogAction): DataDialogState => {\r\n  switch (action.type) {\r\n    case 'inputOpen':\r\n      return { mode: 'rowData', inputOpen: true };\r\n    case 'addDataOpen':\r\n      return { mode: 'addData', inputOpen: true };\r\n    case 'inputClose':\r\n      return { ...state, inputOpen: false };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\ntype DataTableBaseProps<RowData> = {\r\n  inputFields: InputFields<RowData>;\r\n  currentRow: RowData | null;\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n  isLoading: boolean;\r\n  reload: () => void;\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport function DataTableBase<RowData>(props: DataTableBaseProps<RowData>) {\r\n  const { inputFields, dataDialogHook, isLoading, reload, currentRow, children } = props;\r\n\r\n  // ダイアログを閉じる(input)\r\n  const handleInputDialogClose = async () => {\r\n    dataDialogHook.dispatch({ type: 'inputClose' });\r\n  };\r\n\r\n  return (\r\n    <ThemeProvider theme={tableTheme}>\r\n      <Spinner open={isLoading} />\r\n      {children}\r\n      <RowDataInputDialog<RowData>\r\n        inputFields={inputFields}\r\n        open={dataDialogHook.state.inputOpen}\r\n        onClose={handleInputDialogClose}\r\n        data={dataDialogHook.state.mode === 'addData' ? null : currentRow}\r\n        reload={reload}\r\n      />\r\n    </ThemeProvider>\r\n  );\r\n}\r\n","import { useCallback, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport MaterialTable, { Column, MTableCell } from '@material-table/core';\r\n\r\nimport { tableIcons, pageingOntions } from '_utils/MaterialTableIcons';\r\nimport { useLoadData } from '_utils/useLoadData';\r\n\r\nimport { cellStyle, makeVisitorTableStyles } from '_styles/VisitorTableStyle';\r\nimport { tableTheme } from '_styles/TableTheme';\r\n\r\nimport { DataDialogAction, DataDialogState, DataTableBase } from './DataTableBase';\r\nimport { InputFields } from './RowDataInputDialog';\r\n\r\nconst useStyles = makeVisitorTableStyles();\r\n\r\nexport type Columns<RowData> = {\r\n  title: string;\r\n  field: string;\r\n  type?: string;\r\n  cellStyle?: object | void;\r\n  render?: (rowData: RowData) => any;\r\n};\r\n\r\ntype DataTableProps<RowData> = {\r\n  inputFields: InputFields<RowData>;\r\n  columns: Columns<RowData>[];\r\n  dataDialogHook: {\r\n    state: DataDialogState;\r\n    dispatch: React.Dispatch<DataDialogAction>;\r\n  };\r\n};\r\n\r\nexport function DataTable<RowData extends object>(props: DataTableProps<RowData>) {\r\n  const { inputFields, columns, dataDialogHook } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n\r\n  // データ取得\r\n  const [{ data, isLoading, isError }, reload] = useLoadData<RowData[]>(`/${inputFields.type}/list`, []);\r\n\r\n  // 選択行の状態\r\n  const [currentRow, setCurrentRow] = useState<RowData | null>(null);\r\n\r\n  // ダイアログを開く\r\n  const handleDialogOpen = useCallback(\r\n    (selectedRow: RowData) => {\r\n      dataDialogHook.dispatch({ type: 'inputOpen' });\r\n      setCurrentRow(selectedRow);\r\n    },\r\n    [dataDialogHook]\r\n  );\r\n\r\n  // データ取得失敗した場合\r\n  if (isError) {\r\n    return <div>{t('common.msg.fetch-failed')}</div>;\r\n  }\r\n\r\n  return (\r\n    <DataTableBase<RowData> inputFields={inputFields} currentRow={currentRow} dataDialogHook={dataDialogHook} isLoading={isLoading} reload={reload}>\r\n      <MaterialTable\r\n        columns={columns as Column<RowData>[]}\r\n        components={{\r\n          // Row: (props) => <MTableBodyRow {...props} className={rowStyle(props.data)} />,\r\n          Cell: (props) => <MTableCell {...props} className={cellStyle(props.columnDef.field, props.rowData, classes)} />,\r\n        }}\r\n        data={data!}\r\n        onRowClick={(_event, selectedRow?) => !!selectedRow && handleDialogOpen(selectedRow)}\r\n        options={{\r\n          showTitle: false,\r\n          toolbar: false,\r\n          search: false,\r\n          headerStyle: { backgroundColor: tableTheme.palette.primary.light },\r\n          tableLayout: 'fixed',\r\n          ...pageingOntions,\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n    </DataTableBase>\r\n  );\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\n\r\nimport { Button, Grid, makeStyles, Typography } from '@material-ui/core';\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\n\r\nimport { DataDialogAction } from './DataTableBase';\r\nimport { Mastertype } from './RowDataInputDialog';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  actionButtonArea: {\r\n    textAlign: 'right',\r\n    margin: 'auto',\r\n  },\r\n}));\r\n\r\nexport type Columns = {\r\n  title: string;\r\n  field: string;\r\n};\r\n\r\ntype HeaderActionsProps = {\r\n  master: Mastertype;\r\n  dispatch: React.Dispatch<DataDialogAction>;\r\n};\r\n\r\nexport function HeaderActions(props: HeaderActionsProps) {\r\n  const { master, dispatch } = props;\r\n\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n\r\n  // 新規作成ボタン\r\n  const handleCreateClick = (_event: React.ChangeEvent<{}>) => {\r\n    dispatch({ type: 'addDataOpen' });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Grid container alignItems=\"stretch\" justifyContent=\"space-between\">\r\n        <Grid container item xs={12} sm={9}>\r\n          <Typography component=\"h1\" variant=\"h6\">\r\n            {t(`settings.title.${master}`)}\r\n          </Typography>\r\n        </Grid>\r\n        <Grid item xs={12} sm={3} className={classes.actionButtonArea}>\r\n          <Button variant=\"contained\" color=\"secondary\" startIcon={<AddCircleIcon />} onClick={handleCreateClick}>\r\n            {t('settings.add-master')}\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </>\r\n  );\r\n}\r\n","import { EmailAddress } from './User';\r\n\r\nexport const nameOfRoleType = ['admin', 'front'] as const;\r\nexport type RoleType = typeof nameOfRoleType[number];\r\nexport type Role = {\r\n  id: string;\r\n  name: RoleType;\r\n  members: EmailAddress[];\r\n};\r\n","import { useTranslation } from 'react-i18next';\r\nimport { useFormContext } from 'react-hook-form';\r\n\r\nimport { ControllerTextField } from '_components/ControllerTextField';\r\nimport { AddrBookAutoComplete } from '_components/AddrBookAutoComplete';\r\nimport { nameOfRoleType } from '_models/Role';\r\n\r\nimport { Role } from '_models/Role';\r\n\r\nimport { Inputs } from '../RowDataInputDialog';\r\n\r\nexport function DataInputs() {\r\n  const {\r\n    control,\r\n    formState: { errors },\r\n  } = useFormContext<Inputs<Role>>();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <>\r\n      <ControllerTextField\r\n        name={'name'}\r\n        control={control}\r\n        label={t('settings.header.role.name')}\r\n        required\r\n        selectList={nameOfRoleType.map((value) => {\r\n          return { label: t(`settings.view.role.name.${value}`), value: value };\r\n        })}\r\n        errors={errors}\r\n      />\r\n      <AddrBookAutoComplete name={'members'} control={control} label={t('settings.header.role.members')} errors={errors} />\r\n    </>\r\n  );\r\n}\r\n","import { useReducer } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Paper } from '@material-ui/core';\r\n\r\nimport BaseTemplate from '../../_components/BaseTemplate';\r\nimport { Columns, DataTable } from '../DataTable';\r\nimport { dataDialogReducer, DataDialogState } from '../DataTableBase';\r\nimport { Inputs } from '../RowDataInputDialog';\r\nimport { HeaderActions } from '../HeaderActions';\r\nimport { DataInputs } from './DataInputs';\r\n\r\nimport { Role } from '_models/Role';\r\n\r\nexport function RoleSettings() {\r\n  const { t } = useTranslation();\r\n\r\n  // ダイアログの初期値\r\n  const initialState: DataDialogState = {\r\n    mode: 'addData',\r\n    inputOpen: false,\r\n  };\r\n  // ダイアログの状態\r\n  const [dataDialogState, dataDialogDispatch] = useReducer(dataDialogReducer, initialState);\r\n\r\n  const columns: Columns<Role>[] = [\r\n    {\r\n      title: t('settings.header.role.name'),\r\n      field: 'name',\r\n      render: (rowData) => t(`settings.view.role.name.${rowData.name}`),\r\n    },\r\n    // { title: t('settings.header.role.members'), field: 'members' },\r\n  ];\r\n\r\n  const defaultValues: Inputs<Role> = {\r\n    mode: 'ins',\r\n    id: '',\r\n    name: 'admin',\r\n    members: [],\r\n  };\r\n\r\n  return (\r\n    <BaseTemplate adminMode menuOpen>\r\n      <Paper square>\r\n        <Box p={2}>\r\n          <HeaderActions master=\"role\" dispatch={dataDialogDispatch}></HeaderActions>\r\n        </Box>\r\n        <Box p={2}>\r\n          <DataTable<Role>\r\n            inputFields={{ type: 'role', item: <DataInputs />, defaultValues: defaultValues }}\r\n            columns={columns}\r\n            dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }}\r\n          />\r\n        </Box>\r\n      </Paper>\r\n    </BaseTemplate>\r\n  );\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\nimport { useFormContext } from 'react-hook-form';\r\n\r\nimport { ControllerTextField } from '_components/ControllerTextField';\r\n\r\nimport { Location } from '_models/Location';\r\n\r\nimport { Inputs } from '../RowDataInputDialog';\r\n\r\nexport function DataInputs() {\r\n  const {\r\n    control,\r\n    formState: { errors },\r\n  } = useFormContext<Inputs<Location>>();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <>\r\n      <ControllerTextField name={'name'} control={control} label={t('settings.header.location.name')} required errors={errors} />\r\n      <ControllerTextField\r\n        name={'url'}\r\n        control={control}\r\n        label={t('settings.header.location.url')}\r\n        required\r\n        validation={{\r\n          pattern: {\r\n            value: /^[a-z0-9]+$/,\r\n            message: t('settings.form.location.error.url.pattern'),\r\n          },\r\n        }}\r\n        errors={errors}\r\n      />\r\n      <ControllerTextField name={'sort'} control={control} label={t('settings.header.location.sort')} errors={errors} />\r\n    </>\r\n  );\r\n}\r\n","import { useReducer } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Paper } from '@material-ui/core';\r\n\r\nimport BaseTemplate from '../../_components/BaseTemplate';\r\nimport { Columns, DataTable } from '../DataTable';\r\nimport { dataDialogReducer, DataDialogState } from '../DataTableBase';\r\nimport { Inputs } from '../RowDataInputDialog';\r\nimport { HeaderActions } from '../HeaderActions';\r\nimport { DataInputs } from './DataInputs';\r\n\r\nimport { Location } from '_models/Location';\r\n\r\nexport function LocationSettings() {\r\n  const { t } = useTranslation();\r\n\r\n  // ダイアログの初期値\r\n  const initialState: DataDialogState = {\r\n    mode: 'addData',\r\n    inputOpen: false,\r\n  };\r\n  // ダイアログの状態\r\n  const [dataDialogState, dataDialogDispatch] = useReducer(dataDialogReducer, initialState);\r\n\r\n  const columns: Columns<Location>[] = [\r\n    { title: t('settings.header.location.name'), field: 'name' },\r\n    { title: t('settings.header.location.url'), field: 'url' },\r\n    { title: t('settings.header.location.sort'), field: 'sort' },\r\n  ];\r\n\r\n  const defaultValues: Inputs<Location> = {\r\n    mode: 'ins',\r\n    id: '',\r\n    name: '',\r\n    url: '',\r\n    sort: '',\r\n  };\r\n\r\n  return (\r\n    <BaseTemplate adminMode menuOpen>\r\n      <Paper square>\r\n        <Box p={2}>\r\n          <HeaderActions master=\"location\" dispatch={dataDialogDispatch}></HeaderActions>\r\n        </Box>\r\n        <Box p={2}>\r\n          <DataTable<Location>\r\n            inputFields={{ type: 'location', item: <DataInputs />, defaultValues: defaultValues }}\r\n            columns={columns}\r\n            dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }}\r\n          />\r\n        </Box>\r\n      </Paper>\r\n    </BaseTemplate>\r\n  );\r\n}\r\n","import { useTranslation } from 'react-i18next';\r\nimport { Controller, useFormContext, useWatch } from 'react-hook-form';\r\nimport { FormControlLabel, Switch } from '@material-ui/core';\r\n\r\nimport { ControllerTextField } from '_components/ControllerTextField';\r\nimport { AddrBookAutoComplete } from '_components/AddrBookAutoComplete';\r\nimport { useEffect, useState } from 'react';\r\n\r\nimport { Category } from '_models/Category';\r\n\r\nimport { Inputs } from '../RowDataInputDialog';\r\n\r\nexport function DataInputs() {\r\n  const {\r\n    control,\r\n    setValue,\r\n    formState: { errors },\r\n  } = useFormContext<Inputs<Category>>();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  // メンバー表示の制御用に限定公開スイッチを監視\r\n  const isLimitedPublic = useWatch({\r\n    control,\r\n    name: 'limitedPublic',\r\n  });\r\n\r\n  //メンバー表示の状態\r\n  const [showMembers, setShowMembers] = useState(false);\r\n\r\n  // 給茶選択のエフェクト\r\n  useEffect(() => {\r\n    setShowMembers(isLimitedPublic);\r\n    if (!isLimitedPublic) {\r\n      setValue('members', [], { shouldDirty: true });\r\n    }\r\n  }, [isLimitedPublic, setValue]);\r\n\r\n  return (\r\n    <>\r\n      <ControllerTextField name={'name'} control={control} label={t('settings.header.category.name')} required errors={errors} />\r\n      <ControllerTextField name={'sort'} control={control} label={t('settings.header.category.sort')} errors={errors} />\r\n      <FormControlLabel\r\n        control={\r\n          <Controller\r\n            name={'limitedPublic'}\r\n            control={control}\r\n            render={({ field }) => <Switch onChange={(e) => field.onChange(e.target.checked)} checked={field.value} color=\"primary\" />}\r\n          />\r\n        }\r\n        label={t('settings.header.category.limited-public')}\r\n      />\r\n      <AddrBookAutoComplete\r\n        name={'members'}\r\n        control={control}\r\n        label={t('settings.header.category.members')}\r\n        errors={errors}\r\n        style={!showMembers ? { display: 'none' } : undefined}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { useReducer } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Paper } from '@material-ui/core';\r\n\r\nimport BaseTemplate from '../../_components/BaseTemplate';\r\nimport { Columns, DataTable } from '../DataTable';\r\nimport { dataDialogReducer, DataDialogState } from '../DataTableBase';\r\nimport { Inputs } from '../RowDataInputDialog';\r\nimport { HeaderActions } from '../HeaderActions';\r\nimport { DataInputs } from './DataInputs';\r\n\r\nimport { Category } from '_models/Category';\r\n\r\nexport function CategorySettings() {\r\n  const { t } = useTranslation();\r\n\r\n  // ダイアログの初期値\r\n  const initialState: DataDialogState = {\r\n    mode: 'addData',\r\n    inputOpen: false,\r\n  };\r\n  // ダイアログの状態\r\n  const [dataDialogState, dataDialogDispatch] = useReducer(dataDialogReducer, initialState);\r\n\r\n  const columns: Columns<Category>[] = [\r\n    { title: t('settings.header.category.name'), field: 'name' },\r\n    { title: t('settings.header.category.sort'), field: 'sort' },\r\n    { title: t('settings.header.category.limited-public'), field: 'limitedPublic', type: 'boolean' },\r\n    // { title: t('settings.header.category.members'), field: 'members' },\r\n  ];\r\n\r\n  const defaultValues: Inputs<Category> = {\r\n    mode: 'ins',\r\n    id: '',\r\n    name: '',\r\n    sort: '',\r\n    limitedPublic: false,\r\n    members: [],\r\n  };\r\n\r\n  return (\r\n    <BaseTemplate adminMode menuOpen>\r\n      <Paper square>\r\n        <Box p={2}>\r\n          <HeaderActions master=\"category\" dispatch={dataDialogDispatch}></HeaderActions>\r\n        </Box>\r\n        <Box p={2}>\r\n          <DataTable<Category>\r\n            inputFields={{ type: 'category', item: <DataInputs />, defaultValues: defaultValues }}\r\n            columns={columns}\r\n            dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }}\r\n          />\r\n        </Box>\r\n      </Paper>\r\n    </BaseTemplate>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { FormControlLabel, Switch } from '@material-ui/core';\r\nimport { Controller, useFormContext, useWatch } from 'react-hook-form';\r\n\r\nimport { ControllerTextField } from '_components/ControllerTextField';\r\n\r\nimport { nameOfRoomType, nameOfUsageRange, Room } from '_models/Room';\r\nimport { Location } from '_models/Location';\r\nimport { Category } from '_models/Category';\r\n\r\nimport { Inputs } from '../RowDataInputDialog';\r\n\r\ntype DataInputsProps = {\r\n  locations: Location[] | undefined;\r\n  categories: Category[] | undefined;\r\n};\r\n\r\nexport function DataInputs({ locations, categories }: DataInputsProps) {\r\n  const {\r\n    control,\r\n    setValue,\r\n    formState: { errors },\r\n  } = useFormContext<Inputs<Room>>();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  // 給茶選択の制御\r\n  const [disabledTeaSupply, setDisabledTeaSupply] = useState(false);\r\n\r\n  // 給茶選択の制御用にタイプ選択を監視\r\n  const typeWatch = useWatch({ control, name: 'type' });\r\n\r\n  // 給茶選択のエフェクト\r\n  useEffect(() => {\r\n    if (typeWatch === 'free') {\r\n      setValue('teaSupply', false, { shouldDirty: true });\r\n      setDisabledTeaSupply(true);\r\n    } else {\r\n      setDisabledTeaSupply(false);\r\n    }\r\n  }, [setValue, typeWatch]);\r\n\r\n  return (\r\n    <>\r\n      <ControllerTextField name={'name'} control={control} label={t('settings.header.room.name')} required errors={errors} />\r\n      <ControllerTextField\r\n        name={'email'}\r\n        control={control}\r\n        label={t('settings.header.room.email')}\r\n        required\r\n        validation={{\r\n          pattern: {\r\n            // eslint-disable-next-line no-useless-escape\r\n            value: /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/,\r\n            message: t('settings.form.room.error.email.pattern'),\r\n          },\r\n        }}\r\n        errors={errors}\r\n      />\r\n      <ControllerTextField name={'sort'} control={control} label={t('settings.header.room.sort')} errors={errors} />\r\n      <ControllerTextField\r\n        name={'usageRange'}\r\n        control={control}\r\n        label={t('settings.header.room.usage-range')}\r\n        required\r\n        selectList={nameOfUsageRange.map((value) => {\r\n          return { label: t(`settings.view.room.usage-range.${value}`), value: value };\r\n        })}\r\n        errors={errors}\r\n      />\r\n      <ControllerTextField\r\n        name={'type'}\r\n        control={control}\r\n        label={t('settings.header.room.type')}\r\n        required\r\n        selectList={nameOfRoomType.map((value) => {\r\n          return { label: t(`settings.view.room.type.${value}`), value: value };\r\n        })}\r\n        errors={errors}\r\n      />\r\n      <FormControlLabel\r\n        control={\r\n          <Controller\r\n            name={'teaSupply'}\r\n            control={control}\r\n            render={({ field }) => (\r\n              <Switch onChange={(e) => field.onChange(e.target.checked)} checked={field.value} color=\"primary\" disabled={disabledTeaSupply} />\r\n            )}\r\n          />\r\n        }\r\n        label={t('settings.header.room.tea-supply')}\r\n        style={disabledTeaSupply ? { display: 'none' } : undefined}\r\n      />\r\n      <ControllerTextField\r\n        name={'location'}\r\n        control={control}\r\n        label={t('settings.header.room.location')}\r\n        required\r\n        selectList={locations?.map((location) => {\r\n          return { label: location.name, value: location.id };\r\n        })}\r\n        errors={errors}\r\n      />\r\n      <ControllerTextField\r\n        name={'category'}\r\n        control={control}\r\n        label={t('settings.header.room.category')}\r\n        required\r\n        selectList={categories?.map((category) => {\r\n          return { label: category.name, value: category.id };\r\n        })}\r\n        errors={errors}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { useReducer } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Box, Paper } from '@material-ui/core';\r\n\r\nimport BaseTemplate from '../../_components/BaseTemplate';\r\nimport { Columns, DataTable } from '../DataTable';\r\nimport { dataDialogReducer, DataDialogState } from '../DataTableBase';\r\nimport { Inputs } from '../RowDataInputDialog';\r\nimport { HeaderActions } from '../HeaderActions';\r\nimport { DataInputs } from './DataInputs';\r\n\r\nimport { Room } from '_models/Room';\r\nimport { useLoadData } from '_utils/useLoadData';\r\nimport { Location } from '_models/Location';\r\nimport { Category } from '_models/Category';\r\n\r\nexport function RoomSettings() {\r\n  const { t } = useTranslation();\r\n\r\n  // ダイアログの初期値\r\n  const initialState: DataDialogState = {\r\n    mode: 'addData',\r\n    inputOpen: false,\r\n  };\r\n  // ダイアログの状態\r\n  const [dataDialogState, dataDialogDispatch] = useReducer(dataDialogReducer, initialState);\r\n\r\n  // ロケーションデータ取得\r\n  const [{ data: locations }] = useLoadData<Location[]>(`/location/choices`, []);\r\n\r\n  // カテゴリデータ取得\r\n  const [{ data: categories }] = useLoadData<Category[]>(`/category/choices`, []);\r\n\r\n  const columns: Columns<Room>[] = [\r\n    { title: t('settings.header.room.name'), field: 'name' },\r\n    // { title: t('settings.header.room.email'), field: 'email' },\r\n    { title: t('settings.header.room.sort'), field: 'sort' },\r\n    {\r\n      title: t('settings.header.room.usage-range'),\r\n      field: 'usageRange',\r\n      render: (rowData) => t(`settings.view.room.usage-range.${rowData.usageRange}`),\r\n    },\r\n    { title: t('settings.header.room.type'), field: 'type', render: (rowData) => t(`settings.view.room.type.${rowData.type}`) },\r\n    { title: t('settings.header.room.tea-supply'), field: 'teaSupply', type: 'boolean' },\r\n    {\r\n      title: t('settings.header.room.location'),\r\n      field: 'location',\r\n      render: (rowData) => {\r\n        const target = locations?.find((location) => location.id === rowData.location);\r\n        return target?.name;\r\n      },\r\n    },\r\n    {\r\n      title: t('settings.header.room.category'),\r\n      field: 'category',\r\n      render: (rowData) => {\r\n        const target = categories?.find((category) => category.id === rowData.category);\r\n        return target?.name;\r\n      },\r\n    },\r\n  ];\r\n\r\n  const defaultValues: Inputs<Room> = {\r\n    mode: 'ins',\r\n    id: '',\r\n    name: '',\r\n    email: '',\r\n    usageRange: 'none',\r\n    type: 'rooms',\r\n    sort: '',\r\n    teaSupply: false,\r\n    location: '',\r\n    category: '',\r\n  };\r\n\r\n  return (\r\n    <BaseTemplate adminMode menuOpen>\r\n      <Paper square>\r\n        <Box p={2}>\r\n          <HeaderActions master=\"room\" dispatch={dataDialogDispatch}></HeaderActions>\r\n        </Box>\r\n        <Box p={2}>\r\n          <DataTable<Room>\r\n            inputFields={{ type: 'room', item: <DataInputs locations={locations} categories={categories} />, defaultValues: defaultValues }}\r\n            columns={columns}\r\n            dataDialogHook={{ state: dataDialogState, dispatch: dataDialogDispatch }}\r\n          />\r\n        </Box>\r\n      </Paper>\r\n    </BaseTemplate>\r\n  );\r\n}\r\n","import { BrowserRouter, Redirect, Route, Switch } from 'react-router-dom';\r\n\r\nimport { SignIn } from 'login';\r\nimport { AuthorizeWrapper } from 'login/Authorize';\r\nimport { VisitList } from 'main/visitList';\r\nimport { ByRoom } from 'main/byRoom';\r\nimport { Front } from 'main/front';\r\nimport { RoleSettings } from 'master/role';\r\nimport { LocationSettings } from 'master/location';\r\nimport { CategorySettings } from 'master/category';\r\nimport { RoomSettings } from 'master/room';\r\n\r\nexport function Routes() {\r\n  return (\r\n    <BrowserRouter>\r\n      <Switch>\r\n        <Route exact path=\"/:location?/login\" component={SignIn} />\r\n        <Route exact path=\"/oauth/redirect\" component={AuthorizeWrapper} />\r\n        <Route exact path=\"/:location/main\" component={VisitList} />\r\n        <Route exact path=\"/:location/main/byroom\" component={ByRoom} />\r\n        <Route exact path=\"/:location/front\" component={Front} />\r\n        <Route exact path=\"/:location?/settings/role\" component={RoleSettings} />\r\n        <Route exact path=\"/:location?/settings/location\" component={LocationSettings} />\r\n        <Route exact path=\"/:location?/settings/category\" component={CategorySettings} />\r\n        <Route exact path=\"/:location?/settings/room\" component={RoomSettings} />\r\n        {/*** リダイレクト ***/}\r\n        <Redirect from=\"/:location?/\" to=\"/:location?/login\" />\r\n      </Switch>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n","import format from 'date-fns/format';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport jaLocale from 'date-fns/locale/ja';\r\n\r\n/**\r\n * DateFnsUtilsを日本語表記に対応させます。\r\n */\r\nexport default class JaDateFnsUtils extends DateFnsUtils {\r\n  getCalendarHeaderText(date: Date) {\r\n    return format(date, 'Yo MMM', { locale: jaLocale });\r\n  }\r\n\r\n  getDatePickerHeaderText(date: Date) {\r\n    return format(date, 'MMMd日', { locale: jaLocale });\r\n  }\r\n}\r\n","import { ThemeProvider } from '@material-ui/core';\nimport { theme } from './_styles/Theme';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { Routes } from './Routes';\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\nimport JaDateFnsUtils from '_utils/JaDateFnsUtils';\nimport jaLocale from 'date-fns/locale/ja';\n\nfunction App() {\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <MuiPickersUtilsProvider utils={JaDateFnsUtils} locale={jaLocale}>\n        <Routes />\n      </MuiPickersUtilsProvider>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import i18n from 'i18next';\r\nimport enTranslation from './_locales/en/translation.json';\r\nimport jaTranslation from './_locales/ja/translation.json';\r\nimport { initReactI18next } from 'react-i18next';\r\n\r\nconst resources = {\r\n  en: {\r\n    translation: enTranslation,\r\n  },\r\n  ja: {\r\n    translation: jaTranslation,\r\n  },\r\n};\r\n\r\ni18n.use(initReactI18next).init({\r\n  lng: 'ja',\r\n  fallbackLng: 'ja',\r\n  interpolation: {\r\n    escapeValue: false,\r\n  },\r\n  react: {\r\n    // wait: true,\r\n    useSuspense: false,\r\n  },\r\n  resources: resources,\r\n});\r\n\r\nexport default i18n;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './i18n';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}